
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Statistical power and sample size &#8212; The Python Companion of Intuitive Biostatistics</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=3ee479438cf8b5e0d341"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-QQY9FLLPJ8"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-QQY9FLLPJ8');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-QQY9FLLPJ8');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '20 - Statistical power and sample size';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Normality tests and outliers" href="24%20-%20Normality%20tests%20and%20outliers.html" />
    <link rel="prev" title="Statistical significance" href="15%20-%20Statistical%20significance.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="README.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.jpg" class="logo__image only-light" alt="The Python Companion of Intuitive Biostatistics - Home"/>
    <script>document.write(`<img src="_static/logo.jpg" class="logo__image only-dark" alt="The Python Companion of Intuitive Biostatistics - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="README.html">
                    Python Companion Guide to “Intuitive Biostatistics”
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Continuous variables</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="09%20-%20Quantifying%20scatter%20of%20continuous%20data.html">Quantifying scatter of continuous data</a></li>
<li class="toctree-l1"><a class="reference internal" href="10%20-%20Gaussian%20distribution.html">The Gaussian distribution</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Confidence intervals</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="12%20-%20Confidence%20interval%20of%20a%20mean.html">Confidence interval of a mean</a></li>
<li class="toctree-l1"><a class="reference internal" href="04%20-%20Confidence%20interval%20of%20a%20proportion.html">Confidence interval of a proportion</a></li>
<li class="toctree-l1"><a class="reference internal" href="05%20-%20Confidence%20interval%20of%20survival%20data.html">Confidence interval of survival data</a></li>
<li class="toctree-l1"><a class="reference internal" href="06%20-%20Confidence%20interval%20of%20counted%20data.html">Confidence interval of counted data</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Statistical significance and data assumptions</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="15%20-%20Statistical%20significance.html">Statistical significance</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Statistical power and sample size</a></li>
<li class="toctree-l1"><a class="reference internal" href="24%20-%20Normality%20tests%20and%20outliers.html">Normality tests and outliers</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Statistical tests</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="27%20-%20Comparing%20proportions.html">Comparing proportions</a></li>
<li class="toctree-l1"><a class="reference internal" href="29%20-%20Comparing%20survival%20curves.html">Comparing survival curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="30%20-%20Comparing%20two%20unpaired%20means.html">Comparing two unpaired means</a></li>
<li class="toctree-l1"><a class="reference internal" href="31%20-%20Comparing%20paired%20data.html">Comparing paired data</a></li>
<li class="toctree-l1"><a class="reference internal" href="32%20-%20Correlation.html">Correlation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Fitting models to data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="33%20-%20Simple%20linear%20regression.html">Simple linear regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="35%20-%20Comparing%20models.html">Comparing models</a></li>
<li class="toctree-l1"><a class="reference internal" href="36%20-%20Nonlinear%20regression.html">Nonlinear regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="37%20-%20Multiple%20regression.html">Multiple regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="38%20-%20Logistic%20regression.html">Logistic regression</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/sbwiecko/intuitive_biostatistics" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/sbwiecko/intuitive_biostatistics/edit/master/20 - Statistical power and sample size.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/20 - Statistical power and sample size.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Statistical power and sample size</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#definitions">Definitions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-power">The power</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-effect-size">The effect size</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#relationship-between-power-effect-size-sample-size-and-variability">Relationship between power, effect size, sample size, and variability</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#one-sample-t-test">One-sample t-test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#unpaired-t-test">Unpaired t-test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#paired-t-test">Paired t-test</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#choosing-a-sample-size">Choosing a sample size</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-choice-of-80-power">The choice of 80% power</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tools-for-power-calculations">Tools for power calculations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-simulation-based-approach">The simulation-based approach</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-proportions-a-b-test">Comparing proportions (A/B test)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#complexities-when-computing-sample-size">Complexities when computing sample size</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#incorporating-fprp-into-sample-size-decisions">Incorporating FPRP into sample size decisions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#guidance-for-making-informed-sample-size-decisions">Guidance for making informed sample size decisions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#underestimation-of-the-true-variability">Underestimation of the true variability</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cheat-sheet">Cheat sheet</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sample-size-and-statistical-power-for-one-sample-t-test">Sample size and statistical power for one-sample t-test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sample-size-and-statistical-power-for-paired-t-test">Sample size and statistical power for paired t-test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sample-size-and-statistical-power-for-unpaired-two-sample-t-test">Sample size and statistical power for unpaired two-sample t-test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#power-analysis-plot">Power analysis plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sample-size-and-statistical-power-with-pingouin">Sample size and statistical power with pingouin</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-b-test">A/B test</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#session-information">Session information</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="statistical-power-and-sample-size">
<h1>Statistical power and sample size<a class="headerlink" href="#statistical-power-and-sample-size" title="Link to this heading">#</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p>Statistical significance, as indicated by a P value below a chosen threshold, is a cornerstone of hypothesis testing. However, it only reveals one side of the coin - the likelihood of observing a result as extreme as or more extreme than the one obtained, assuming the null hypothesis is true. It doesn’t tell us the <em>probability of missing a true effect</em>, nor does it quantify the magnitude of that effect.</p>
<p>This is where the concept of <strong>statistical power</strong> takes center stage. Power is the <em>probability of finding a statistically significant result when a true effect exists</em>. It’s a measure of our ability to detect real phenomena and distinguish them from random noise.</p>
<p>In this chapter, we’ll delve into the intricacies of statistical power, exploring its relationship to type I and type II errors, the factors that influence it (effect size, sample size, variability), and how to calculate and interpret it. We’ll also provide practical guidance on how to use power analysis to make informed decisions about sample size, ensuring the studies are adequately powered to answer research questions.</p>
</section>
<section id="definitions">
<h2>Definitions<a class="headerlink" href="#definitions" title="Link to this heading">#</a></h2>
<section id="the-power">
<h3>The power<a class="headerlink" href="#the-power" title="Link to this heading">#</a></h3>
<p>The <strong>power (1 - β)</strong> of an experimental design answers this crucial question: if there truly is an effect of a specified size, and the experiment is repeated many times, what proportion of those experiments will yield a statistically significant result? This concept is essential for determining sample size requirements and for interpreting results that are not statistically significant.</p>
<p>While the definition of a P value starts with the assumption that the null hypothesis (H0) is true, we often want to know what happens when H0 is false, and there is a real effect. Statistical power addresses this by asking: if a specific effect truly exists (e.g., a difference between groups, a relative risk, a correlation), what is the probability of obtaining a statistically significant result in a single experiment?</p>
<p>Power is the proportion of hypothetical experiments (if we were to repeat our study many times) in which we would expect to correctly reject the null hypothesis, given that the alternative hypothesis (the effect we’re looking for) is actually true</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p></p></th>
<th class="head text-center"><p>Decision: reject H0</p></th>
<th class="head text-center"><p>Decision: fail to reject H0</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>No effect (H0 True)</p></td>
<td class="text-center"><p>Type I error (α)</p></td>
<td class="text-center"><p>Correct decision (1 - α)</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Effect exists</p></td>
<td class="text-center"><p>1 - β</p></td>
<td class="text-center"><p>Type II error (β)</p></td>
</tr>
</tbody>
</table>
</div>
<img src="https://static.wingify.com/gcp/uploads/sites/3/2020/12/graphical-representation-of-type-1-and-type-2-errors.png" alt="type I and type II errors seen in H0 and H1 distributions" style="width: 500px;"/>
<p>Since β represents the probability of one outcome (failing to reject a false H0), 1 - β represents the probability of the complementary outcome (correctly rejecting a false H0). This complementary outcome is what we define as statistical power.</p>
<p>In general, experiments with high statistical power are characterized by:</p>
<ul class="simple">
<li><p>Large sample sizes: more data points provide greater precision and reduce the impact of random variation.</p></li>
<li><p>Large effect sizes: the greater the magnitude of the effect we’re looking for, the easier it is to detect.</p></li>
<li><p>Low variability (scatter): less variability within our data makes it easier to distinguish a true signal from noise.</p></li>
</ul>
<p>And when there is no true effect (the null hypothesis is true), power tends to be as low as the chosen significance level (often 5%). However, as the true effect size increases (while keeping sample size and variability constant), power increases in a sigmoidal (S-shaped) curve, theoretically reaching 100%. This means that with a large enough effect, we’re virtually guaranteed to detect it.</p>
</section>
<section id="the-effect-size">
<h3>The effect size<a class="headerlink" href="#the-effect-size" title="Link to this heading">#</a></h3>
<p>Statistical significance (P &lt; α) tells us if an observed effect is likely not due to chance. However, it doesn’t reveal how large or meaningful the effect is. This is where <strong>effect size</strong> comes in. Effect size is a standardized measure of the magnitude of a phenomenon, allowing us to compare the strength of effects across different studies, even when they use different scales or measures.</p>
<p>One of the most common measures of effect size for comparing two groups is <strong>Cohen’s <span class="math notranslate nohighlight">\(d\)</span></strong>.  It quantifies the difference between two group means in terms of their <em>pooled standard deviation</em> (<span class="math notranslate nohighlight">\(s_p\)</span>):</p>
<div class="math notranslate nohighlight">
\[d = \frac{\overline{X} - \overline{Y}}{s_p} = \frac{\overline{X} - \overline{Y}}{\sqrt{\frac{(n_{1} - 1)s_{1}^{2} + (n_{2} - 1) s_{2}^{2}}{n1 + n2 - 2}}}\]</div>
<p>For a comparison between 2 groups with the <em>same sample size</em> (<span class="math notranslate nohighlight">\(n_1 = n_2 = n\)</span>), and the <em>same variance</em> (<span class="math notranslate nohighlight">\(s_1^2 = s_2^2 = s^2\)</span>), often referred to as the <strong>homoscedasticity</strong> or equal variance assumption, e.g., in controlled experiments, matched pairs designs or random sampling from a homogeneous population, the equation can be simplified to:</p>
<div class="math notranslate nohighlight">
\[d = \frac{\overline{X} - \overline{Y}}{\sqrt{\frac{\cancel{2 (n - 1)} s^2}{\cancel{2 (n - 1)}}}} = \frac{\overline{X} - \overline{Y}}{s}\]</div>
<p>Cohen’s d values are typically interpreted as follows:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Effect</p></th>
<th class="head"><p>d</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Small</p></td>
<td><p>0.2</p></td>
</tr>
<tr class="row-odd"><td><p>Medium</p></td>
<td><p>0.5</p></td>
</tr>
<tr class="row-even"><td><p>Large</p></td>
<td><p>0.8</p></td>
</tr>
</tbody>
</table>
</div>
<p>We can calculate effect size between two sets of observations with <a class="reference external" href="https://pingouin-stats.org/build/html/generated/pingouin.compute_effsize.html"><code class="docutils literal notranslate"><span class="pre">pingouin.compute_effsize</span></code></a>.</p>
</section>
</section>
<section id="relationship-between-power-effect-size-sample-size-and-variability">
<h2>Relationship between power, effect size, sample size, and variability<a class="headerlink" href="#relationship-between-power-effect-size-sample-size-and-variability" title="Link to this heading">#</a></h2>
<p>Statistical power is not a single, fixed value. It’s a dynamic concept influenced by several key factors: the size of the effect we’re looking for, the amount of variability in the data, and the sample size of our study. In this section, we’ll use simulations to visualize how these factors interact and impact the power of a statistical test.</p>
<section id="one-sample-t-test">
<h3>One-sample t-test<a class="headerlink" href="#one-sample-t-test" title="Link to this heading">#</a></h3>
<p><strong>Statistical power calculations</strong> can be used to determine the sample size needed to detect if a sample mean is significantly different from a known population mean or a hypothesized value, for example how many patients need to be enrolled in a study to determine if a new drug significantly reduces blood pressure compared to a baseline value. It can also be used to determine the number of pairs needed to detect a significant difference between two measurements taken on the same subjects, e.g., how many participants should be included in a study to assess if a new therapy significantly improves cognitive function compared to their pre-treatment scores.</p>
<p>To put these power calculations into practice, we can leverage Python’s statsmodels library, which provides convenient tools for power analysis. The <a class="reference external" href="https://www.statsmodels.org/stable/generated/statsmodels.stats.power.TTestPower.html"><code class="docutils literal notranslate"><span class="pre">TTestPower</span></code></a> function within this library allows us to estimate the required sample size for <em>one-sample and paired t-tests</em>, given the desired power, significance level, and anticipated effect size. For example, a pharmaceutical company aims to determine if their new drug can significantly lower cholesterol levels. They plan to conduct a clinical trial with a one-sample t-test, comparing the mean cholesterol level of patients taking the new drug to the known population mean.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.stats.power</span><span class="w"> </span><span class="kn">import</span> <span class="n">TTestPower</span>

<span class="c1"># Simulation parameters</span>
<span class="n">diff</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span>            <span class="c1"># Mean level **decrease** compared to known population mean</span>
<span class="n">std_devs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">]</span>   <span class="c1"># Different levels of standard deviation</span>
<span class="n">power</span> <span class="o">=</span> <span class="mf">0.8</span>           <span class="c1"># Desired power (80%)</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>          <span class="c1"># Significance level</span>
<span class="n">max_sample_size</span> <span class="o">=</span> <span class="mi">151</span> <span class="c1"># Sample sizes to consider</span>

<span class="c1"># Calculate power curves</span>
<span class="n">power_analysis</span> <span class="o">=</span> <span class="n">TTestPower</span><span class="p">()</span>

<span class="n">power_curves</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">sd</span> <span class="ow">in</span> <span class="n">std_devs</span><span class="p">:</span>
    <span class="n">power_curves</span><span class="p">[</span><span class="n">sd</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">power_analysis</span><span class="o">.</span><span class="n">power</span><span class="p">(</span>
            <span class="n">effect_size</span><span class="o">=</span><span class="n">diff</span><span class="o">/</span><span class="n">sd</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
            <span class="n">nobs</span><span class="o">=</span><span class="n">n</span><span class="p">,</span>
            <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;smaller&#39;</span><span class="p">,</span>
        <span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">max_sample_size</span><span class="p">)]</span>  <span class="c1"># Start from 2 observations</span>
    
<span class="c1"># Calculate required sample sizes for each SD</span>
<span class="n">required_sample_sizes</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">sd</span> <span class="ow">in</span> <span class="n">std_devs</span><span class="p">:</span>
    <span class="n">required_sample_sizes</span><span class="p">[</span><span class="n">sd</span><span class="p">]</span> <span class="o">=</span> <span class="n">power_analysis</span><span class="o">.</span><span class="n">solve_power</span><span class="p">(</span>
        <span class="n">effect_size</span><span class="o">=</span><span class="n">diff</span><span class="o">/</span><span class="n">sd</span><span class="p">,</span>
        <span class="n">power</span><span class="o">=</span><span class="n">power</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
        <span class="n">nobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="c1"># this is the one we want to solve</span>
        <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;smaller&#39;</span><span class="p">)</span>

<span class="c1"># Plotting</span>
<span class="c1"># plt.figure(figsize=(10, 6))</span>
<span class="k">for</span> <span class="n">sd</span><span class="p">,</span> <span class="n">powers</span> <span class="ow">in</span> <span class="n">power_curves</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">max_sample_size</span><span class="p">),</span>
        <span class="n">powers</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;s = </span><span class="si">{</span><span class="n">sd</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
        <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span>
    <span class="n">y</span><span class="o">=</span><span class="n">power</span><span class="p">,</span>
    <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Desired power (</span><span class="si">{</span><span class="n">power</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1">%)&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">sd</span><span class="p">,</span> <span class="n">powers</span> <span class="ow">in</span> <span class="n">required_sample_sizes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span>
        <span class="n">required_sample_sizes</span><span class="p">[</span><span class="n">sd</span><span class="p">],</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span>
        <span class="c1"># label=f&#39;N for power=0.8, SD={sd}&#39;,</span>
    <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Sample size (n)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Statistical power (1 - β)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Power curves for one-sample t-test | m differed by </span><span class="si">{</span><span class="n">diff</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="c1"># plt.grid(axis=&#39;y&#39;, linestyle=&#39;--&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_sample_size</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2bdcf4516bbc65ff60051c6f6fa2d384fb4359f76b88a5c6071c9ab21c0b2101.png" src="_images/2bdcf4516bbc65ff60051c6f6fa2d384fb4359f76b88a5c6071c9ab21c0b2101.png" />
</div>
</div>
<p>This plot illustrates how increasing standard deviation (greater variability in the data) lowers the statistical power for a given sample size and effect size. To maintain a desired level of power when dealing with higher variability, we need to increase the sample size, because effect size and variance are inversely related.</p>
<p>The plot is also a valuable tool for planning studies. It helps us determine the appropriate sample size needed to detect a specific effect with a desired level of confidence, given the expected variability in the data. If our study didn’t find a significant result, this plot can help us assess whether it was due to a lack of a true effect or simply a lack of power (insufficient sample size). Finally, by understanding the relationship between power, sample size, and variability, we can allocate the research resources more efficiently, avoiding underpowered studies that are unlikely to yield meaningful results.</p>
</section>
<section id="unpaired-t-test">
<h3>Unpaired t-test<a class="headerlink" href="#unpaired-t-test" title="Link to this heading">#</a></h3>
<p>Power calculations for independent t-tests serve a crucial role in experimental design and interpretation of results. Their primary purpose is to determine the minimum sample size needed in each group to detect a statistically significant difference between the means of two independent groups, with a specified level of confidence. In the following example, we the <a class="reference external" href="https://www.statsmodels.org/stable/generated/statsmodels.stats.power.TTestIndPower.html"><code class="docutils literal notranslate"><span class="pre">TTestIndPower</span></code></a> function for analyzing statistical power in the context of <em>independent two-sample t-tests</em>. In particular, the <code class="docutils literal notranslate"><span class="pre">plot_power</span></code> function within provides a convenient way to visualize the relationship between power, the effect size and sample size in a <em>two-sample t-test</em> scenario.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.stats.power</span><span class="w"> </span><span class="kn">import</span> <span class="n">TTestIndPower</span>

<span class="c1"># Analysis setup</span>
<span class="n">power_analysis</span> <span class="o">=</span> <span class="n">TTestIndPower</span><span class="p">()</span>
<span class="n">effect_sizes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">])</span>
<span class="n">sample_sizes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">401</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">power</span> <span class="o">=</span> <span class="mf">0.8</span>  <span class="c1"># Desired power (80%)</span>

<span class="c1"># Calculate required sample sizes for each SD</span>
<span class="n">required_sample_sizes</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">es</span> <span class="ow">in</span> <span class="n">effect_sizes</span><span class="p">:</span>
    <span class="n">required_sample_sizes</span><span class="p">[</span><span class="n">es</span><span class="p">]</span> <span class="o">=</span> <span class="n">power_analysis</span><span class="o">.</span><span class="n">solve_power</span><span class="p">(</span>
        <span class="n">effect_size</span><span class="o">=</span><span class="n">es</span><span class="p">,</span>
        <span class="n">power</span><span class="o">=</span><span class="n">power</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
        <span class="c1"># parameters are a little different than in TTestPower</span>
        <span class="n">ratio</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="c1"># ratio nobs2 over nobs1</span>
        <span class="n">nobs1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="c1"># this is the one we want to solve</span>
        <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">)</span>

<span class="c1"># Plotting with plot_power function</span>
<span class="n">power_analysis</span><span class="o">.</span><span class="n">plot_power</span><span class="p">(</span>
    <span class="n">dep_var</span><span class="o">=</span><span class="s1">&#39;nobs&#39;</span><span class="p">,</span>
    <span class="n">nobs</span><span class="o">=</span><span class="n">sample_sizes</span><span class="p">,</span>
    <span class="n">effect_size</span><span class="o">=</span><span class="n">effect_sizes</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span>
    <span class="n">y</span><span class="o">=</span><span class="n">power</span><span class="p">,</span>
    <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Desired power (</span><span class="si">{</span><span class="n">power</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1">%)&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">es</span><span class="p">,</span> <span class="n">powers</span> <span class="ow">in</span> <span class="n">required_sample_sizes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span>
        <span class="n">required_sample_sizes</span><span class="p">[</span><span class="n">es</span><span class="p">],</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span>
        <span class="c1"># label=f&#39;N for power=0.8, SD={sd}&#39;,</span>
    <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Sample size (n) per group&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Power (1 - β)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">sample_sizes</span><span class="p">)</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Power analysis for independent t-test&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/dffa33924de5eba67caa46662ffba84bf1a59982fc6878ca292b6296fd61a9cc.png" src="_images/dffa33924de5eba67caa46662ffba84bf1a59982fc6878ca292b6296fd61a9cc.png" />
</div>
</div>
<p>Each curve corresponds to a different effect size, showing how power increases with sample size for that particular effect. The curves have a characteristic sigmoidal (S-shaped) pattern, reflecting how power initially increases rapidly with sample size and then levels off. Finally, larger effect sizes lead to steeper curves, meaning they require smaller sample sizes to achieve the same level of power.</p>
<p>In conclusion, as the sample size per group increases, so does the power to detect a statistically significant difference between the means. This means <em>larger samples are more likely to identify a true effect</em>, as demonstrated in the figure below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Parameters</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>                          <span class="c1"># Significance level</span>
<span class="n">power</span> <span class="o">=</span> <span class="mf">0.8</span>                           <span class="c1"># Desired power</span>
<span class="n">sd</span> <span class="o">=</span> <span class="mi">10</span>                               <span class="c1"># Standard deviation</span>
<span class="n">mean_difference</span> <span class="o">=</span> <span class="mi">5</span>                   <span class="c1"># Mean difference tested</span>
<span class="n">sample_sizes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="c1"># Range of sample sizes per group</span>

<span class="c1"># Power analysis for subplot 1</span>
<span class="n">power_analysis</span> <span class="o">=</span> <span class="n">TTestIndPower</span><span class="p">()</span>
<span class="n">powers</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">power_analysis</span><span class="o">.</span><span class="n">power</span><span class="p">(</span>
        <span class="n">effect_size</span><span class="o">=</span><span class="n">mean_difference</span><span class="o">/</span><span class="n">sd</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
        <span class="n">nobs1</span><span class="o">=</span><span class="n">n</span><span class="p">,</span>
        <span class="n">ratio</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">sample_sizes</span><span class="p">]</span>

<span class="c1"># Calculate mean differences for subplot 2</span>
<span class="n">mean_diffs</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">power_analysis</span><span class="o">.</span><span class="n">solve_power</span><span class="p">(</span>
        <span class="n">effect_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">power</span><span class="o">=</span><span class="n">power</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
        <span class="n">nobs1</span><span class="o">=</span><span class="n">n</span><span class="p">,</span>
        <span class="n">ratio</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="c1"># multiply the solved effect size by SD to get the mean difference</span>
    <span class="p">)</span><span class="o">*</span><span class="n">sd</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">sample_sizes</span><span class="p">]</span>

<span class="c1"># Plotting</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="c1"># 1 row, 2 columns</span>

<span class="c1"># Subplot 1: Power vs. Sample Size</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">sample_sizes</span><span class="p">,</span> <span class="n">powers</span><span class="p">,</span>
    <span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Sample size (n) per group&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Power (1 - β)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
    <span class="s2">&quot;Power vs. sample size</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="sa">f</span><span class="s2">&quot;(d=</span><span class="si">{</span><span class="n">mean_difference</span><span class="o">/</span><span class="n">sd</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, α=</span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">, s=</span><span class="si">{</span><span class="n">sd</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
    <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="c1"># axes[0].grid(axis=&#39;y&#39;, linestyle=&#39;--&#39;)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">sample_sizes</span><span class="p">)</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">)</span>

<span class="c1"># Subplot 2: Mean Difference vs. Sample Size</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">sample_sizes</span><span class="p">,</span> <span class="n">mean_diffs</span><span class="p">,</span>
    <span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Sample size (n) per group&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Detectable mean difference&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
    <span class="s2">&quot;Detectable mean difference vs. sample size</span><span class="se">\n</span><span class="s2">&quot;</span>  <span class="c1"># Implicit string concatenation</span>
    <span class="sa">f</span><span class="s2">&quot;(1-β=</span><span class="si">{</span><span class="n">power</span><span class="si">}</span><span class="s2">, α=</span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">, s=</span><span class="si">{</span><span class="n">sd</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
    <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="c1"># axes[1].grid(axis=&#39;y&#39;, linestyle=&#39;--&#39;)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">sample_sizes</span><span class="p">)</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c360749a6f4441902b2fff8a48df0821cc0927c764f8f5266db4ea6afc80bf4b.png" src="_images/c360749a6f4441902b2fff8a48df0821cc0927c764f8f5266db4ea6afc80bf4b.png" />
</div>
</div>
</section>
<section id="paired-t-test">
<h3>Paired t-test<a class="headerlink" href="#paired-t-test" title="Link to this heading">#</a></h3>
<p>Let’s dive into a concrete example of power calculation for a <em>paired t-test</em> using the Pingouin package in Python.</p>
<p>The <a class="reference external" href="https://pingouin-stats.org/build/html/generated/pingouin.power_ttest.html"><code class="docutils literal notranslate"><span class="pre">power_ttest</span></code> method</a> provides a single function that can calculate power, sample size, effect size, or significance level, depending on which parameters are provided. It handles one-sample, paired-sample, and two-sample independent t-tests with equal sample sizes (for unequal sample sizes, use <a class="reference external" href="https://pingouin-stats.org/build/html/generated/pingouin.power_ttest2n.html"><code class="docutils literal notranslate"><span class="pre">power_ttest2n</span></code></a>, though it does not solve the number of observations). However, <code class="docutils literal notranslate"><span class="pre">pingouin.power_ttest</span></code> doesn’t directly create plots like <code class="docutils literal notranslate"><span class="pre">statsmodels.stats.power</span></code> classes and methods do.</p>
<p>Imagine a biotech is studying the effectiveness of a new cognitive training program aimed at improving memory scores. It plans to administer a memory test to participants <em>before and after</em> the training program. Researchers want to determine the sample size needed to have an 80% chance (power = 0.8) of detecting a statistically significant improvement in memory scores after the training.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pingouin</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pg</span>

<span class="c1"># Parameters</span>
<span class="n">effect_sizes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">])</span> <span class="c1"># Different effect sizes (Cohen&#39;s d)</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>                             <span class="c1"># Significance level</span>
<span class="n">sample_sizes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>      <span class="c1"># Sample sizes/number of pairs to consider</span>
<span class="n">power</span> <span class="o">=</span> <span class="mf">0.8</span>                              <span class="c1"># Desired power (80%)</span>

<span class="c1"># Calculate and print required sample sizes</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Required sample sizes for 80% power in a paired t-test:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">es</span> <span class="ow">in</span> <span class="n">effect_sizes</span><span class="p">:</span>
    <span class="n">required_n</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">power_ttest</span><span class="p">(</span>
        <span class="n">d</span><span class="o">=</span><span class="n">es</span><span class="p">,</span>
        <span class="n">n</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="c1"># parameter to solve</span>
        <span class="n">power</span><span class="o">=</span><span class="n">power</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
        <span class="n">contrast</span><span class="o">=</span><span class="s1">&#39;paired&#39;</span><span class="p">,</span>
        <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Effect size = </span><span class="si">{</span><span class="n">es</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">required_n</span><span class="p">))</span><span class="si">}</span><span class="s2"> pairs&quot;</span><span class="p">)</span> <span class="c1"># type: ignore</span>

<span class="c1"># Plotting</span>
<span class="c1"># plt.figure(figsize=(10, 6))</span>
<span class="k">for</span> <span class="n">es</span> <span class="ow">in</span> <span class="n">effect_sizes</span><span class="p">:</span>
    <span class="n">power_values</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">power_ttest</span><span class="p">(</span>
        <span class="n">d</span><span class="o">=</span><span class="n">es</span><span class="p">,</span>
        <span class="n">n</span><span class="o">=</span><span class="n">sample_sizes</span><span class="p">,</span>
        <span class="n">power</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="c1"># parameter we want to solve</span>
        <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
        <span class="n">contrast</span><span class="o">=</span><span class="s1">&#39;paired&#39;</span><span class="p">,</span>
        <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">,</span> <span class="c1"># default</span>
    <span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">sample_sizes</span><span class="p">,</span>
        <span class="n">power_values</span><span class="p">,</span> <span class="c1"># type: ignore</span>
        <span class="c1"># &#39;o-&#39;,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Effect size = </span><span class="si">{</span><span class="n">es</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
        <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span>
    <span class="n">y</span><span class="o">=</span><span class="n">power</span><span class="p">,</span>
    <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Desired power (</span><span class="si">{</span><span class="n">power</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1">%)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Sample size (paired observations)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Power (1 - β)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Power analysis for paired t-test (α=</span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
    <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">sample_sizes</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Required sample sizes for 80% power in a paired t-test:
Effect size = 0.2: 199 pairs
Effect size = 0.5: 34 pairs
Effect size = 0.8: 15 pairs
</pre></div>
</div>
<img alt="_images/554d7ecad0de32300db6b5ab342a7d384e823d8a4db0ee564009c90fc74d9ba4.png" src="_images/554d7ecad0de32300db6b5ab342a7d384e823d8a4db0ee564009c90fc74d9ba4.png" />
</div>
</div>
<p>The curves clearly demonstrate that power increases as the sample size per group increases. This means that with larger samples, we have a higher probability of detecting a statistically significant difference between the groups, even if the true effect size is small.</p>
<p>Furthermore, each curve represents a different level of standard deviation (SD) within the groups. As the SD increases (i.e., the data becomes more spread out), the curves shift to the right. This means we need a larger sample size to achieve the same level of power when the data is more variable.</p>
</section>
</section>
<section id="choosing-a-sample-size">
<h2>Choosing a sample size<a class="headerlink" href="#choosing-a-sample-size" title="Link to this heading">#</a></h2>
<section id="the-choice-of-80-power">
<h3>The choice of 80% power<a class="headerlink" href="#the-choice-of-80-power" title="Link to this heading">#</a></h3>
<p>The horizontal dashed line at 0.8 in the previous plots represents the commonly desired power level of 80%. The 80% power standard emerged as a compromise between type I and type II errors. In the early days of statistical practice, limited resources and computational power made it difficult to achieve very high power. A power of 80% was seen as a reasonable balance, offering a good chance of detecting a real effect without requiring excessively large sample sizes.</p>
<p>Setting power too low (e.g., 60%) increases the risk of type II errors (e.g., 40%), meaning we’re more likely to miss a true effect. On the other hand, striving for very high power (e.g., 99%) often demands much larger sample sizes, which may not be feasible or ethical in many research settings. If the consequences of a type II error (missing a real effect) are severe, we might opt for a higher power level, even if it means a larger sample size. For example, in a clinical trial for a life-saving drug, a higher power (e.g., 90%) might be preferred.</p>
<p>80% power strikes a middle ground, offering a reasonable probability of detecting an effect while keeping sample size requirements manageable. In early-stage research or pilot studies, a lower power level (e.g., 70%) might be acceptable, as the goal is often to gather preliminary evidence rather than draw definitive conclusions. Also, if we have strong <em>prior evidence suggesting the presence of an effect</em>, we might be comfortable with lower power. Don’t to forget that if we expect a very large effect size, we might be able to achieve adequate power with a smaller sample size. However, it’s still important to conduct a power analysis to confirm this.</p>
</section>
<section id="tools-for-power-calculations">
<h3>Tools for power calculations<a class="headerlink" href="#tools-for-power-calculations" title="Link to this heading">#</a></h3>
<p>As we’ve seen, sample size calculations for a desired level of statistical power require to specify the following:</p>
<ul class="simple">
<li><p>Significance level (α): the acceptable risk of a false positive (type I error).</p></li>
<li><p>Desired power (1 - β): the desired probability of correctly detecting a true effect.</p></li>
<li><p>Minimum effect size: the smallest effect size we consider meaningful and worth detecting.</p></li>
<li><p>Standard deviation (s): a measure of the variability or scatter in the data. Alternatively, for proportion-based tests, we would need the expected proportion.</p></li>
</ul>
<p>The type of test (one-tailed or two-tailed) also affects sample size calculations. One-tailed tests generally require smaller sample sizes but are only appropriate when we have a strong directional hypothesis. Importantly, power analysis formulas often rely on <em>assumptions</em> about the distribution of the data (e.g., normality). Violating these assumptions can affect the accuracy of the calculations.</p>
<p>Numerous online tools and software packages can assist with power analysis. Some popular options include:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.gpower.hhu.de">G*Power</a> for comparing means</p></li>
<li><p><a class="reference external" href="https://www.powerandsamplesize.com">Power and Sample Size</a>, for comparing means, K means, proportions, time-to-event data, odds ratio, etc.</p></li>
<li><p>R packages such as <a class="reference external" href="https://github.com/heliosdrm/pwr"><code class="docutils literal notranslate"><span class="pre">pwr</span></code></a> and <a class="reference external" href="https://github.com/pitakakariki/simr"><code class="docutils literal notranslate"><span class="pre">simr</span></code></a> that offer comprehensive power analysis functions within the R statistical environment</p></li>
<li><p>Python libraries <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>, with the <code class="docutils literal notranslate"><span class="pre">solve_power</span></code> method from the <code class="docutils literal notranslate"><span class="pre">TTestPower</span></code> and <code class="docutils literal notranslate"><span class="pre">TTestIndPower</span></code> classes, and <code class="docutils literal notranslate"><span class="pre">pingouin</span></code> with <code class="docutils literal notranslate"><span class="pre">power_ttest</span></code>, as we have seen in our previous examples. The <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> library offers another option with the direct function import of <a class="reference external" href="https://www.statsmodels.org/stable/generated/statsmodels.stats.power.tt_ind_solve_power.html"><code class="docutils literal notranslate"><span class="pre">tt_ind_solve_power</span></code></a>.</p></li>
</ul>
<p>For example, the required sample size per group to achieve 80% power in detecting a 17 kg mean difference between men and women, given a standard deviation of 17 kg and a significance level of 0.05 can be obtained as follows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.stats.power</span><span class="w"> </span><span class="kn">import</span> <span class="n">tt_ind_solve_power</span>

<span class="c1"># Parameters</span>
<span class="n">effect_size</span> <span class="o">=</span> <span class="mi">17</span> <span class="o">/</span> <span class="mi">17</span>  <span class="c1"># Cohen&#39;s d (mean_diff / polled_sd)</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>           <span class="c1"># Significance level</span>
<span class="n">desired_power</span> <span class="o">=</span> <span class="mf">0.8</span>    <span class="c1"># Target power</span>

<span class="c1"># Calculate sample size (directly)</span>
<span class="n">n_per_group</span> <span class="o">=</span> <span class="n">tt_ind_solve_power</span><span class="p">(</span>
    <span class="n">effect_size</span><span class="o">=</span><span class="n">effect_size</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
    <span class="n">power</span><span class="o">=</span><span class="n">desired_power</span><span class="p">,</span>
    <span class="n">ratio</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>          <span class="c1"># Equal sample sizes</span>
    <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">)</span>

<span class="c1"># Display result (clear and concise)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Required sample size per group: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">n_per_group</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Required sample size per group: 17
</pre></div>
</div>
</div>
</div>
<p>If we collect weights from 17 men and 17 women in many experiments, assuming the standard deviation of 17 kg is close to the true population SD, we’d expect approximately 80% of those experiments to yield statistically significant results (P &lt; 0.05). This is because our power analysis indicated that a sample size of 17 per group is sufficient to achieve 80% power to detect a mean difference of 17 kg with this SD.</p>
<p>Important Considerations:</p>
<ul class="simple">
<li><p>Assumption of equal variance (homoscedasticity): this calculation assumes that the <em>variances</em> in the men and women groups are <em>equal</em>. If we have reason to believe the variances might be different, we should use a different power analysis function or adjust the calculation accordingly.</p></li>
<li><p>Assumption of normality: the power analysis and the interpretation of the results rely on the assumption that the weight data are <em>normally distributed</em> within each group. If this assumption is violated, the results might not be accurate.</p></li>
<li><p>Standard deviation: the <em>standard deviation</em> of 17 kg is an estimate. It’s crucial to have a <em>reliable estimate</em> of this value, either from prior studies or pilot data.</p></li>
<li><p>Effect size: the chosen effect size of 1.0 (17 kg / 17 kg) is considered a <em>large effect</em>. If we expect a smaller effect, we will need a larger sample size to achieve the same power.</p></li>
</ul>
</section>
<section id="the-simulation-based-approach">
<h3>The simulation-based approach<a class="headerlink" href="#the-simulation-based-approach" title="Link to this heading">#</a></h3>
<p>While traditional power analysis methods (like those we’ve discussed) rely on theoretical formulas and assumptions, a simulation-based approach offers a more flexible and intuitive way to estimate sample size.</p>
<p>Here’s how it works:</p>
<ol class="arabic simple">
<li><p>Define the study design: clearly articulate the research question, the type of study (e.g., randomized controlled trial, observational study), and the primary outcome measure.</p></li>
<li><p>Simulate data under H0: generate multiple datasets under the assumption that the null hypothesis is true (no effect). We can use distributions (e.g., normal, binomial) that mimic the expected characteristics of the data.</p></li>
<li><p>Simulate data under H1: generate multiple datasets under the assumption that the alternative hypothesis is true, using an effect size we consider clinically meaningful.</p></li>
<li><p>Analyze and compare: perform the planned statistical test (e.g., t-test, chi-squared) on each simulated dataset. Compare the proportion of significant results under H0 (false positives) to the proportion under Ha (true positives) for various sample sizes.</p></li>
<li><p>Determine sample size: choose the smallest sample size where the proportion of true positives is acceptably high (e.g., 80% power) while keeping the proportion of false positives at or below the chosen significance level (e.g., 5%).</p></li>
</ol>
<p>As a practical example, let’s say we’re designing a study to evaluate a new drug’s effect on systolic blood pressure. We hypothesize that the drug will reduce systolic blood pressure by 10 mmHg compared to a placebo. We want to determine the sample size needed to have an 80% chance of detecting this effect.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">ttest_ind</span>

<span class="c1"># For reproducibility</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">simulate_study</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">mean_difference</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">control_group</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">130</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>  <span class="c1"># Mean = 130, SD = 15</span>
    <span class="n">treatment_group</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">130</span> <span class="o">-</span> <span class="n">mean_difference</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">ttest_ind</span><span class="p">(</span><span class="n">control_group</span><span class="p">,</span> <span class="n">treatment_group</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="mf">0.05</span> <span class="c1"># type: ignore</span>
    <span class="c1"># True if significant, False otherwise</span>

<span class="c1"># Simulation parameters</span>
<span class="n">mean_difference</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">power</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">num_simulations</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># Number of simulations</span>
<span class="n">max_sample_size</span> <span class="o">=</span> <span class="mi">80</span>   <span class="c1"># Max number of samples per group</span>

<span class="c1"># Run simulations</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Iterate over sample sizes, starting from 10, up to the max_sample_size, in steps of 5</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_sample_size</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
    <span class="c1"># Simulate num_simulations (1000 in this case) studies for the current sample size (n)</span>
    <span class="c1"># The simulate_study function returns True for significant results (p &lt; 0.05)</span>
    <span class="n">signif_results</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
        <span class="n">simulate_study</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">mean_difference</span><span class="o">=</span><span class="n">mean_difference</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_simulations</span><span class="p">))</span>

    <span class="c1"># Calculate the power as the proportion of simulations that resulted in a significant finding</span>
    <span class="n">power</span> <span class="o">=</span> <span class="n">signif_results</span> <span class="o">/</span> <span class="n">num_simulations</span>

    <span class="c1"># Store the current sample size and the calculated power for later</span>
    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">power</span><span class="p">))</span>

<span class="c1"># Find the smallest sample size that achieves 80% power</span>
<span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">power</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">power</span> <span class="o">&gt;=</span> <span class="mf">0.8</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Required sample size per group: </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">break</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Required sample size per group: 35
</pre></div>
</div>
</div>
</div>
<p>This simulation would run t-tests on randomly generated data and find the minimum sample size needed to detect the hypothesized effect with 80% power. While it can handle <strong>complex study designs</strong> and <strong>various outcome distributions</strong>, especially when normality assumptions don’t hold, it can be <strong>computationally intensive</strong> for large simulations.</p>
</section>
<section id="comparing-proportions-a-b-test">
<h3>Comparing proportions (A/B test)<a class="headerlink" href="#comparing-proportions-a-b-test" title="Link to this heading">#</a></h3>
<p>We can use a simplified formula derived from the principles of hypothesis testing for proportions, assuming the sample proportions follow a normal distribution, and incorporating the desired power and significance level:</p>
<div class="math notranslate nohighlight">
\[n=(z_{\alpha/2}+z_\beta)^2 \times \frac{p_1(1-p_1)+p_2(1-p_2)}{(p_1-p_2)^2}\]</div>
<p>The term <span class="math notranslate nohighlight">\((p_1 - p_2)\)</span> represents the effect size, i.e., the difference in proportions we want to detect, <span class="math notranslate nohighlight">\(z_{\alpha/2}\)</span> is the z-score corresponding to the significance level (<span class="math notranslate nohighlight">\(\alpha\)</span>) divided by 2 which defines the critical region in each tail of the distribution where we would reject the null hypothesis (here it’s a two-sided test), also noted as <span class="math notranslate nohighlight">\(z^\ast\)</span>, and <span class="math notranslate nohighlight">\(z_\beta\)</span> is the z-score corresponding to the desired power which defines the distance between the alternative hypothesis distribution and the critical region.</p>
<p>We can also use the <a class="reference external" href="https://www.statsmodels.org/dev/generated/statsmodels.stats.proportion.samplesize_proportions_2indep_onetail.html"><code class="docutils literal notranslate"><span class="pre">samplesize_proportions_2indep_onetail</span></code> function</a> which uses an explicit computation to find sample size.</p>
<p>Some methods calculate power and sample size based on exact statistical distributions (like the binomial distribution for proportions), while others use approximations (like the normal approximation to the binomial). These approximations might introduce <em>slight discrepancies</em>, especially with smaller sample sizes. Furthermore, the specific numerical algorithms used to solve for power and sample size can vary between functions, leading to slight differences in the results. There are more sophisticated methods available (e.g., using the binomial distribution directly) for complex scenarios or when precise calculations are required.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">norm</span>

<span class="c1"># parameters</span>
<span class="n">p2</span><span class="o">=</span> <span class="mi">5</span><span class="o">/</span><span class="mi">100</span>   <span class="c1"># baseline proportion, e.g., complication rate</span>
<span class="n">p1</span> <span class="o">=</span> <span class="mi">3</span><span class="o">/</span><span class="mi">100</span>  <span class="c1"># 2% absolute change, i.e., from 5% to 3%</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">power</span> <span class="o">=</span> <span class="mf">.9</span>

<span class="c1"># Calculate sample size using manual calculations</span>
<span class="n">za</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="p">(</span><span class="n">alpha</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
<span class="n">zb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">power</span><span class="p">))</span>

<span class="n">n_per_group_manual</span> <span class="o">=</span> <span class="p">(</span><span class="n">za</span><span class="o">+</span><span class="n">zb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">p1</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">p1</span><span class="p">)</span> <span class="o">+</span> <span class="n">p2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">p2</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">p1</span><span class="o">-</span><span class="n">p2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

<span class="c1"># Calculate sample size using statsmodels</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.stats.proportion</span><span class="w"> </span><span class="kn">import</span> <span class="n">samplesize_proportions_2indep_onetail</span>
<span class="n">n_per_group_statsmodels</span> <span class="o">=</span> <span class="n">samplesize_proportions_2indep_onetail</span><span class="p">(</span>
    <span class="n">diff</span><span class="o">=-</span><span class="mi">2</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>  <span class="c1"># here p1 = prop2 + diff</span>
    <span class="n">prop2</span><span class="o">=</span><span class="mi">5</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>  <span class="c1"># here prop2 is the proportion for the reference</span>
    <span class="n">power</span><span class="o">=</span><span class="n">power</span><span class="p">,</span>
    <span class="n">ratio</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>

<span class="c1"># Display results</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Required sample size per group (using manual calculations): </span><span class="se">\</span>
<span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">n_per_group_manual</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Required sample size per group (using statsmodels): </span><span class="se">\</span>
<span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">n_per_group_statsmodels</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Required sample size per group (using manual calculations): 2013
Required sample size per group (using statsmodels): 2016
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="complexities-when-computing-sample-size">
<h2>Complexities when computing sample size<a class="headerlink" href="#complexities-when-computing-sample-size" title="Link to this heading">#</a></h2>
<section id="incorporating-fprp-into-sample-size-decisions">
<h3>Incorporating FPRP into sample size decisions<a class="headerlink" href="#incorporating-fprp-into-sample-size-decisions" title="Link to this heading">#</a></h3>
<p>The False Positive Report Probability (FPRP) can be estimated before conducting an experiment based on the chosen significance level, desired power, and the prior probability of the null hypothesis (H0) being true.</p>
<p>As shown in the next table, the FPRP is dramatically affected by the prior probability:</p>
<ul class="simple">
<li><p>1% Prior Probability: this represents a <em>highly speculative scenario</em> with <em>little evidence</em> to support the alternative hypothesis. In this case, a significant result has an 86.1% chance of being a <em>false positive</em>. Less than 1% of significant results would be true positives.</p></li>
<li><p>50% Prior Probability: when there’s solid theoretical or empirical backing for the alternative hypothesis, the FPRP drops significantly to 5.9%. This suggests a <em>much higher likelihood</em> of a significant result being a <em>true discovery</em>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span> <span class="o">=</span> <span class="p">[</span><span class="mf">.05</span><span class="p">,</span> <span class="mf">.01</span><span class="p">,</span> <span class="mf">.001</span><span class="p">]</span>     <span class="c1"># significance levels tested</span>
<span class="n">powers</span> <span class="o">=</span> <span class="p">[</span><span class="mf">.80</span><span class="p">,</span> <span class="mf">.90</span><span class="p">,</span> <span class="mf">.95</span><span class="p">,</span> <span class="mf">.99</span><span class="p">]</span> <span class="c1"># power levels tested</span>
<span class="n">pprobas</span><span class="o">=</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">.25</span><span class="p">,</span> <span class="mf">.5</span><span class="p">]</span> <span class="c1"># estimates of prior probability</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;FPRP affected by α, power, and prior probability</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;α</span><span class="se">\t</span><span class="s2">power</span><span class="se">\t</span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="n">pprobas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">%</span><span class="se">\t</span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="n">pprobas</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">%</span><span class="se">\t</span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="n">pprobas</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">%</span><span class="se">\t</span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="n">pprobas</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="o">*</span><span class="mi">45</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">alphas</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s2">4.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">power</span> <span class="ow">in</span> <span class="n">powers</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n\t</span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="n">power</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">proba</span> <span class="ow">in</span> <span class="n">pprobas</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">proba</span><span class="p">)</span><span class="o">*</span><span class="n">alpha</span><span class="p">)</span><span class="o">/</span><span class="p">(((</span><span class="mi">1</span><span class="o">-</span><span class="n">proba</span><span class="p">)</span><span class="o">*</span><span class="n">alpha</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">proba</span><span class="o">*</span><span class="n">power</span><span class="p">))</span><span class="si">:</span><span class="s2">3.1f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FPRP affected by α, power, and prior probability

α	power	1.0%	10.0%	25.0%	50.0%
---------------------------------------------
0.050
	80.0%	86.1%	36.0%	15.8%	5.9%
	90.0%	84.6%	33.3%	14.3%	5.3%
	95.0%	83.9%	32.1%	13.6%	5.0%
	99.0%	83.3%	31.3%	13.2%	4.8%
0.010
	80.0%	55.3%	10.1%	3.6%	1.2%
	90.0%	52.4%	9.1%	3.2%	1.1%
	95.0%	51.0%	8.7%	3.1%	1.0%
	99.0%	50.0%	8.3%	2.9%	1.0%
0.001
	80.0%	11.0%	1.1%	0.4%	0.1%
	90.0%	9.9%	1.0%	0.3%	0.1%
	95.0%	9.4%	0.9%	0.3%	0.1%
	99.0%	9.1%	0.9%	0.3%	0.1%
</pre></div>
</div>
</div>
</div>
<p>In essence, a study’s context is crucial. A well-designed experiment with a high prior probability of a true effect can yield reliable significant findings, while a speculative study with low prior probability is more likely to produce misleading results.</p>
<p>Therefore, it’s imperative to consider the prior probability when designing and interpreting studies. When faced with a low prior probability, researchers should adjust their expectations and potentially employ stricter significance thresholds or gather additional evidence to strengthen the credibility of their findings.</p>
</section>
<section id="guidance-for-making-informed-sample-size-decisions">
<h3>Guidance for making informed sample size decisions<a class="headerlink" href="#guidance-for-making-informed-sample-size-decisions" title="Link to this heading">#</a></h3>
<p>While power analysis provides a valuable framework for calculating sample size, the process is rarely straightforward. Several factors can influence the accuracy and applicability of our calculations:</p>
<ul class="simple">
<li><p>Choosing the significance level α</p>
<ul>
<li><p>Think beyond tradition: don’t blindly default to the conventional α = 0.05.</p></li>
<li><p>Prior probability matters: consider the <strong>prior probability</strong> of a true effect (pre-study evidence).</p></li>
<li><p>FPRP as a guide: estimate the False Positive Report Probability (FPRP) to understand the <strong>risk of false positives</strong>.</p></li>
<li><p>One-tailed vs. two-tailed: choose the appropriate test directionality based on the research question.</p></li>
</ul>
</li>
<li><p>Choosing desired statistical power (1 - β)</p>
<ul>
<li><p>Balance the FPRP: aim for a power level that, in combination with the chosen α, results in a <strong>reasonably low FPRP</strong>.</p></li>
<li><p>Weigh the consequences: consider the relative costs of type I and type II errors. If <strong>missing a true effect</strong> is very costly, opt for higher power.</p></li>
</ul>
</li>
<li><p>Selecting the effect size</p>
<ul>
<li><p>Scientific relevance: focus on the <strong>smallest effect size</strong> that would be <strong>scientifically meaningful</strong>, not just statistically significant.</p></li>
<li><p>Don’t rely solely on published estimates: published effect sizes might be biased or not relevant to our specific context.</p></li>
<li><p>Consider standard effect sizes: use <strong>Cohen’s guidelines</strong> (e.g., 1/5th the SD, or 0.2 → small, half the SD, or 0.5 → medium, 0.8 → large) as a starting point, but don’t blindly adhere to them.</p></li>
<li><p>Don’t anchor on the expectations: base the sample size on the effect size we want to detect, not necessarily what we expect to find.</p></li>
<li><p>Think in ratios: if estimating the exact effect size is difficult, consider framing it as a <em>ratio relative to the standard deviation</em> (e.g., “we want to detect an effect size equal to half the SD”).</p></li>
</ul>
</li>
<li><p>Estimating expected variability</p>
<ul>
<li><p>Minimize variability: if possible, design the study to <strong>reduce the variability</strong> within groups (e.g., through stricter inclusion criteria, more controlled experimental conditions).</p></li>
<li><p>Pilot studies: conduct <strong>pilot studies</strong> to get a realistic estimate of variability. Small pilot studies often underestimate true variability as seen in the table below.</p></li>
<li><p>Published estimates with caution: be aware that published standard deviations might be biased downward due to selective reporting.</p></li>
</ul>
</li>
<li><p>Planning for unequal sample sizes</p>
<ul>
<li><p>Trade-offs: if we need to reduce the sample size in one group, we should be prepared to increase the other group’s size even more to maintain power.</p></li>
<li><p>Statistical guidance: consult a statistician for optimal strategies in dealing with unequal group sizes.</p></li>
</ul>
</li>
<li><p>Accounting for dropouts</p>
<ul>
<li><p>Anticipate attrition: always overestimate the sample size to account for potential dropouts during the study.</p></li>
<li><p>Retention strategies: consider strategies to minimize dropout rates to preserve statistical power.</p></li>
</ul>
</li>
<li><p>Leveraging paired designs</p>
<ul>
<li><p>Increased power: if the study design allows for pairing observations (e.g., pre- and post-test measures), take advantage of it! <strong>Paired t-tests are more powerful</strong> than independent t-tests for the same effect size.</p></li>
<li><p>Sample size adjustment: the required sample size for a paired t-test is typically smaller than that for an unpaired test, but keep in mind that we’ll need twice the number of total observations (one for each member of the pair).</p></li>
</ul>
</li>
</ul>
</section>
<section id="underestimation-of-the-true-variability">
<h3>Underestimation of the true variability<a class="headerlink" href="#underestimation-of-the-true-variability" title="Link to this heading">#</a></h3>
<p>The discrepancy between a sample’s standard deviation <span class="math notranslate nohighlight">\(s\)</span> and the true population SD (σ) can be substantial, particularly when dealing with small sample sizes. For example, with a sample size of only 3, σ could be up to 6.28 times larger than the sample SD (s), as reflected in the confidence interval for the SD. Since the required sample size for a t-test is proportional to the square of the SD, if the SD obtained in a pilot study is half the true population SD, the calculated sample size would be merely one-quarter of what it should be.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">chi2</span>

<span class="k">def</span><span class="w"> </span><span class="nf">W</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">0.95</span><span class="p">):</span>
    <span class="n">t2</span><span class="o">=</span><span class="n">chi2</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">alpha</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">t1</span><span class="o">=</span><span class="n">chi2</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="p">(</span><span class="n">alpha</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">t1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">t2</span><span class="p">)</span>
    
<span class="n">sample_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;n</span><span class="se">\t</span><span class="s2">95% CI of SD&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--------------------------&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">sample_size</span> <span class="ow">in</span> <span class="n">sample_sizes</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">sample_size</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="si">{</span><span class="n">W</span><span class="p">(</span><span class="n">sample_size</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">×SD - </span><span class="si">{</span><span class="n">W</span><span class="p">(</span><span class="n">sample_size</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">05.2f</span><span class="si">}</span><span class="s2">×SD&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>n	95% CI of SD
--------------------------
2	0.45×SD - 31.91×SD
3	0.52×SD - 06.28×SD
5	0.60×SD - 02.87×SD
10	0.69×SD - 01.83×SD
25	0.78×SD - 01.39×SD
50	0.84×SD - 01.25×SD
100	0.88×SD - 01.16×SD
500	0.94×SD - 01.07×SD
1000	0.96×SD - 01.05×SD
</pre></div>
</div>
</div>
</div>
<p>This highlights the importance of using caution when relying on pilot studies or <em>small samples</em> to estimate variability for power analysis. It underscores the value of obtaining <strong>reliable estimates of the population standard deviation</strong>, either from larger pilot studies, previous research, or expert knowledge. When such information is unavailable, conservative estimates of variability or adjustments to sample size calculations should be considered to avoid underpowered studies.</p>
</section>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Link to this heading">#</a></h2>
<p>We’ve learned that power is not a mere theoretical abstraction but a practical tool that empowers researchers to make informed decisions about the scale and scope of their studies. By understanding the factors that influence power and utilizing the computational resources available in Python, we can design experiments that are both efficient and reliable.</p>
<p>We’ve also highlighted the importance of considering the false positive report probability (FPRP), especially in the context of low prior probability, to temper our enthusiasm for statistically significant results and ensure that our findings are truly meaningful.</p>
<p>The tools and techniques discussed here are not just for statisticians; they are essential for any researcher seeking to extract reliable insights from data. By embracing the principles of power analysis, we can move beyond simple P-values and towards a more nuanced understanding of the evidence supporting our scientific claims.</p>
</section>
<section id="cheat-sheet">
<h2>Cheat sheet<a class="headerlink" href="#cheat-sheet" title="Link to this heading">#</a></h2>
<p>This cheat sheet provides a quick reference for essential code snippets used in this chapter.</p>
<section id="sample-size-and-statistical-power-for-one-sample-t-test">
<h3>Sample size and statistical power for one-sample t-test<a class="headerlink" href="#sample-size-and-statistical-power-for-one-sample-t-test" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.stats.power</span><span class="w"> </span><span class="kn">import</span> <span class="n">TTestPower</span>

<span class="n">diff</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span>         <span class="c1"># mean level **decrease** compared to known population</span>
<span class="n">sd</span> <span class="o">=</span> <span class="mi">20</span>            <span class="c1"># (pooled) standard deviation</span>
<span class="n">power</span> <span class="o">=</span> <span class="mf">0.8</span>        <span class="c1"># desired power (80%)</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>       <span class="c1"># significance level</span>

<span class="n">power_analysis</span> <span class="o">=</span> <span class="n">TTestPower</span><span class="p">()</span>

<span class="n">power_analysis</span><span class="o">.</span><span class="n">solve_power</span><span class="p">(</span>
    <span class="n">effect_size</span><span class="o">=</span><span class="n">diff</span><span class="o">/</span><span class="n">sd</span><span class="p">,</span>
    <span class="n">power</span><span class="o">=</span><span class="n">power</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
    <span class="n">nobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>     <span class="c1"># number of observations (to solve)</span>
    <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;smaller&#39;</span><span class="p">,</span>
<span class="p">)</span> <span class="c1"># use np.ceil to round the result</span>
</pre></div>
</div>
</section>
<section id="sample-size-and-statistical-power-for-paired-t-test">
<h3>Sample size and statistical power for paired t-test<a class="headerlink" href="#sample-size-and-statistical-power-for-paired-t-test" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">diff</span> <span class="o">=</span> <span class="mi">10</span>          <span class="c1"># mean difference</span>
<span class="n">sd</span> <span class="o">=</span> <span class="mi">20</span>            <span class="c1"># (pooled) standard deviation</span>
<span class="n">power</span> <span class="o">=</span> <span class="mf">0.8</span>        <span class="c1"># desired power (80%)</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>       <span class="c1"># significance level</span>

<span class="n">power_analysis</span> <span class="o">=</span> <span class="n">TTestPower</span><span class="p">()</span>

<span class="n">power_analysis</span><span class="o">.</span><span class="n">solve_power</span><span class="p">(</span>
    <span class="n">effect_size</span><span class="o">=</span><span class="n">diff</span><span class="o">/</span><span class="n">sd</span><span class="p">,</span>
    <span class="n">power</span><span class="o">=</span><span class="n">power</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
    <span class="n">nobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>     <span class="c1"># number of pairs (to solve)</span>
    <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">,</span>
<span class="p">)</span> <span class="c1"># use np.ceil to round the result</span>
</pre></div>
</div>
</section>
<section id="sample-size-and-statistical-power-for-unpaired-two-sample-t-test">
<h3>Sample size and statistical power for unpaired two-sample t-test<a class="headerlink" href="#sample-size-and-statistical-power-for-unpaired-two-sample-t-test" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.stats.power</span><span class="w"> </span><span class="kn">import</span> <span class="n">TTestIndPower</span>

<span class="n">es</span> <span class="o">=</span> <span class="mf">0.5</span>           <span class="c1"># effect size</span>
<span class="n">power</span> <span class="o">=</span> <span class="mf">0.8</span>        <span class="c1"># desired power (80%)</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>       <span class="c1"># significance level</span>

<span class="n">power_analysis</span> <span class="o">=</span> <span class="n">TTestIndPower</span><span class="p">()</span>

<span class="n">power_analysis</span><span class="o">.</span><span class="n">solve_power</span><span class="p">(</span>
    <span class="n">effect_size</span><span class="o">=</span><span class="n">es</span><span class="p">,</span>
    <span class="n">power</span><span class="o">=</span><span class="n">power</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
    <span class="c1"># parameters are a little different than in TTestPower</span>
    <span class="n">ratio</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>       <span class="c1"># ratio nobs2 over nobs1</span>
    <span class="n">nobs1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>    <span class="c1"># number of observations in first sample (to solve)</span>
    <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">,</span>
<span class="p">)</span> <span class="c1"># use np.ceil to round the result</span>

<span class="c1"># Equivalent to </span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.stats.power</span><span class="w"> </span><span class="kn">import</span> <span class="n">tt_ind_solve_power</span>

<span class="c1"># Calculate sample size per group</span>
<span class="n">tt_ind_solve_power</span><span class="p">(</span>
    <span class="n">effect_size</span><span class="o">=</span><span class="n">es</span><span class="p">,</span>
    <span class="n">nobs1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>    <span class="c1"># (to solve)</span>
    <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
    <span class="n">power</span><span class="o">=</span><span class="n">power</span><span class="p">,</span>
    <span class="n">ratio</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>     <span class="c1"># with nobs2 = nobs1 * ratio</span>
    <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span>
<span class="p">)</span> <span class="c1"># use np.ceil to round the result</span>
</pre></div>
</div>
</section>
<section id="power-analysis-plot">
<h3>Power analysis plot<a class="headerlink" href="#power-analysis-plot" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sample_sizes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">501</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="c1"># Work exactly the same for TTestPower and TTestIndPower</span>
<span class="n">power_analysis</span><span class="o">.</span><span class="n">plot_power</span><span class="p">(</span>
    <span class="n">dep_var</span><span class="o">=</span><span class="s1">&#39;nobs&#39;</span><span class="p">,</span>
    <span class="n">nobs</span><span class="o">=</span><span class="n">sample_sizes</span><span class="p">,</span>
    <span class="n">effect_size</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">.8</span><span class="p">],</span>
    <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
    <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="sample-size-and-statistical-power-with-pingouin">
<h3>Sample size and statistical power with pingouin<a class="headerlink" href="#sample-size-and-statistical-power-with-pingouin" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pingouin</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pg</span>

<span class="n">es</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">power</span> <span class="o">=</span> <span class="mf">0.8</span>

<span class="c1"># For one-sample, paired and unpaired two-samples (with **equal sizes**) t-tests</span>
<span class="n">pg</span><span class="o">.</span><span class="n">power_ttest</span><span class="p">(</span>
    <span class="n">d</span><span class="o">=</span><span class="n">es</span><span class="p">,</span>
    <span class="n">n</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>         <span class="c1"># parameter to solve</span>
    <span class="n">power</span><span class="o">=</span><span class="n">power</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
    <span class="n">contrast</span><span class="o">=</span><span class="s1">&#39;paired&#39;</span><span class="p">,</span> <span class="c1"># choice between &#39;paired&#39;, &#39;one-sample&#39; and &#39;two-samples&#39;</span>
    <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">,</span>
<span class="p">)</span> <span class="c1"># use np.ceil to round the result</span>
</pre></div>
</div>
</section>
<section id="a-b-test">
<h3>A/B test<a class="headerlink" href="#a-b-test" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.stats.proportion</span><span class="w"> </span><span class="kn">import</span> <span class="n">samplesize_proportions_2indep_onetail</span>

<span class="n">p2</span><span class="o">=</span> <span class="mi">5</span><span class="o">/</span><span class="mi">100</span>           <span class="c1"># baseline proportion, e.g., complication rate</span>
<span class="n">p1</span> <span class="o">=</span> <span class="mi">3</span><span class="o">/</span><span class="mi">100</span>          <span class="c1"># 2% absolute change, i.e., from 5% to 3%</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">power</span> <span class="o">=</span> <span class="mf">.9</span>

<span class="n">samplesize_proportions_2indep_onetail</span><span class="p">(</span>
    <span class="n">diff</span><span class="o">=-</span><span class="mi">2</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>    <span class="c1"># with p1 = prop2 + diff</span>
    <span class="n">prop2</span><span class="o">=</span><span class="mi">5</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>    <span class="c1"># prop2 is the proportion for the reference/baseline</span>
    <span class="n">power</span><span class="o">=</span><span class="n">power</span><span class="p">,</span>
    <span class="n">ratio</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
<span class="p">)</span>  <span class="c1"># use np.ceil to round the result</span>
</pre></div>
</div>
</section>
</section>
<section id="session-information">
<h2>Session information<a class="headerlink" href="#session-information" title="Link to this heading">#</a></h2>
<p>The output below details all packages and version necessary to reproduce the results in this report.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>python<span class="w"> </span>--version
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-------------&quot;</span><span class="p">)</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">importlib.metadata</span><span class="w"> </span><span class="kn">import</span> <span class="n">version</span>

<span class="c1"># List of packages we want to check the version</span>
<span class="n">packages</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;numpy&#39;</span><span class="p">,</span> <span class="s1">&#39;scipy&#39;</span><span class="p">,</span> <span class="s1">&#39;pingouin&#39;</span><span class="p">,</span> <span class="s1">&#39;statsmodels&#39;</span><span class="p">,</span> <span class="s1">&#39;matplotlib&#39;</span><span class="p">,</span> <span class="s1">&#39;seaborn&#39;</span><span class="p">]</span>

<span class="c1"># Initialize an empty list to store the versions</span>
<span class="n">versions</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Loop over the packages</span>
<span class="k">for</span> <span class="n">package</span> <span class="ow">in</span> <span class="n">packages</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Get the version of the package</span>
        <span class="n">package_version</span> <span class="o">=</span> <span class="n">version</span><span class="p">(</span><span class="n">package</span><span class="p">)</span>
        <span class="c1"># Append the version to the list</span>
        <span class="n">versions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">package_version</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>  <span class="c1"># Use a more general exception for broader compatibility</span>
        <span class="n">versions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Not installed&#39;</span><span class="p">)</span>

<span class="c1"># Print the versions</span>
<span class="k">for</span> <span class="n">package</span><span class="p">,</span> <span class="n">version</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">packages</span><span class="p">,</span> <span class="n">versions</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">package</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">version</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Python 3.12.7
-------------
numpy: 1.26.4
scipy: 1.14.1
pingouin: 0.5.5
statsmodels: 0.14.2
matplotlib: 3.9.2
seaborn: 0.13.2
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="15%20-%20Statistical%20significance.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Statistical significance</p>
      </div>
    </a>
    <a class="right-next"
       href="24%20-%20Normality%20tests%20and%20outliers.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Normality tests and outliers</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#definitions">Definitions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-power">The power</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-effect-size">The effect size</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#relationship-between-power-effect-size-sample-size-and-variability">Relationship between power, effect size, sample size, and variability</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#one-sample-t-test">One-sample t-test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#unpaired-t-test">Unpaired t-test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#paired-t-test">Paired t-test</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#choosing-a-sample-size">Choosing a sample size</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-choice-of-80-power">The choice of 80% power</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tools-for-power-calculations">Tools for power calculations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-simulation-based-approach">The simulation-based approach</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-proportions-a-b-test">Comparing proportions (A/B test)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#complexities-when-computing-sample-size">Complexities when computing sample size</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#incorporating-fprp-into-sample-size-decisions">Incorporating FPRP into sample size decisions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#guidance-for-making-informed-sample-size-decisions">Guidance for making informed sample size decisions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#underestimation-of-the-true-variability">Underestimation of the true variability</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cheat-sheet">Cheat sheet</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sample-size-and-statistical-power-for-one-sample-t-test">Sample size and statistical power for one-sample t-test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sample-size-and-statistical-power-for-paired-t-test">Sample size and statistical power for paired t-test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sample-size-and-statistical-power-for-unpaired-two-sample-t-test">Sample size and statistical power for unpaired two-sample t-test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#power-analysis-plot">Power analysis plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sample-size-and-statistical-power-with-pingouin">Sample size and statistical power with pingouin</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-b-test">A/B test</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#session-information">Session information</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Sébastien Wieckowski
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>