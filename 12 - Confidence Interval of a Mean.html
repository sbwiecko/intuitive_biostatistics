
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Confidence Interval of a Mean &#8212; The Python Companion of Intuitive Biostatistics</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-QQY9FLLPJ8"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-QQY9FLLPJ8');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-QQY9FLLPJ8');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '12 - Confidence Interval of a Mean';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="P Values and Statistical Significance" href="15%20-%20P%20Values%20and%20Statistical%20Significance.html" />
    <link rel="prev" title="The Gaussian Distribution" href="10%20-%20Gaussian%20Distribution.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="README.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.jpg" class="logo__image only-light" alt="The Python Companion of Intuitive Biostatistics - Home"/>
    <script>document.write(`<img src="_static/logo.jpg" class="logo__image only-dark" alt="The Python Companion of Intuitive Biostatistics - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="README.html">
                    Python Companion Guide to “Intuitive Biostatistics”
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Confidence Intervals</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="04%20-%20Confidence%20Interval%20of%20a%20Proportion.html">Confidence Interval of a Proportion</a></li>
<li class="toctree-l1"><a class="reference internal" href="05%20-%20Confidence%20Interval%20of%20Survival%20Data.html">Confidence Interval of Survival Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="06%20-%20Confidence%20Interval%20of%20Counted%20Data%20%28Poisson%20Distribution%29.html">Confidence Interval of Counted Data (Poisson Distribution)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Continuous Variables</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="09%20-%20Quantifying%20Scatter%20of%20Continuous%20Data.html">Quantifying Scatter of Continuous Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="10%20-%20Gaussian%20Distribution.html">The Gaussian Distribution</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Confidence Interval of a Mean</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Statistical Significance and Data Assumptions</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="15%20-%20P%20Values%20and%20Statistical%20Significance.html">P Values and Statistical Significance</a></li>
<li class="toctree-l1"><a class="reference internal" href="20%20-%20Statistical%20Power%20and%20Sample%20Size.html">Statistical Power and Sample Size</a></li>
<li class="toctree-l1"><a class="reference internal" href="24%20-%20Normality%20Tests%20and%20Outliers.html">Normality Tests and Outliers</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Statistical Tests</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="27%20-%20Comparing%20Proportions.html">Comparing Proportions</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/sbwiecko/intuitive_biostatistics" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/sbwiecko/intuitive_biostatistics/edit/master/12 - Confidence Interval of a Mean.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/12 - Confidence Interval of a Mean.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Confidence Interval of a Mean</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-t-distribution">The t-distribution</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#origin-of-the-t-distribution">Origin of the t-distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-scipy-stats-to-obtain-critical-t-values">Using <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> to obtain critical t-values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sign-of-the-critical-t-value">Sign of the critical t-value</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-the-t-distribution">Visualizing the t-distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#approaching-the-standard-normal">Approaching the Standard Normal</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-the-confidence-interval-of-a-mean">Calculating the confidence interval of a mean</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-t-statistic">The t-statistic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-flip">The flip</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-of-body-temperatures">Example of body temperatures</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#critical-z-vs-t-values">Critical z- vs. t-values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#python-tools-for-confidence-interval-calculation">Python tools for confidence interval calculation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#frequentist-normal-distribution">Frequentist - Normal distribution</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#frequentist-student-t-distribution">Frequentist - Student/t-distribution</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bayesian-approach">Bayesian approach</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#non-parametric-approach">Non-parametric approach</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#resampling">Resampling</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#confidence-interval-of-a-proportion-via-resampling">Confidence interval of a proportion via resampling</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrap-with-pingouin">Bootstrap with <code class="docutils literal notranslate"><span class="pre">pingouin</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-ci-sd-and-sem">The CI, SD and SEM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-confidence-interval-of-the-standard-deviation">The confidence interval of the standard deviation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cheat-sheet">Cheat sheet</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#t-distribution">t-distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pdf-plot">PDF Plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#critical-t-values-and-z-values">Critical t-values and z-values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#confidence-interval">Confidence interval</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-ci-errorbar">Plot CI errorbar</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrap">Bootstrap</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#session-information">Session Information</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="confidence-interval-of-a-mean">
<h1>Confidence Interval of a Mean<a class="headerlink" href="#confidence-interval-of-a-mean" title="Link to this heading">#</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p>In biostatistics, we often estimate characteristics of a larger population from a smaller sample. But how confident are we in those estimates? This chapter introduces the concept of <strong>confidence intervals</strong> — a powerful tool that tells us how reliable our estimates are likely to be.</p>
<p>Confidence intervals are like a range of plausible values, instead of just a single number. We’ll learn how to calculate and interpret these intervals for the most important statistic in biostatistics: the mean.</p>
<p>By the end of this chapter, we’ll understand how confidence intervals work, how to use them to make stronger conclusions about our data, and how to avoid common misunderstandings. Whether we’re new to statistics or just looking for a refresher, this chapter will give us the <em>confidence</em> we need to tackle this essential concept.</p>
</section>
<section id="the-t-distribution">
<h2>The t-distribution<a class="headerlink" href="#the-t-distribution" title="Link to this heading">#</a></h2>
<p>To determine the width of the confidence interval of a mean, we utilize a constant called the <strong>critical value</strong> from the <strong>t-distribution</strong>, or the <strong>critical t-value</strong> denoted as <span class="math notranslate nohighlight">\(t^*\)</span>. The t-distribution is similar to the standard normal distribution but is used when the population standard deviation is unknown and estimated from the sample. The choice of <span class="math notranslate nohighlight">\(t^*\)</span> depends on the desired <strong>confidence level</strong> and the <strong>degrees of freedom</strong> (<span class="math notranslate nohighlight">\(\text{df}\)</span>). In general, <span class="math notranslate nohighlight">\(\text{df}\)</span> equals the number of data points <span class="math notranslate nohighlight">\(n\)</span> minus the number of parameters being estimated, e.g., <span class="math notranslate nohighlight">\(\text{df} = n - 1\)</span> for the mean.</p>
<section id="origin-of-the-t-distribution">
<h3>Origin of the t-distribution<a class="headerlink" href="#origin-of-the-t-distribution" title="Link to this heading">#</a></h3>
<p>The t-distribution (or <strong>Student distribution</strong>) was developed by William Sealy Gosset, a chemist working for the Guinness brewery in the early 20th century. He published his work under the pseudonym “Student” due to company restrictions. The distribution arose from Gosset’s need to make inferences about the mean of a normally distributed population when the sample size was small and the population standard deviation was unknown. The t-distribution is similar to the standard normal distribution (z-distribution) but has heavier tails, especially with smaller sample sizes. As the sample size increases, the t-distribution approaches the z-distribution.</p>
</section>
<section id="using-scipy-stats-to-obtain-critical-t-values">
<h3>Using <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> to obtain critical t-values<a class="headerlink" href="#using-scipy-stats-to-obtain-critical-t-values" title="Link to this heading">#</a></h3>
<p>The <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/stats.html"><code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> module</a> in Python provides a convenient way to work with the t-distribution and obtain critical t-values. For a <em>two-tailed confidence interval</em>, the expression <span class="math notranslate nohighlight">\(1 - \alpha/2\)</span> is used to find the critical t-value, with <span class="math notranslate nohighlight">\(\alpha\)</span> the <em>signifcance level</em>, also called the <em>complement of the confidence level</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">t</span>

<span class="c1"># Define the desired confidence level (e.g., 95%)</span>
<span class="n">confidence_level</span> <span class="o">=</span> <span class="mf">0.95</span>

<span class="c1"># Calculate alpha (for two-tailed test)</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">confidence_level</span>

<span class="c1"># Define the degrees of freedom (e.g., sample size - 1)</span>
<span class="n">df</span> <span class="o">=</span> <span class="mi">27</span>

<span class="c1"># Calculate the critical t-value (two-tailed)</span>
<span class="c1">#t_critical = t.ppf(1 - alpha/2, df)  # ppf is the percent point function (inverse of CDF)</span>
<span class="n">t_critical</span> <span class="o">=</span> <span class="n">t</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># ppf is the percent point function (inverse of CDF)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The two-tailed critical t-value for a </span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="n">confidence_level</span><span class="si">}</span><span class="s2">% CI </span><span class="se">\</span>
<span class="s2">with </span><span class="si">{</span><span class="n">df</span><span class="si">}</span><span class="s2"> degrees of freedom is </span><span class="si">{</span><span class="n">t_critical</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The two-tailed critical t-value for a 95.0% CI with 27 degrees of freedom is 2.0518
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p>In Microsoft Excel, we can use <code class="docutils literal notranslate"><span class="pre">T.INV.2T(1-0.95,</span> <span class="pre">27)</span></code>.</p>
</div></blockquote>
<p>To access a wider range of t-values for various confidence levels and degrees of freedom, we can generate the following table.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Confidence levels</span>
<span class="n">confidence_levels</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.80</span><span class="p">,</span> <span class="mf">0.90</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.975</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">]</span> <span class="c1"># conf_lev = 1 - alpha</span>

<span class="c1"># Degrees of freedom</span>
<span class="n">df_values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">251</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>

<span class="c1"># Create an empty dictionary to store t-values</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>

<span class="c1"># Calculate t-values and populate dictionary</span>
<span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">df_values</span><span class="p">:</span>
    <span class="n">t_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">conf_lev</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span> <span class="k">for</span> <span class="n">conf_lev</span> <span class="ow">in</span> <span class="n">confidence_levels</span><span class="p">]</span>
    <span class="n">data</span><span class="p">[</span><span class="n">df</span><span class="p">]</span> <span class="o">=</span> <span class="n">t_values</span>

<span class="c1"># Create a DataFrame from the dictionary</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">confidence_levels</span><span class="p">)</span>

<span class="c1"># Format the table</span>
<span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;1-α&#39;</span>
<span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;df&#39;</span>

<span class="c1"># Print the table</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Two-tailed critical values of the t-distribution for various degrees of freedom (columns) and confidence levels (rows)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;===========================================================================================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">(</span><span class="n">numalign</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">stralign</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Two-tailed critical values of the t-distribution for various degrees of freedom (columns) and confidence levels (rows)
===========================================================================================================
| 1-α   | 1      | 2     | 3     | 4     | 5     | 6     | 7     | 8     | 9     | 10    | 50    | 100   | 150   | 200   | 250   |
|:------|:-------|:------|:------|:------|:------|:------|:------|:------|:------|:------|:------|:------|:------|:------|:------|
| 0.8   | 3.078  | 1.886 | 1.638 | 1.533 | 1.476 | 1.44  | 1.415 | 1.397 | 1.383 | 1.372 | 1.299 | 1.29  | 1.287 | 1.286 | 1.285 |
| 0.9   | 6.314  | 2.92  | 2.353 | 2.132 | 2.015 | 1.943 | 1.895 | 1.86  | 1.833 | 1.812 | 1.676 | 1.66  | 1.655 | 1.653 | 1.651 |
| 0.95  | 12.706 | 4.303 | 3.182 | 2.776 | 2.571 | 2.447 | 2.365 | 2.306 | 2.262 | 2.228 | 2.009 | 1.984 | 1.976 | 1.972 | 1.969 |
| 0.975 | 25.452 | 6.205 | 4.177 | 3.495 | 3.163 | 2.969 | 2.841 | 2.752 | 2.685 | 2.634 | 2.311 | 2.276 | 2.264 | 2.258 | 2.255 |
| 0.99  | 63.657 | 9.925 | 5.841 | 4.604 | 4.032 | 3.707 | 3.499 | 3.355 | 3.25  | 3.169 | 2.678 | 2.626 | 2.609 | 2.601 | 2.596 |
</pre></div>
</div>
</div>
</div>
</section>
<section id="sign-of-the-critical-t-value">
<h3>Sign of the critical t-value<a class="headerlink" href="#sign-of-the-critical-t-value" title="Link to this heading">#</a></h3>
<p>The t-distribution is symmetrical around zero, meaning that the probability density is the same for positive and negative t-values with the same absolute value.</p>
<p>In a <em>one-tailed</em> test, we’re interested in whether the population mean is significantly greater than or less than a specific value.</p>
<ul class="simple">
<li><p>Left-tailed test: the critical t-value will be negative because we’re looking for evidence in the left tail of the distribution.</p></li>
<li><p>Right-tailed test: the critical t-value will be positive because we’re looking for evidence in the right tail of the distribution.</p></li>
</ul>
<p>In a <em>two-tailed</em> test or when calculating a confidence interval, we consider both tails of the distribution.</p>
<ul class="simple">
<li><p>We’ll typically get two critical t-values: one positive and one negative, corresponding to the upper and lower bounds of the confidence interval or the rejection regions in a two-tailed test.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Parameters</span>
<span class="n">df</span> <span class="o">=</span> <span class="mi">11</span>  <span class="c1"># Degrees of freedom (n - 1)</span>
<span class="n">confidence_level</span> <span class="o">=</span> <span class="mf">0.95</span>

<span class="c1"># Calculate critical t-values</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">confidence_level</span>
<span class="n">t_critical</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>

<span class="c1"># Or we can calculate critical t-values using ppf directly</span>
<span class="c1"># note that 0.975 - 0.025 = 0.95</span>
<span class="n">t_critical_lower</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.025</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>  <span class="c1"># Lower critical value at q = 0.025</span>
<span class="n">t_critical_upper</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.975</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>  <span class="c1"># Upper critical value at q = 0.975</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;For a </span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="n">confidence_level</span><span class="si">}</span><span class="s2">% confidence interval with </span><span class="si">{</span><span class="n">df</span><span class="si">}</span><span class="s2"> degrees of freedom:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The lower critical t-value is </span><span class="si">{</span><span class="n">t_critical_lower</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">(</span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">confidence_level</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">% of the area under the curve is to the left of this value)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The upper critical t-value is </span><span class="si">{</span><span class="n">t_critical_upper</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">(</span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">confidence_level</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">% of the area under the curve is to the right of this value)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>For a 95.0% confidence interval with 11 degrees of freedom:
The lower critical t-value is -2.2 (2.5% of the area under the curve is to the left of this value)
The upper critical t-value is 2.2 (2.5% of the area under the curve is to the right of this value)
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualizing-the-t-distribution">
<h3>Visualizing the t-distribution<a class="headerlink" href="#visualizing-the-t-distribution" title="Link to this heading">#</a></h3>
<p>To gain a deeper understanding of this distribution, let’s visualize its shape and key properties.</p>
<p>The plot generated below depicts the <strong>Probability Density Function (PDF)</strong> of the t-distribution for a specific degrees of freedom (df) value. This curve represents the likelihood of different t-values occurring under this distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Parameters</span>
<span class="n">df</span> <span class="o">=</span> <span class="mi">11</span>  <span class="c1"># Degrees of freedom (n - 1)</span>
<span class="n">confidence_level</span> <span class="o">=</span> <span class="mf">0.95</span>

<span class="c1"># Calculate critical t-values</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">confidence_level</span>
<span class="n">t_critical</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>

<span class="c1"># Or we can calculate critical t-values using ppf directly</span>
<span class="c1"># note that 0.975 - 0.025 = 0.95</span>
<span class="n">t_critical_lower</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.025</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>  <span class="c1"># Lower critical value at q = 0.025</span>
<span class="n">t_critical_upper</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.975</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>  <span class="c1"># Upper critical value at q = 0.975</span>

<span class="c1"># Generate x values for the plot</span>
<span class="c1"># x = np.linspace(-4, 4, 100)  # Range from -4 to 4 standard deviations</span>

<span class="c1"># We could also use the PPF, e.g., if the model is predefined</span>
<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
    <span class="n">t</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="mf">.001</span><span class="p">),</span> <span class="c1"># Percent Point Function</span>
    <span class="n">t</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="mf">.999</span><span class="p">),</span>
    <span class="n">num</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>

<span class="c1"># Calculate t-distribution PDF values</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>

<span class="c1"># Create the plot</span>
<span class="c1"># plt.figure(figsize=(4, 3))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;t-distribution (df=</span><span class="si">{</span><span class="n">df</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="c1"># Shade confidence interval areas</span>
<span class="c1"># plt.fill_between(x, y, where=((x &lt; -t_critical) | (x &gt; t_critical)), color=&#39;mediumorchid&#39;,)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
    <span class="n">where</span><span class="o">=</span><span class="p">((</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">t_critical_lower</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="n">t_critical_upper</span><span class="p">)),</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;mediumorchid&#39;</span><span class="p">,)</span>

<span class="c1"># Add labels and title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t-value&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Probability Density&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;t-distribution with </span><span class="si">{</span><span class="n">df</span><span class="si">}</span><span class="s2"> degrees of freedom</span><span class="se">\</span>
<span class="se">\n</span><span class="s2">(</span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="n">confidence_level</span><span class="si">}</span><span class="s2">% confidence interval)&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/105f581b48c425c7485ce569e5a66d75b4733a9322828358e47306f6405d4338.png" src="_images/105f581b48c425c7485ce569e5a66d75b4733a9322828358e47306f6405d4338.png" />
</div>
</div>
<p>Notice that:</p>
<ul class="simple">
<li><p>Bell-shaped: similar to the standard normal distribution, the t-distribution is symmetrical and bell-shaped.</p></li>
<li><p>Heavier tails: the tails of the t-distribution are thicker than those of the standard normal distribution, especially for smaller degrees of freedom. This reflects the increased uncertainty associated with smaller sample sizes.</p></li>
<li><p>Approaches normal distribution: as the degrees of freedom increase (i.e., with larger sample sizes), the t-distribution approaches the standard normal distribution.</p></li>
</ul>
<p>The shaded areas in the plot highlight the <em>95% confidence interval</em>. This means that if we were to repeatedly sample from the population and calculate confidence intervals using the t-distribution, 95% of those intervals would contain the true population mean. The critical t-values that define the boundaries of this interval, i.e., 2.5% probability in each tail, are calculated using the <code class="docutils literal notranslate"><span class="pre">t.ppf</span></code> function, as discussed in the previous chapters.</p>
<p>Let’s now plot multiple t-distributions with varying degrees of freedom on the same graph, to illustrate how the shape changes as the sample size increases.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="s2">&quot;magma_r&quot;</span><span class="p">)</span>

<span class="c1"># Degrees of freedom</span>
<span class="n">df_values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">25</span><span class="p">]</span>

<span class="c1"># Generate x values for the plot</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

<span class="c1"># Create the plot</span>
<span class="c1"># plt.figure(figsize=(5, 4))</span>
<span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">df_values</span><span class="p">:</span>
    <span class="c1"># Calculate t-distribution PDF values</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>

    <span class="c1"># Plot the t-distribution</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;df = </span><span class="si">{</span><span class="n">df</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Add labels and title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t-value&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Probability Density&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;t-distributions with varying degrees of freedom&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/84fdbfb63c4077c6a796c7d9882f45a4863d6d9bc8bcf535f020bece44825563.png" src="_images/84fdbfb63c4077c6a796c7d9882f45a4863d6d9bc8bcf535f020bece44825563.png" />
</div>
</div>
<p>The plot illustrates the following key characteristics of t-distributions:</p>
<ul class="simple">
<li><p>Bell-shaped: all t-distributions are bell-shaped and symmetric around zero.</p></li>
<li><p>Heavier tails with smaller df: the t-distributions with smaller degrees of freedom (e.g., <span class="math notranslate nohighlight">\(\text{df} = 1\)</span>) have heavier tails compared to those with larger degrees of freedom (e.g., <span class="math notranslate nohighlight">\(\text{df} = 25\)</span>). This indicates a higher probability of obtaining extreme values (far from the mean) when the sample size is small.</p></li>
</ul>
</section>
<section id="approaching-the-standard-normal">
<h3>Approaching the Standard Normal<a class="headerlink" href="#approaching-the-standard-normal" title="Link to this heading">#</a></h3>
<p>As the degrees of freedom increase, the t-distribution becomes more and more similar to the standard normal distribution (z-distribution). This is evident in the plot, where the curve for <span class="math notranslate nohighlight">\(\text{df} = 25\)</span> closely resembles the standard normal curve.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>

<span class="c1"># Set up parameters</span>
<span class="n">df</span> <span class="o">=</span> <span class="mi">25</span>  <span class="c1"># Degrees of freedom for t-distribution</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>  <span class="c1"># Range of x values</span>

<span class="c1"># Calculate PDF values</span>
<span class="n">t_pdf</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>
<span class="n">norm_pdf</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="c1"># Plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t_pdf</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;t-distribution (df=</span><span class="si">{</span><span class="n">df</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm_pdf</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Standard Normal (Gaussian)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span>
    <span class="s1">&#39;Comparison of t-distribution and Standard Normal PDFs&#39;</span><span class="p">,</span>
    <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Probability density&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5ae4e98c707101529462d690b69d776bd904102a1090f30e896f97e74668be4c.png" src="_images/5ae4e98c707101529462d690b69d776bd904102a1090f30e896f97e74668be4c.png" />
</div>
</div>
<p>This convergence is a consequence of the Central Limit Theorem (CLT), which states that the distribution of sample means approaches a normal distribution as the sample size increases, regardless of the shape of the original population distribution. Since degrees of freedom are directly related to sample size (<span class="math notranslate nohighlight">\(\text{df} = n - 1\)</span>), as <span class="math notranslate nohighlight">\(\text{df}\)</span> increases, the sample size also increases, and the t-distribution becomes increasingly similar to the standard normal distribution.</p>
<p>In principle, when the sample size is large (typically <span class="math notranslate nohighlight">\(n &gt; 30\)</span>), the t-distribution and the standard normal distribution are very close. In this case, we can use either the <strong>z-score</strong> or the <strong>t-value</strong> for the CI calculations, and the results will be virtually identical.</p>
</section>
</section>
<section id="calculating-the-confidence-interval-of-a-mean">
<h2>Calculating the confidence interval of a mean<a class="headerlink" href="#calculating-the-confidence-interval-of-a-mean" title="Link to this heading">#</a></h2>
<p>The most common method of computing the confidence interval (CI) of a mean assumes that the data are sampled from a population that follows a <em>normal distribution</em>. The CI is centered around the sample mean <span class="math notranslate nohighlight">\(m\)</span>. To calculate its width, we need to consider the standard deviation <span class="math notranslate nohighlight">\(s\)</span>, the number of values in the sample <span class="math notranslate nohighlight">\(n\)</span>, and the desired degree of confidence (typically 95%).</p>
<section id="the-t-statistic">
<h3>The t-statistic<a class="headerlink" href="#the-t-statistic" title="Link to this heading">#</a></h3>
<p>While we can use the t-distribution to calculate confidence intervals and test hypotheses about the population mean, it’s important to distinguish between the <em>t-statistic</em> (calculated from the sample data) and the <em>critical t-value</em> (obtained from the t-distribution as shown above).</p>
<p>Suppose we have a population that is normally distributed, with known parameters <span class="math notranslate nohighlight">\(\mu\)</span> (mean) and <span class="math notranslate nohighlight">\(\sigma\)</span> (standard deviation). By taking multiple random samples of size <span class="math notranslate nohighlight">\(n\)</span> from this population, we can compute the sample mean (<span class="math notranslate nohighlight">\(m\)</span>) and sample standard deviation (<span class="math notranslate nohighlight">\(s\)</span>) for each. Then, for each sample, we can calculate the <strong>t-statistic</strong> (<span class="math notranslate nohighlight">\(t\)</span>):</p>
<div class="math notranslate nohighlight">
\[t=\frac{m - \mu}{s / \sqrt{n}}\]</div>
<ul class="simple">
<li><p>The t-statistic tells us how extreme the sample mean is compared to the hypothesized population mean, under the assumption that the null hypothesis is true (i.e., the true population mean is equal to the hypothesized value).</p></li>
<li><p>A larger absolute value of <span class="math notranslate nohighlight">\(t\)</span> indicates a more significant difference between the sample mean and the hypothesized population mean.</p></li>
<li><p>The sign of <span class="math notranslate nohighlight">\(t\)</span> indicates whether the sample mean is larger (+) or smaller (-) than the hypothesized population mean.</p></li>
</ul>
<p>For example, suppose we want to test whether a new drug has an effect on blood pressure. We collect a sample of 30 patients and measure their blood pressure after taking the drug. The sample mean (m) is 120 mmHg, and the sample standard deviation (s) is 15 mmHg. Our hypothesize that the population mean blood pressure with the drug (<span class="math notranslate nohighlight">\(\mu\)</span>) is 130 mmHg.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t_stat</span> <span class="o">=</span> <span class="p">(</span><span class="mi">120</span> <span class="o">-</span> <span class="mi">130</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">15</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The t-statistic in this sample = </span><span class="si">{</span><span class="n">t_stat</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The t-statistic in this sample = -3.651
</pre></div>
</div>
</div>
</div>
<p>The result indicates that the sample mean is 3.651 standard errors <em>lower</em> than the hypothesized population mean of 130 mmHg.</p>
<p>Once we’ve calculated the t-statistic, we can use the t-distribution to determine:</p>
<ul class="simple">
<li><p>P-value: the probability of observing a t-statistic as extreme as or more extreme than the one calculated, assuming the null hypothesis is true. A smaller p-value provides stronger evidence against the null hypothesis.</p></li>
<li><p>Critical t-value: the t-value that corresponds to our chosen significance level (alpha) and degrees of freedom. If our calculated t-statistic is more extreme than the critical t-value, we reject the null hypothesis.</p></li>
</ul>
</section>
<section id="the-flip">
<h3>The flip<a class="headerlink" href="#the-flip" title="Link to this heading">#</a></h3>
<p>For any individual sample, we know the specific values for the sample mean, standard deviation, and size. The population mean, though, remains hidden. Our goal is to <em>estimate this population mean</em> while quantifying our level of uncertainty. To achieve this, we can calculate a confidence interval (CI) as follows:</p>
<div class="math notranslate nohighlight">
\[\mu = m \pm t^* \times \frac{s}{\sqrt{n}}\]</div>
<p>To estimate the population mean with a specified level of confidence, we can employ the t-distribution and follow this procedure:</p>
<ol class="arabic simple">
<li><p>Calculate the sample mean (<span class="math notranslate nohighlight">\(m\)</span>) and sample standard deviation (<span class="math notranslate nohighlight">\(s\)</span>)</p></li>
<li><p>Determine the degrees of freedom (<span class="math notranslate nohighlight">\(df = n - 1\)</span>)</p></li>
<li><p>Choose a confidence level (e.g., 95%)</p></li>
<li><p>Find the critical t-value (<span class="math notranslate nohighlight">\(t^*\)</span>)</p></li>
<li><p>Calculate the margin of error as <span class="math notranslate nohighlight">\(W = \frac{t^* \times s}{\sqrt{n}}\)</span></p></li>
<li><p>Construct the confidence interval, as <span class="math notranslate nohighlight">\(\text{CI} = m \pm W\)</span></p></li>
</ol>
</section>
<section id="example-of-body-temperatures">
<h3>Example of body temperatures<a class="headerlink" href="#example-of-body-temperatures" title="Link to this heading">#</a></h3>
<p>To illustrate the effect of sample size on the confidence interval, we will simulate two datasets of body temperatures with the same population mean and SD, but with different sample sizes (n=12 and n=130). We will assume the body temperatures are <em>normally distributed</em> with a population mean of 36.8 and a standard deviation of 0.4. We will then calculate and visualize the 95% confidence intervals for each sample using the <em>critical z-values, supposing we know the population standard deviation</em>. (The difference between critical t- and z-values is discussed just after that, for now just focus on the confidence intervals.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set random seed for reproducibility</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Population parameters</span>
<span class="n">pop_mean</span> <span class="o">=</span> <span class="mf">36.8</span>
<span class="n">pop_sd</span> <span class="o">=</span> <span class="mf">0.4</span>

<span class="c1"># Sample sizes</span>
<span class="n">n1</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">n2</span> <span class="o">=</span> <span class="mi">130</span>

<span class="c1"># Generate samples</span>
<span class="n">sample1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">pop_mean</span><span class="p">,</span> <span class="n">pop_sd</span><span class="p">,</span> <span class="n">n1</span><span class="p">)</span>
<span class="n">sample2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">pop_mean</span><span class="p">,</span> <span class="n">pop_sd</span><span class="p">,</span> <span class="n">n2</span><span class="p">)</span>

<span class="c1"># Calculate sample means and standard errors</span>
<span class="n">sample_mean1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sample1</span><span class="p">)</span>
<span class="n">sample_mean2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sample2</span><span class="p">)</span>
<span class="n">sem1</span> <span class="o">=</span> <span class="n">pop_sd</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span>
<span class="n">sem2</span> <span class="o">=</span> <span class="n">pop_sd</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n2</span><span class="p">)</span>

<span class="c1"># Calculate z-critical value for 95% CI (since pop std is known)</span>
<span class="n">z_crit</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.975</span><span class="p">)</span>  <span class="c1"># ppf gives us z score for 97.5%</span>

<span class="c1"># Calculate margin of error</span>
<span class="n">margin_error1</span> <span class="o">=</span> <span class="n">z_crit</span> <span class="o">*</span> <span class="n">sem1</span>
<span class="n">margin_error2</span> <span class="o">=</span> <span class="n">z_crit</span> <span class="o">*</span> <span class="n">sem2</span>

<span class="c1"># Calculate confidence intervals</span>
<span class="n">ci_lower1</span> <span class="o">=</span> <span class="n">sample_mean1</span> <span class="o">-</span> <span class="n">margin_error1</span>
<span class="n">ci_upper1</span> <span class="o">=</span> <span class="n">sample_mean1</span> <span class="o">+</span> <span class="n">margin_error1</span>
<span class="n">ci_lower2</span> <span class="o">=</span> <span class="n">sample_mean2</span> <span class="o">-</span> <span class="n">margin_error2</span>
<span class="n">ci_upper2</span> <span class="o">=</span> <span class="n">sample_mean2</span> <span class="o">+</span> <span class="n">margin_error2</span>

<span class="c1"># Create point plots with confidence intervals</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>  <span class="c1"># 1 row, 2 columns, subplot 1</span>
<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="n">sample_mean1</span><span class="p">],</span>
    <span class="n">yerr</span><span class="o">=</span><span class="n">margin_error1</span><span class="p">,</span>
    <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;95% CI (n=</span><span class="si">{</span><span class="n">n1</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span>
    <span class="n">pop_mean</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Population mean&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
    <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">sample1</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data points&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Data point index&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Body Temperature (°C)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">35.6</span><span class="p">,</span> <span class="mf">37.9</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Body temperature sample (n = </span><span class="si">{</span><span class="n">n1</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>  <span class="c1"># 1 row, 2 columns, subplot 2</span>
<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span>
    <span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="n">sample_mean2</span><span class="p">],</span>
    <span class="n">yerr</span><span class="o">=</span><span class="n">margin_error2</span><span class="p">,</span>
    <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;95% CI (n=</span><span class="si">{</span><span class="n">n2</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span>
    <span class="n">pop_mean</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Population mean&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
    <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">sample2</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data points&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Data point index&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">130</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Body temperature sample (n = </span><span class="si">{</span><span class="n">n2</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">35.6</span><span class="p">,</span> <span class="mf">37.9</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ba2ca606c96c3c873e8997fe9031383743d1ee5fbe2a6b9049f07d0b7e927bb2.png" src="_images/ba2ca606c96c3c873e8997fe9031383743d1ee5fbe2a6b9049f07d0b7e927bb2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print the results</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Critical z-value = </span><span class="si">{</span><span class="n">z_crit</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sample size n = </span><span class="si">{</span><span class="n">n1</span><span class="si">}</span><span class="s2">, with known population SD of </span><span class="si">{</span><span class="n">pop_sd</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Sample mean: </span><span class="si">{</span><span class="n">sample_mean1</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  SE (sigma / sqrt(n)): </span><span class="si">{</span><span class="n">sem1</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Margin of error: </span><span class="si">{</span><span class="n">margin_error1</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  95% confidence interval: (</span><span class="si">{</span><span class="n">ci_lower1</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ci_upper1</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Sample size n = </span><span class="si">{</span><span class="n">n2</span><span class="si">}</span><span class="s2">, with known population SD of </span><span class="si">{</span><span class="n">pop_sd</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Sample mean: </span><span class="si">{</span><span class="n">sample_mean2</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  SE (sigma / sqrt(n)): </span><span class="si">{</span><span class="n">sem2</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Margin of error: </span><span class="si">{</span><span class="n">margin_error2</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  95% confidence interval: (</span><span class="si">{</span><span class="n">ci_lower2</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ci_upper2</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Critical z-value = 1.959964

Sample size n = 12, with known population SD of 0.4:
  Sample mean: 36.9184
  SE (sigma / sqrt(n)): 0.11547
  Margin of error: 0.22632
  95% confidence interval: (36.6921, 37.1447)

Sample size n = 130, with known population SD of 0.4:
  Sample mean: 36.7576
  SE (sigma / sqrt(n)): 0.03508
  Margin of error: 0.06876
  95% confidence interval: (36.6888, 36.8264)
</pre></div>
</div>
</div>
</div>
<p>As the number of observations in a sample increases, the sample statistics tend to converge towards the actual population parameters. This means that the t-distribution, used when the population standard deviation is unknown, closely resembles the z-distribution (standard normal distribution) in larger samples. Therefore, for samples of 50 or more observations, the choice between using the t-distribution or z-distribution for calculating confidence intervals or P values becomes less critical, as the results will be practically identical. In some later models, we may see references to either t-statistics or z-statistics, but remember that this distinction is mainly significant for smaller sample sizes.</p>
</section>
<section id="critical-z-vs-t-values">
<h3>Critical z- vs. t-values<a class="headerlink" href="#critical-z-vs-t-values" title="Link to this heading">#</a></h3>
<p>We can use the critical z-value instead of the critical t-value when calculating the margin of error in certain situations, but it’s important to understand the conditions under which this is appropriate.</p>
<ul class="simple">
<li><p>When to use the z-value:</p>
<ul>
<li><p>The population standard deviation (<span class="math notranslate nohighlight">\(\sigma\)</span>) is known: if we have access to the true population standard deviation, we can directly use the z-distribution (standard normal distribution) to calculate the critical value.</p></li>
<li><p>The sample size is large (typically n &gt; 30): the Central Limit Theorem states that the distribution of sample means approaches a normal distribution as the sample size increases. For large samples, the t-distribution closely approximates the z-distribution, making the z-value a valid substitute.</p></li>
</ul>
</li>
<li><p>When to use the t-value:</p>
<ul>
<li><p>The population standard deviation (<span class="math notranslate nohighlight">\(\sigma\)</span>) is unknown: this is the most common scenario in <em>real-world</em> applications. When we don’t know the population standard deviation, we estimate it from the sample data (using the sample standard deviation, <span class="math notranslate nohighlight">\(s\)</span>). The t-distribution accounts for the additional uncertainty introduced by this estimation.</p></li>
<li><p>The sample size is small (typically n &lt; 30): with small sample sizes, the t-distribution has heavier tails than the z-distribution, reflecting the greater variability in sample means. Using the t-distribution provides a more accurate confidence interval in this case.</p></li>
</ul>
</li>
</ul>
<p>Using the z-value when the t-value is appropriate can lead to narrower confidence intervals that may not accurately capture the true population parameter. The t-distribution provides a more conservative estimate in these cases. But the distinction between the t-distribution and z-distribution becomes less critical as the sample size increases. For very large samples (n &gt; 100), the difference is negligible, and either distribution can be used.</p>
<p>For example, suppose we have a sample of 12 measurements with a sample mean (<span class="math notranslate nohighlight">\(m\)</span>) of 36.9184 and a sample standard deviation (<span class="math notranslate nohighlight">\(s\)</span>) of 0.2977. We want a 95% confidence interval. If we know the population standard deviation (here <span class="math notranslate nohighlight">\(\sigma=0.4\)</span>), we can use the z-value (1.959964 for a 95% CI) to calculate the margin of error, as we did just above. If we don’t know the population standard deviation, we should use the t-value (2.200985 for a 95% CI with 11 degrees of freedom) to calculate the margin of error, as demonstrated below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Population parameters (known)</span>
<span class="n">pop_mean</span> <span class="o">=</span> <span class="mf">36.8</span>
<span class="n">pop_sd</span> <span class="o">=</span> <span class="mf">0.4</span>

<span class="c1"># Sample sizes</span>
<span class="n">n1</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">n2</span> <span class="o">=</span> <span class="mi">130</span>

<span class="c1"># Generate samples (for demonstration purposes)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># for reproducibility</span>
<span class="n">sample1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">pop_mean</span><span class="p">,</span> <span class="n">pop_sd</span><span class="p">,</span> <span class="n">n1</span><span class="p">)</span>
<span class="n">sample2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">pop_mean</span><span class="p">,</span> <span class="n">pop_sd</span><span class="p">,</span> <span class="n">n2</span><span class="p">)</span>

<span class="c1"># Calculate sample means</span>
<span class="n">sample_mean1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sample1</span><span class="p">)</span>
<span class="n">sample_mean2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sample2</span><span class="p">)</span>

<span class="c1"># Confidence level</span>
<span class="n">confidence_level</span> <span class="o">=</span> <span class="mf">0.95</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">confidence_level</span>

<span class="c1"># Calculate critical t-values</span>
<span class="n">t_critical1</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">n1</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">t_critical2</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">n2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Calculate sample standard deviations</span>
<span class="n">sample_sd1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">sample1</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sample_sd2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">sample2</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Calculate standard error of the mean</span>
<span class="n">sem1</span> <span class="o">=</span> <span class="n">sample_sd1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span>
<span class="n">sem2</span> <span class="o">=</span> <span class="n">sample_sd2</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n2</span><span class="p">)</span>

<span class="c1"># Calculate margin of error</span>
<span class="n">margin_error1</span> <span class="o">=</span> <span class="n">t_critical1</span> <span class="o">*</span> <span class="n">sem1</span>
<span class="n">margin_error2</span> <span class="o">=</span> <span class="n">t_critical2</span> <span class="o">*</span> <span class="n">sem2</span>

<span class="c1"># Calculate confidence intervals</span>
<span class="n">ci_lower1</span> <span class="o">=</span> <span class="n">sample_mean1</span> <span class="o">-</span> <span class="n">margin_error1</span>
<span class="n">ci_upper1</span> <span class="o">=</span> <span class="n">sample_mean1</span> <span class="o">+</span> <span class="n">margin_error1</span>
<span class="n">ci_lower2</span> <span class="o">=</span> <span class="n">sample_mean2</span> <span class="o">-</span> <span class="n">margin_error2</span>
<span class="n">ci_upper2</span> <span class="o">=</span> <span class="n">sample_mean2</span> <span class="o">+</span> <span class="n">margin_error2</span>


<span class="c1"># Print the results</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sample size n = </span><span class="si">{</span><span class="n">n1</span><span class="si">}</span><span class="s2">, with unknown population SD:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Critical t-value = </span><span class="si">{</span><span class="n">t_critical1</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Sample mean: </span><span class="si">{</span><span class="n">sample_mean1</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Sample SD: </span><span class="si">{</span><span class="n">sample_sd1</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Sample SE: </span><span class="si">{</span><span class="n">sem1</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Margin of error: </span><span class="si">{</span><span class="n">margin_error1</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  95% confidence Interval: (</span><span class="si">{</span><span class="n">ci_lower1</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ci_upper1</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Sample size n = </span><span class="si">{</span><span class="n">n2</span><span class="si">}</span><span class="s2">, with unknown population SD:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Critical t-value = </span><span class="si">{</span><span class="n">t_critical2</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Sample mean: </span><span class="si">{</span><span class="n">sample_mean2</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Sample SD: </span><span class="si">{</span><span class="n">sample_sd2</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Sample SE: </span><span class="si">{</span><span class="n">sem2</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Margin of error: </span><span class="si">{</span><span class="n">margin_error2</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  95% confidence Interval: (</span><span class="si">{</span><span class="n">ci_lower2</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ci_upper2</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sample size n = 12, with unknown population SD:
  Critical t-value = 2.200985
  Sample mean: 36.9184
  Sample SD: 0.2977
  Sample SE: 0.08594
  Margin of error: 0.18915
  95% confidence Interval: (36.7292, 37.1075)

Sample size n = 130, with unknown population SD:
  Critical t-value = 1.978524
  Sample mean: 36.7576
  Sample SD: 0.3822
  Sample SE: 0.03352
  Margin of error: 0.06633
  95% confidence Interval: (36.6913, 36.8239)
</pre></div>
</div>
</div>
</div>
</section>
<section id="python-tools-for-confidence-interval-calculation">
<h3>Python tools for confidence interval calculation<a class="headerlink" href="#python-tools-for-confidence-interval-calculation" title="Link to this heading">#</a></h3>
<p>There are several ways to directly calculate CIs in Python using various packages.</p>
<section id="frequentist-normal-distribution">
<h4>Frequentist - Normal distribution<a class="headerlink" href="#frequentist-normal-distribution" title="Link to this heading">#</a></h4>
<p>This frequentist method assumes that the data are sampled from a <em>normally distributed population</em>, and that the population standard deviation is known. This function calculates the confidence interval based on the <strong>z-score</strong> (standard normal distribution), which is appropriate under these frequentist assumptions. If we have a <em>large sample size (n &gt; 30)</em>, the normal distribution is often sufficient.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate 95% confidence interval (assuming known population std_dev)</span>
<span class="n">confidence_level</span> <span class="o">=</span> <span class="mf">0.95</span>
<span class="n">sample_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sample2</span><span class="p">)</span>
<span class="c1"># Here, we would typically use the population std_dev when it is known, </span>
<span class="c1"># or an estimate (e.g., from previous studies)</span>
<span class="n">sd2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">sample2</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">ci1</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">interval</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">sample_mean</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">pop_sd</span><span class="p">)</span>
<span class="n">ci2</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">interval</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">sample_mean</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">sd2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;95% confidence interval (known population SD): (</span><span class="si">{</span><span class="n">ci1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ci1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;95% confidence interval (sample SD): (</span><span class="si">{</span><span class="n">ci2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ci2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>95% confidence interval (known population SD): (35.974, 37.542)
95% confidence interval (sample SD): (36.008, 37.507)
</pre></div>
</div>
</div>
</div>
</section>
<section id="frequentist-student-t-distribution">
<h4>Frequentist - Student/t-distribution<a class="headerlink" href="#frequentist-student-t-distribution" title="Link to this heading">#</a></h4>
<p>Other frequentist methods provide a convenient way to calculate the confidence interval for a mean using the <strong>t-distribution</strong>. For example, <a class="reference external" href="https://www.statsmodels.org/stable/generated/statsmodels.stats.weightstats.DescrStatsW.tconfint_mean.html"><code class="docutils literal notranslate"><span class="pre">statsmodels.stats.weightstats.DescrStatsW.tconfint_mean</span></code></a> takes the data as input and returns the confidence interval directly. If we have a <em>small sample size</em> and don’t know the population standard deviation, the t-distribution is generally the most appropriate choice.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>

<span class="n">confidence_level</span> <span class="o">=</span> <span class="mf">0.95</span>
<span class="c1"># Calculate 95% confidence interval</span>
<span class="n">ci</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">DescrStatsW</span><span class="p">(</span><span class="n">sample1</span><span class="p">)</span><span class="o">.</span><span class="n">tconfint_mean</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">confidence_level</span><span class="p">)</span> 

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;95% confidence interval (t-distribution, estimated SD; DescrStatsW): </span><span class="se">\</span>
<span class="s2">(</span><span class="si">{</span><span class="n">ci</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ci</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>95% confidence interval (t-distribution, estimated SD; DescrStatsW): (36.729, 37.108)
</pre></div>
</div>
</div>
</div>
<p>This method is based on the confidence interval with equal areas around the median from the t-distribution, as calculated with <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.t.html"><code class="docutils literal notranslate"><span class="pre">scipy.stats.t.interval</span></code></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sem</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">sample1</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sample1</span><span class="p">))</span>
<span class="n">ci</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">interval</span><span class="p">(</span>
    <span class="n">confidence</span><span class="o">=</span><span class="n">confidence_level</span><span class="p">,</span>
    <span class="n">df</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">sample1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">loc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sample1</span><span class="p">),</span>
    <span class="n">scale</span><span class="o">=</span><span class="n">sem</span><span class="p">)</span> <span class="c1"># here scale is SE, no SD as in normal distribution</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;95% confidence interval (t-distribution, estimated SD; t.interval): </span><span class="se">\</span>
<span class="s2">(</span><span class="si">{</span><span class="n">ci</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ci</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>95% confidence interval (t-distribution, estimated SD; t.interval): (36.729, 37.108)
</pre></div>
</div>
</div>
</div>
</section>
<section id="bayesian-approach">
<h4>Bayesian approach<a class="headerlink" href="#bayesian-approach" title="Link to this heading">#</a></h4>
<p>Bayesian methods allow us to incorporate <em>prior beliefs or information</em> about the parameters we’re estimating. This can be particularly useful when we have some knowledge about the data generating process or when we have limited data. They produce credible intervals, which are a more intuitive and direct interpretation of uncertainty compared to frequentist confidence intervals. A 95% credible interval means there’s a <strong>95% probability</strong> the true parameter lies within that interval, given the data and the prior. Bayesian methods are less sensitive to small sample sizes than frequentist methods, which often rely on asymptotic assumptions that <em>may not hold for small datasets</em>. Bayesian statistics is a vast and complex field with <a class="reference external" href="https://allendowney.github.io/ThinkBayes2/preface.html">dedicated Python libraries like PyMC3 and Stan</a>.</p>
<p>The <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.bayes_mvs.html"><code class="docutils literal notranslate"><span class="pre">scipy.stats.bayes_mvs</span></code> function</a> simplifies the calculation of <strong>Bayesian credible intervals</strong> for the mean, variance, and standard deviation. It uses <a class="reference external" href="https://scholarsarchive.byu.edu/cgi/viewcontent.cgi?article=1277&amp;amp;context=facpub">Jeffrey’s prior, a non-informative prior</a> that doesn’t introduce strong assumptions about the parameter values. This can be a good starting point for Bayesian analysis when you have limited prior knowledge.</p>
<p><u>Note:</u> for samples of size <em>smaller than 1000</em>, the function resorts to a <em>frequentist approach</em>. It calculates the sample mean and standard deviation, and then uses the <strong>t-distribution</strong> with n-1 degrees of freedom to determine the confidence interval.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">bayes_mvs</span>

<span class="c1"># Calculate 95% Bayesian confidence interval for the mean</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">bayes_mvs</span><span class="p">(</span><span class="n">sample1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
<span class="n">ci_lower</span><span class="p">,</span> <span class="n">ci_upper</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Extract lower and upper bounds from the result object</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;95% confidence interval in the dataset with n=</span><span class="si">{</span><span class="n">n1</span><span class="si">}</span><span class="s2">: (</span><span class="si">{</span><span class="n">ci_lower</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ci_upper</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>95% confidence interval in the dataset with n=12: (36.729, 37.108)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate 95% Bayesian confidence interval for the mean</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">bayes_mvs</span><span class="p">(</span><span class="n">sample2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
<span class="n">ci_lower</span><span class="p">,</span> <span class="n">ci_upper</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Extract lower and upper bounds from the result object</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;95% confidence interval in the dataset with n=</span><span class="si">{</span><span class="n">n2</span><span class="si">}</span><span class="s2">: (</span><span class="si">{</span><span class="n">ci_lower</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ci_upper</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>95% confidence interval in the dataset with n=130: (36.691, 36.824)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="non-parametric-approach">
<h3>Non-parametric approach<a class="headerlink" href="#non-parametric-approach" title="Link to this heading">#</a></h3>
<section id="resampling">
<h4>Resampling<a class="headerlink" href="#resampling" title="Link to this heading">#</a></h4>
<p>This <strong>resampling</strong> method offers a flexible alternative to traditional statistical methods, as it doesn’t require the assumption of a normal (Gaussian) or any specific distribution for the data. Here’s how it works:</p>
<ul class="simple">
<li><p>Create numerous “pseudosamples”: repeatedly draw random samples (with replacement) from the original dataset, <strong>each with the same size as the original</strong>.</p></li>
<li><p>Calculate the statistic of interest: for each pseudosample, compute the mean (or any other parameter we’re interested in). This gives a large collection of estimates based on the original data.</p></li>
<li><p>Identify the percentiles: determine the <strong>2.5th and 97.5th percentiles</strong> of this collection of estimates. This range, which contains 95% of the resampled means, serves as the 95% confidence interval (CI) for the population mean.</p></li>
</ul>
<p>Remarkably, this resampling-based CI often aligns closely with the CI calculated using the conventional method that assumes a normal distribution. Extensive theoretical and simulation studies have validated this approach, leading some statisticians to advocate for its wider adoption.</p>
<p>The underlying principle behind resampling’s effectiveness is the Central Limit Theorem (again ;-). This theorem states that as we take more and more simple random samples from a population, the distribution of the sample means will approximate a normal distribution, regardless of the original population’s distribution. In other words, the average of the sample means will converge towards the true population mean as the number of samples increases. Learn more on bootstrap and computer-intensive methods in <a class="reference external" href="https://link.springer.com/chapter/10.1007/978-1-4419-5525-8_6">Wilcox (2010)</a> and <a class="reference external" href="https://doi.org/10.1201/9780429329203">Manly and Navarro Alberto (2020)</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set random seed for reproducibility</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="c1"># Number of resamples</span>
<span class="n">num_resamples</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="c1"># Resampling and mean calculation</span>
<span class="c1"># !Make sure to choose exactly N elements randomly **with replacement**</span>
<span class="c1"># from the original N-data point set, e.g., size=12 for sample1 set</span>
<span class="n">resampled_means</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
        <span class="n">sample1</span><span class="p">,</span>
        <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">sample1</span><span class="p">),</span>
        <span class="n">replace</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_resamples</span><span class="p">)]</span>

<span class="c1"># Calculate percentiles</span>
<span class="n">percentile_2_5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">resampled_means</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="n">percentile_97_5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">resampled_means</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">)</span>

<span class="c1"># Plot histogram</span>
<span class="c1"># plt.figure(figsize=(4, 3))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
    <span class="n">resampled_means</span><span class="p">,</span>
    <span class="n">bins</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">resampled_means</span><span class="p">))),</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Resampled means&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span>
    <span class="n">percentile_2_5</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;2.5th percentile&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span>
    <span class="n">percentile_97_5</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;97.5th percentile&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span>
    <span class="n">pop_mean</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;True population mean&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Resampled mean&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Histogram of resampled means</span><span class="se">\n</span><span class="s2">(n=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">sample1</span><span class="p">)</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">num_resamples</span><span class="si">}</span><span class="s2"> resamples)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>

<span class="c1"># Print percentiles</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;2.5th percentile: </span><span class="si">{</span><span class="n">percentile_2_5</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;97.5th percentile: </span><span class="si">{</span><span class="n">percentile_97_5</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.5th percentile: 36.769
97.5th percentile: 37.088
</pre></div>
</div>
<img alt="_images/436ca9107b83a857edf33b8d7ef94273e9a18b24d2a64933870baf5d1b95e0f7.png" src="_images/436ca9107b83a857edf33b8d7ef94273e9a18b24d2a64933870baf5d1b95e0f7.png" />
</div>
</div>
</section>
<section id="confidence-interval-of-a-proportion-via-resampling">
<h4>Confidence interval of a proportion via resampling<a class="headerlink" href="#confidence-interval-of-a-proportion-via-resampling" title="Link to this heading">#</a></h4>
<p>The bootstrap method isn’t limited to means; we can apply it to proportions as well. Let’s revisit the voting scenario from an earlier chapter, where 33 out of 100 people voted a certain way. Our goal is to estimate the 95% confidence interval for the true proportion of the population who would vote this way, assuming a population proportion of 0.33 for our simulation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Original sample size and proportion of interest</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">0.33</span>

<span class="c1"># Number of resamples</span>
<span class="n">num_resamples</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="c1"># Set random seed for reproducibility</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Generate original sample</span>
<span class="n">original_sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>  <span class="c1"># 1 for success, 0 for failure</span>

<span class="c1"># Resampling and proportion calculation</span>
<span class="n">resampled_proportions</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
        <span class="n">original_sample</span><span class="p">,</span>
        <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">,</span>
        <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_resamples</span><span class="p">)]</span>

<span class="c1"># Calculate percentiles for 95% CI</span>
<span class="n">percentile_2_5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">resampled_proportions</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="n">percentile_97_5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">resampled_proportions</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">)</span>

<span class="c1"># Plot histogram</span>
<span class="c1"># plt.figure(figsize=(4, 3))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
    <span class="n">resampled_proportions</span><span class="p">,</span>
    <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Resampled proportions&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span>
    <span class="n">percentile_2_5</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;2.5th percentile&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span>
    <span class="n">percentile_97_5</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;97.5th percentile&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span>
    <span class="n">p</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;True proportion&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Resampled proportion&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Histogram of resampled proportions </span><span class="se">\</span>
<span class="se">\n</span><span class="s1">(n=</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s1">, true p=</span><span class="si">{</span><span class="n">p</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">num_resamples</span><span class="si">}</span><span class="s1"> pseudosamples)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>

<span class="c1"># Print percentiles</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;95% bootstrap confidence interval for proportion: </span><span class="se">\</span>
<span class="s2">(</span><span class="si">{</span><span class="n">percentile_2_5</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">percentile_97_5</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="c1"># Calculate the 95% confidence interval for proportions using statsmodels.stats.proportion,</span>
<span class="c1"># now using binomial distrubution</span>
<span class="n">ci_lower</span><span class="p">,</span> <span class="n">ci_upper</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">proportion_confint</span><span class="p">(</span>
    <span class="n">count</span><span class="o">=</span><span class="mi">33</span><span class="p">,</span> <span class="n">nobs</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;binom_test&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The 95% confidence interval using statsmodels proportion_confint is </span><span class="se">\</span>
<span class="s2">(</span><span class="si">{</span><span class="n">ci_lower</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ci_upper</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>95% bootstrap confidence interval for proportion: (0.220, 0.400)
The 95% confidence interval using statsmodels proportion_confint is (0.244, 0.430)
</pre></div>
</div>
<img alt="_images/55263045f6c9cdbba24f47fc461317529f4e80d611c01cf9c1fd0ee266ae825e.png" src="_images/55263045f6c9cdbba24f47fc461317529f4e80d611c01cf9c1fd0ee266ae825e.png" />
</div>
</div>
</section>
<section id="bootstrap-with-pingouin">
<h4>Bootstrap with <code class="docutils literal notranslate"><span class="pre">pingouin</span></code><a class="headerlink" href="#bootstrap-with-pingouin" title="Link to this heading">#</a></h4>
<p>The <strong>bootstrap</strong> method doesn’t assume any particular distribution for the data, making it well-suited for analyzing complex or non-normal datasets. For example, the <a class="reference external" href="https://pingouin-stats.org/build/html/generated/pingouin.compute_bootci.html"><code class="docutils literal notranslate"><span class="pre">pingoui.compute_bootci</span></code> function</a> calculates bootstrapped confidence intervals of univariate and bivariate functions. Since version 1.7, SciPy also includes a built-in bootstrap function <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.bootstrap.html#scipy.stats.bootstrap"><code class="docutils literal notranslate"><span class="pre">scipy.stats.bootstrap</span></code></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pingouin</span> <span class="k">as</span> <span class="nn">pg</span>

<span class="c1"># Calculate 95% percentile bootstrap confidence interval</span>
<span class="n">ci</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">compute_bootci</span><span class="p">(</span>
    <span class="n">sample1</span><span class="p">,</span>
    <span class="n">func</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span>
    <span class="n">confidence</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span>
    <span class="n">method</span><span class="o">=</span><span class="s1">&#39;cper&#39;</span><span class="p">,</span> <span class="c1"># Bias-corrected percentile method (default)</span>
    <span class="n">seed</span><span class="o">=</span><span class="mi">111</span><span class="p">,</span>
    <span class="n">decimals</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">n_boot</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;95% Percentile Bootstrap Confidence Interval: (</span><span class="si">{</span><span class="n">ci</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ci</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>95% Percentile Bootstrap Confidence Interval: (36.768, 37.093)
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="the-ci-sd-and-sem">
<h2>The CI, SD and SEM<a class="headerlink" href="#the-ci-sd-and-sem" title="Link to this heading">#</a></h2>
<p>As we saw in one previous figure, larger samples tend to yield more precise estimates of population statistics, reflected in their narrower distributions. The standard deviation of a statistic derived from a sample is called the standard error of that statistic.  In the case of the sample mean, the standard error of the mean (SEM) or standard error (SE) is given by:</p>
<div class="math notranslate nohighlight">
\[\text{SE} = \frac{\sigma}{\sqrt{n}}\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma\)</span> is the (sample) standard deviation and <span class="math notranslate nohighlight">\(n\)</span> is the sample size. It’s important to remember that this calculation relies on the assumption that the sample standard deviation closely mirrors the population standard deviation, which is generally acceptable for samples of moderate or larger size. As the formula illustrates, the SEM is inversely proportional to the square root of the sample size. This confirms our intuitive understanding that larger samples lead to more precise estimates of the population mean, as evidenced by the smaller SEM.</p>
<p>We might also have noticed the term “standard error” or “standard error of the mean” appearing in previous calculations of the margin of error. Let’s take a closer look at the relationship between the confidence interval (CI) and the SEM, as they both play crucial roles in understanding the precision of our estimates.</p>
<p>A point estimate, such as the sample mean, gives us a single value to estimate a population parameter. However, estimates vary from sample to sample due to random sampling error. A confidence interval addresses this uncertainty by providing a range around the point estimate. This range is constructed to capture the true population parameter with a certain degree of confidence, often set at 95%. Wider intervals offer greater confidence in capturing the true parameter, but at the cost of reduced precision.</p>
<p>Recall that the SEM is a measure of how much the sample mean is expected to vary from sample to sample. It’s calculated as <span class="math notranslate nohighlight">\(\text{SEM}=\frac{s}{\sqrt{n}}\)</span>. It quantifies the variability we expect to see in sample means due to random sampling error. A smaller SEM indicates that the sample mean is likely to be closer to the true population mean.</p>
<p>The margin of error in a confidence interval is directly related to the SEM. It’s calculated by multiplying the SEM by a critical value (either from the t-distribution or the z-distribution) that corresponds to our desired confidence level: <span class="math notranslate nohighlight">\(W=t^* \times \text{SEM}\)</span>. The critical value depends on the chosen confidence level (e.g., 95% or 99%) and the degrees of freedom (if using the t-distribution).</p>
<p>Therefore, the confidence interval is essentially constructed by adding and subtracting the margin of error from the sample mean: <span class="math notranslate nohighlight">\(\text{CI} = m \pm W\)</span>.</p>
<p>In essence, the confidence interval uses the SEM as a building block to create a range of plausible values for the population mean. The width of the confidence interval reflects the level of uncertainty in our estimate:</p>
<ul class="simple">
<li><p>Narrow CI: smaller SEM, more precise estimate</p></li>
<li><p>Wide CI: larger SEM, less precise estimate</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">sem</span>

<span class="c1"># Calculate statistics</span>
<span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sample1</span><span class="p">)</span>
<span class="n">sd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">sample1</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Unbiased sample standard deviation</span>
<span class="n">sample_sem</span> <span class="o">=</span> <span class="n">sem</span><span class="p">(</span><span class="n">sample1</span><span class="p">)</span>

<span class="c1"># Critical value for 95% CI</span>
<span class="n">z_crit</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.975</span><span class="p">)</span>  <span class="c1"># Assuming normal distribution</span>
<span class="n">W</span> <span class="o">=</span>  <span class="n">z_crit</span> <span class="o">*</span> <span class="n">sample_sem</span>  <span class="c1"># margin of error</span>

<span class="c1"># Calculate confidence interval</span>
<span class="n">ci</span> <span class="o">=</span> <span class="p">(</span><span class="n">mean</span> <span class="o">-</span> <span class="n">W</span><span class="p">,</span> <span class="n">mean</span> <span class="o">+</span> <span class="n">W</span><span class="p">)</span>

<span class="c1"># Plotting</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>

<span class="c1"># SD error bar</span>
<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span>
    <span class="mi">1</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span>
    <span class="n">yerr</span><span class="o">=</span><span class="n">sd</span><span class="p">,</span>
    <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Standard Deviation (SD)&#39;</span><span class="p">)</span>

<span class="c1"># SEM error bar</span>
<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span>
    <span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span>
    <span class="n">yerr</span><span class="o">=</span><span class="n">sample_sem</span><span class="p">,</span>
    <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Standard Error of Mean (SEM)&#39;</span><span class="p">)</span>

<span class="c1"># 95% CI error bar</span>
<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span>
    <span class="mi">3</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span>
    <span class="n">yerr</span><span class="o">=</span><span class="n">W</span><span class="p">,</span>
    <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;95% Confidence Interval (CI)&#39;</span><span class="p">)</span>

<span class="c1"># Add labels and title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;SD&#39;</span><span class="p">,</span> <span class="s1">&#39;SEM&#39;</span><span class="p">,</span> <span class="s1">&#39;95% CI&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Value&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Comparison of SD, SEM, and 95% CI&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/00966c58562be4d184879d16b9e2cf8e137e8dc42de64d53bb8457584c013d57.png" src="_images/00966c58562be4d184879d16b9e2cf8e137e8dc42de64d53bb8457584c013d57.png" />
</div>
</div>
<ul class="simple">
<li><p>The error bar for SD is the longest, reflecting the variability of individual data points around the mean.</p></li>
<li><p>The SEM error bar is shorter than the SD, showing the reduced variability expected in sample means compared to individual data points.</p></li>
<li><p>The 95% CI error bar has a moderate width, indicating the range within which we are 95% confident that the true population mean lies.</p></li>
</ul>
</section>
<section id="the-confidence-interval-of-the-standard-deviation">
<h2>The confidence interval of the standard deviation<a class="headerlink" href="#the-confidence-interval-of-the-standard-deviation" title="Link to this heading">#</a></h2>
<p>Confidence intervals are a versatile tool in statistics, applicable to a wide range of values calculated from sample data, not just the mean. Under common assumptions - a roughly Gaussian population distribution, a random and representative sample, independent observations, accurate data, and a meaningful outcome - a 95% CI allows us to be 95% confident that the calculated interval captures the true population parameter of interest, whether it’s the standard deviation, a proportion, or another statistic.</p>
<p>While the <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> library doesn’t directly provide a function for calculating confidence intervals of standard deviation using the frequentist approach, it’s easy to implement it using the <strong>chi-squared</strong> distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">chi2</span>

<span class="k">def</span> <span class="nf">std_dev_conf_interval</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">confidence</span><span class="o">=</span><span class="mf">0.95</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the confidence interval for population standard deviation </span>
<span class="sd">    using the frequentist approach.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (array-like): The sample data.</span>
<span class="sd">        confidence (float): The desired confidence level (default: 0.95).</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: The lower and upper bounds of the confidence interval.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="c1"># First calculate the unbiased (ddof=1) sample standard deviation</span>
    <span class="n">sample_std_dev</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">confidence</span>
    <span class="c1"># CI for the population SD is derived from the chi-squared distribution with DF=n-1</span>
    <span class="c1"># Find the critical chi-squared values with PPF</span>
    <span class="n">chi2_lower</span> <span class="o">=</span> <span class="n">chi2</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">alpha</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">df</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">chi2_upper</span> <span class="o">=</span> <span class="n">chi2</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">df</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># Use sqrt((n - 1) * s**2 / crit_chi2)</span>
    <span class="n">lower_bound</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">sample_std_dev</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">chi2_upper</span><span class="p">)</span>
    <span class="n">upper_bound</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">sample_std_dev</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">chi2_lower</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">sample_std_dev</span><span class="p">,</span> <span class="n">lower_bound</span><span class="p">,</span> <span class="n">upper_bound</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="p">[</span><span class="n">sample1</span><span class="p">,</span> <span class="n">sample2</span><span class="p">]:</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SD and 5% confidence interval for standard deviation of sample with n=</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">(chi²): </span><span class="se">\n\t</span><span class="s2"> </span><span class="si">{</span><span class="n">std_dev_conf_interval</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SD and 5% confidence interval for standard deviation of sample with n=12 (chi²): 
	 (0.2976964334156459, 0.21088670986063496, 0.5054522302512634)
SD and 5% confidence interval for standard deviation of sample with n=130 (chi²): 
	 (0.38223178599879426, 0.34073809210625733, 0.4353236863653785)
</pre></div>
</div>
</div>
</div>
<p>We can also use the <code class="docutils literal notranslate"><span class="pre">scipy.stats.bayes_mvs</span></code> function to calculate Bayesian credible intervals for the standard deviation. This approach incorporates prior knowledge (or lack thereof) about the population parameters, which can be particularly useful when dealing with limited data. For sample size smaller than 1000, the function uses a generalized gamma distributed with shape parameters <span class="math notranslate nohighlight">\(c=-2\)</span> and <span class="math notranslate nohighlight">\(a=(n-1)/2\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="p">[</span><span class="n">sample1</span><span class="p">,</span> <span class="n">sample2</span><span class="p">]:</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>

    <span class="c1"># Calculate Bayesian credible interval for standard deviation (alpha = 0.95 for 95% CI)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">bayes_mvs</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SD and 95% confidence interval for standard deviation of sample with n=</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">(Bayes): </span><span class="se">\n\t</span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SD and 95% confidence interval for standard deviation of sample with n=12 (Bayes): 
	Std_dev(statistic=0.32011752574920377, minmax=(0.21088670986063499, 0.5054522302512634))
SD and 95% confidence interval for standard deviation of sample with n=130 (Bayes): 
	Std_dev(statistic=0.3844721557624937, minmax=(0.34073809210625733, 0.4353236863653785))
</pre></div>
</div>
</div>
</div>
<p>Comparable values for the SD and 95% CI can be obtained from the <a class="reference external" href="https://www.graphpad.com/quickcalcs/CISD2/">“Confidence interval of a SD” calculator from GraphPad</a>:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>n</p></th>
<th class="head"><p>SD</p></th>
<th class="head"><p>lower</p></th>
<th class="head"><p>upper</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>12</p></td>
<td><p>0.29769643341564590</p></td>
<td><p>0.21088691265180180</p></td>
<td><p>0.50545211062390770</p></td>
</tr>
<tr class="row-odd"><td><p>130</p></td>
<td><p>0.38223178599879420</p></td>
<td><p>0.34073641382308556</p></td>
<td><p>0.43532202087236800</p></td>
</tr>
</tbody>
</table>
<p>While the bootstrap method is distribution-free and can be particularly useful for non-normal data, its results can vary depending on the size of the dataset. For larger datasets, the bootstrap confidence interval might closely align with the results obtained from frequentist or Bayesian approaches. However, for smaller datasets, the bootstrap confidence interval might exhibit greater variability and potentially deviate from the results of other methods due to the inherent randomness in resampling.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set random seed for reproducibility</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">999</span><span class="p">)</span>

<span class="c1"># Number of resamples</span>
<span class="n">num_resamples</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sample</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="n">sample1</span><span class="p">,</span> <span class="n">sample2</span><span class="p">]):</span>
    <span class="c1"># Resampling and SD calculation</span>
    <span class="c1"># !Make sure to choose exactly N elements randomly **with replacement**</span>
    <span class="c1"># from the original N-data point set, e.g., size=12 for sample1 set</span>
    <span class="n">resampled_SDs</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
            <span class="n">sample</span><span class="p">,</span>
            <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">),</span>
            <span class="n">replace</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_resamples</span><span class="p">)]</span>

    <span class="c1"># Calculate mean and percentiles</span>
    <span class="n">percentile_2_5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">resampled_SDs</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
    <span class="n">percentile_97_5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">resampled_SDs</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">)</span>
    <span class="n">mean_sd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">resampled_SDs</span><span class="p">)</span>

    <span class="c1"># Plot histogram</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
        <span class="n">resampled_SDs</span><span class="p">,</span>
        <span class="n">bins</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">resampled_SDs</span><span class="p">))),</span>
        <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkslateblue&#39;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Resampled standard deviations&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span>
        <span class="n">percentile_2_5</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;2.5th percentile&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span>
        <span class="n">percentile_97_5</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;97.5th percentile&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span>
        <span class="n">pop_sd</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;True population SD&#39;</span><span class="p">)</span> 
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Resampled standard deviation&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Histogram of resampled standard deviations</span><span class="se">\n</span><span class="s2">(n=</span><span class="se">\</span>
<span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">num_resamples</span><span class="si">}</span><span class="s2"> replicates)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="c1"># Print percentiles</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SD and 5% confidence interval for standard deviation of sample with </span><span class="se">\</span>
<span class="s2">n=</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2"> (bootstrap): </span><span class="se">\n\t</span><span class="s2">(</span><span class="si">{</span><span class="n">mean_sd</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">percentile_2_5</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">percentile_97_5</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SD and 5% confidence interval for standard deviation of sample with n=130 (bootstrap): 
	(0.28174628821656056, 0.178, 0.361)
SD and 5% confidence interval for standard deviation of sample with n=130 (bootstrap): 
	(0.3798135496552976, 0.335, 0.425)
</pre></div>
</div>
<img alt="_images/08878083a506ab5779d58346bc2d26eb3ee04cda769c93863268f45087e0f52f.png" src="_images/08878083a506ab5779d58346bc2d26eb3ee04cda769c93863268f45087e0f52f.png" />
</div>
</div>
<p>If the histogram of bootstrap replicates of the standard deviation appears multimodal (i.e., has multiple peaks), it suggests non-normality of the underlying population distribution from which the sample is drawn, sampling variability, especially if the sample size is small, and/or an actual underlying structure in the population. In the current example, we know that the original population is totally normal, therefore the sampling variability, with the small sample size, may affect the bootstrap process.</p>
<p>When faced with a <em>multimodal bootstrap distribution</em> of standard deviations, the traditional methods of constructing confidence intervals (e.g., using percentiles or assuming normality) might not be appropriate. Alternative methods, e.g., Bias-Corrected and Accelerated (BCa) bootstrap or the bootstrapped-t method, can be more suitable.</p>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Link to this heading">#</a></h2>
<p>In this chapter, we’ve explored the fundamental concept of confidence intervals and their essential role in statistical inference. We’ve learned that confidence intervals provide a range of plausible values for population parameters, like the mean, and quantify the uncertainty associated with those estimates.</p>
<p>We delved into the different methods for calculating confidence intervals, including the t-distribution for smaller samples and the z-distribution for larger ones. We also explored the Bayesian approach, which incorporates prior information, and the non-parametric bootstrap method, which is particularly useful for complex or non-normal data.</p>
<p>We’ve seen how confidence intervals can be visualized using plots, helping us grasp the relationship between sample size, variability, and precision. We also examined the close connection between confidence intervals and the standard error of the mean, a key measure of the uncertainty in our sample mean estimate.</p>
<p>By mastering confidence intervals, we’ve gained a powerful tool for analyzing data and drawing meaningful conclusions in the field of biostatistics. But confidence intervals are not just about numbers; they are about understanding the uncertainty inherent in estimation and making informed decisions based on that understanding.</p>
</section>
<section id="cheat-sheet">
<h2>Cheat sheet<a class="headerlink" href="#cheat-sheet" title="Link to this heading">#</a></h2>
<p>This cheat sheet provides a quick reference for essential code snippets used in this chapter.</p>
<section id="t-distribution">
<h3>t-distribution<a class="headerlink" href="#t-distribution" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">t</span>

<span class="c1"># Define the degrees of freedom (e.g., sample size - 1)</span>
<span class="n">df</span> <span class="o">=</span> <span class="mi">27</span>

<span class="c1"># Define the t-distribution</span>
<span class="n">t_distribution</span> <span class="o">=</span> <span class="n">t</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># Calculate mean, variance (and more), median and SD from the model</span>
<span class="n">t_distribution</span><span class="o">.</span><span class="n">stats</span><span class="p">(</span><span class="n">moments</span><span class="o">=</span><span class="s1">&#39;mv&#39;</span><span class="p">)</span>
<span class="n">t_distribution</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">t_distribution</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
<span class="n">t_distribution</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="pdf-plot">
<h3>PDF Plot<a class="headerlink" href="#pdf-plot" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="c1"># central 99.8% of the distribution</span>
    <span class="n">x</span><span class="o">:=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
        <span class="n">t_distribution</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="mf">.001</span><span class="p">),</span> <span class="c1"># Percent Point Function</span>
        <span class="n">t_distribution</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="mf">.999</span><span class="p">),</span>
        <span class="n">num</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span>
    <span class="n">t_distribution</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> 
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="critical-t-values-and-z-values">
<h3>Critical t-values and z-values<a class="headerlink" href="#critical-t-values-and-z-values" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the desired confidence level (e.g., 95%)</span>
<span class="n">confidence_level</span> <span class="o">=</span> <span class="mf">0.95</span>

<span class="c1"># Calculate alpha (for two-tailed test)</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">confidence_level</span>

<span class="c1"># Calculate the critical t-value (two-tailed)</span>
<span class="n">t_critical</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">)</span> <span class="c1"># Percent Point Function</span>

<span class="c1"># Calculate critical bound t-values (direct method)</span>
<span class="n">t_critical_lower</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.025</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>  <span class="c1"># Lower critical value at q = 0.025</span>
<span class="n">t_critical_upper</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.975</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>  <span class="c1"># Upper critical value at q = 0.975</span>

<span class="c1"># Calculate the critical z-value (two-tailed)</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>

<span class="n">z_critical</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="confidence-interval">
<h3>Confidence interval<a class="headerlink" href="#confidence-interval" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Population parameters</span>
<span class="n">pop_mean</span> <span class="o">=</span> <span class="mf">36.8</span>  <span class="c1"># mean</span>
<span class="n">pop_sd</span> <span class="o">=</span> <span class="mf">0.4</span>     <span class="c1"># standard deviation</span>

<span class="c1"># Generate toy sample derived from Normal distribution</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">12</span>                     <span class="c1"># sample size</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span>
    <span class="n">loc</span><span class="o">=</span><span class="n">pop_mean</span><span class="p">,</span>
    <span class="n">scale</span><span class="o">=</span><span class="n">pop_sd</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="n">sample_mean</span> <span class="o">=</span> <span class="mf">36.9184</span>      <span class="c1"># or use np.mean(sample)</span>
<span class="n">sample_sd</span> <span class="o">=</span> <span class="mf">0.2977</span>         <span class="c1"># or use np.std(sample, ddof=1)</span>


<span class="c1">### Manual calculation of the CI</span>
<span class="c1"># Calculate the critical t-value</span>
<span class="n">t_critical</span> <span class="o">=</span> <span class="n">t</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">alpha</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># Percent Point Function</span>

<span class="c1"># Calculate the standard error of the mean</span>
<span class="n">sem</span> <span class="o">=</span> <span class="n">sample_sd</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>  <span class="c1"># or use scipy.stats.sem on data</span>
<span class="c1">#sem = pop_sd / np.sqrt(n)  # if population SD is known</span>

<span class="c1"># Calculate margin of error</span>
<span class="n">margin_error</span> <span class="o">=</span> <span class="n">t_critical</span> <span class="o">*</span> <span class="n">sem</span>
<span class="c1">#margin_error = z_critical * sem  # large sample sizes and/or known population SD</span>

<span class="c1"># Calculate confidence intervals</span>
<span class="p">(</span><span class="n">sample_mean</span> <span class="o">-</span> <span class="n">margin_error</span><span class="p">,</span> <span class="n">sample_mean</span> <span class="o">+</span> <span class="n">margin_error</span><span class="p">)</span>


<span class="c1">### Computational calculation of the CI</span>
<span class="c1"># Frequentist - Small sample size and unknown population SD</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>

<span class="n">sm</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">DescrStatsW</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span><span class="o">.</span><span class="n">tconfint_mean</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">confidence_level</span><span class="p">)</span>

<span class="c1"># Equivalent to</span>
<span class="n">t</span><span class="o">.</span><span class="n">interval</span><span class="p">(</span>
    <span class="n">confidence</span><span class="o">=</span><span class="n">confidence_level</span><span class="p">,</span>
    <span class="n">df</span><span class="o">=</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">loc</span><span class="o">=</span><span class="n">sample_mean</span><span class="p">,</span>
    <span class="n">scale</span><span class="o">=</span><span class="n">sem</span><span class="p">)</span> <span class="c1"># here scale is SE, no SD as in normal distribution</span>


<span class="c1"># Frequentist - Large sample size and/or known population SD</span>
<span class="n">norm</span><span class="o">.</span><span class="n">interval</span><span class="p">(</span>
    <span class="n">confidence</span><span class="o">=</span><span class="n">confidence_level</span><span class="p">,</span>
    <span class="n">loc</span><span class="o">=</span><span class="n">sample_mean</span><span class="p">,</span>
    <span class="n">scale</span><span class="o">=</span><span class="n">pop_sd</span><span class="p">)</span> <span class="c1"># or sample_sd</span>


<span class="c1"># Bayesian</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">bayes_mvs</span>

<span class="c1"># If n&lt;1000, it uses the frequentist approach with the t-distribution</span>
<span class="n">bayes_mvs</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># extract `minmax` tuple from `mean`</span>
<span class="c1"># bayes_mvs(sample, alpha=0.95) # returns mean, var and SD with 95% credible intervals</span>
</pre></div>
</div>
</section>
<section id="plot-ci-errorbar">
<h3>Plot CI errorbar<a class="headerlink" href="#plot-ci-errorbar" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 95% CI error bar</span>
<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sample_mean</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">margin_error</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="bootstrap">
<h3>Bootstrap<a class="headerlink" href="#bootstrap" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pingouin</span> <span class="k">as</span> <span class="nn">pg</span>

<span class="c1"># Calculate 95% percentile bootstrap confidence interval</span>
<span class="n">pg</span><span class="o">.</span><span class="n">compute_bootci</span><span class="p">(</span>
    <span class="n">sample</span><span class="p">,</span>
    <span class="n">func</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span>
    <span class="n">confidence</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span>
    <span class="n">method</span><span class="o">=</span><span class="s1">&#39;cper&#39;</span><span class="p">,</span> <span class="c1"># Bias-corrected percentile method (default)</span>
    <span class="n">seed</span><span class="o">=</span><span class="mi">111</span><span class="p">,</span>
    <span class="n">decimals</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">n_boot</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="c1"># Resampling and mean calculation</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>    <span class="c1"># for reproducibility</span>
<span class="n">num_replicates</span> <span class="o">=</span> <span class="mi">10000</span> <span class="c1"># number of replicates</span>

<span class="c1"># !Make sure to choose exactly N elements randomly **with replacement**</span>
<span class="c1"># from the original N-data point set</span>
<span class="n">resampled_means</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
        <span class="n">sample</span><span class="p">,</span>
        <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">),</span>
        <span class="n">replace</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_replicates</span><span class="p">)]</span>

<span class="c1"># Calculate percentiles</span>
<span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">resampled_means</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">resampled_means</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">)</span>

<span class="c1"># Plot the histogram</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">resampled_means</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">resampled_means</span><span class="p">))))</span>
</pre></div>
</div>
</section>
</section>
<section id="session-information">
<h2>Session Information<a class="headerlink" href="#session-information" title="Link to this heading">#</a></h2>
<p>The output below details all packages and version necessary to reproduce the results in this report.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>python<span class="w"> </span>--version
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-------------&quot;</span><span class="p">)</span>
<span class="c1"># List of packages we want to check the version</span>
<span class="n">packages</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;numpy&#39;</span><span class="p">,</span> <span class="s1">&#39;pandas&#39;</span><span class="p">,</span> <span class="s1">&#39;scipy&#39;</span><span class="p">,</span> <span class="s1">&#39;statsmodels&#39;</span><span class="p">,</span> <span class="s1">&#39;pingouin&#39;</span><span class="p">,</span> <span class="s1">&#39;matplotlib&#39;</span><span class="p">,</span> <span class="s1">&#39;seaborn&#39;</span><span class="p">]</span>

<span class="c1"># Initialize an empty list to store the versions</span>
<span class="n">versions</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Loop over the packages</span>
<span class="k">for</span> <span class="n">package</span> <span class="ow">in</span> <span class="n">packages</span><span class="p">:</span>
    <span class="c1"># Get the version of the package</span>
    <span class="n">output</span> <span class="o">=</span> <span class="o">!</span>pip<span class="w"> </span>show<span class="w"> </span><span class="o">{</span>package<span class="o">}</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>findstr<span class="w"> </span><span class="s2">&quot;Version&quot;</span>
    <span class="c1"># If the output is not empty, get the version</span>
    <span class="k">if</span> <span class="n">output</span><span class="p">:</span>
        <span class="n">version</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">version</span> <span class="o">=</span> <span class="s1">&#39;Not installed&#39;</span>
    <span class="c1"># Append the version to the list</span>
    <span class="n">versions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">version</span><span class="p">)</span>

<span class="c1"># Print the versions</span>
<span class="k">for</span> <span class="n">package</span><span class="p">,</span> <span class="n">version</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">packages</span><span class="p">,</span> <span class="n">versions</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">package</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">version</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Python 3.12.4
-------------
numpy: 1.26.4
pandas: 2.2.2
scipy: 1.13.1
statsmodels: 0.14.2
pingouin: 0.5.4
matplotlib: 3.9.0
seaborn: 0.13.2
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="10%20-%20Gaussian%20Distribution.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">The Gaussian Distribution</p>
      </div>
    </a>
    <a class="right-next"
       href="15%20-%20P%20Values%20and%20Statistical%20Significance.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">P Values and Statistical Significance</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-t-distribution">The t-distribution</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#origin-of-the-t-distribution">Origin of the t-distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-scipy-stats-to-obtain-critical-t-values">Using <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> to obtain critical t-values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sign-of-the-critical-t-value">Sign of the critical t-value</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-the-t-distribution">Visualizing the t-distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#approaching-the-standard-normal">Approaching the Standard Normal</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-the-confidence-interval-of-a-mean">Calculating the confidence interval of a mean</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-t-statistic">The t-statistic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-flip">The flip</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-of-body-temperatures">Example of body temperatures</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#critical-z-vs-t-values">Critical z- vs. t-values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#python-tools-for-confidence-interval-calculation">Python tools for confidence interval calculation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#frequentist-normal-distribution">Frequentist - Normal distribution</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#frequentist-student-t-distribution">Frequentist - Student/t-distribution</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bayesian-approach">Bayesian approach</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#non-parametric-approach">Non-parametric approach</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#resampling">Resampling</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#confidence-interval-of-a-proportion-via-resampling">Confidence interval of a proportion via resampling</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrap-with-pingouin">Bootstrap with <code class="docutils literal notranslate"><span class="pre">pingouin</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-ci-sd-and-sem">The CI, SD and SEM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-confidence-interval-of-the-standard-deviation">The confidence interval of the standard deviation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cheat-sheet">Cheat sheet</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#t-distribution">t-distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pdf-plot">PDF Plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#critical-t-values-and-z-values">Critical t-values and z-values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#confidence-interval">Confidence interval</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-ci-errorbar">Plot CI errorbar</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrap">Bootstrap</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#session-information">Session Information</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Sébastien Wieckowski
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>