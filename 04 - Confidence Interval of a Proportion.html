

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>04 - Confidence Interval of a Proportion &#8212; The Python Companion of Intuitive Biostatistics</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '04 - Confidence Interval of a Proportion';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="05 - Confidence Interval of Survival Data" href="05%20-%20Confidence%20Interval%20of%20Survival%20Data.html" />
    <link rel="prev" title="Companion Guide to “Intuitive Biostatistics, 4th edition” by Harvey Motulsky" href="README.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="README.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.jpg" class="logo__image only-light" alt="The Python Companion of Intuitive Biostatistics - Home"/>
    <script>document.write(`<img src="_static/logo.jpg" class="logo__image only-dark" alt="The Python Companion of Intuitive Biostatistics - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="README.html">
                    Companion Guide to “Intuitive Biostatistics, 4th edition” by Harvey Motulsky
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">04 - Confidence Interval of a Proportion</a></li>
<li class="toctree-l1"><a class="reference internal" href="05%20-%20Confidence%20Interval%20of%20Survival%20Data.html">05 - Confidence Interval of Survival Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="06%20-%20Confidence%20Interval%20of%20Counted%20Data%20%28Poisson%20Distribution%29.html">06 - Confidence Interval of Counted Data (Poisson Distribution)</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/sbwiecko/intuitive_biostatistics_python" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/sbwiecko/intuitive_biostatistics_python/edit/main/04 - Confidence Interval of a Proportion.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/04 - Confidence Interval of a Proportion.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>04 - Confidence Interval of a Proportion</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-a-confidence-interval">What is a Confidence Interval?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-a-proportion">What is a proportion?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Confidence interval of a proportion</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#binomial-distribution">Binomial distribution</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#practical-example-with-np-random-binomial-single-coin-flip">Practical example with <code class="docutils literal notranslate"><span class="pre">np.random.binomial</span></code> - Single coin flip</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-coin-flips">Multiple coin flips</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#probability-and-frequency">Probability and frequency</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-scipy-stats-binom-methods">Using <code class="docutils literal notranslate"><span class="pre">scipy.stats.binom</span></code> methods</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simulating-a-clinical-trial-scenario-using-the-binomial-distribution">Simulating a clinical trial scenario using the binomial distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-example-of-the-democrat-voters">The example of the Democrat voters</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#confidence-interval">Confidence interval</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#confidence-interval-for-free-throw-success-rate">Confidence interval for free throw success rate</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-central-limit-theorem">The Central Limit Theorem</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-the-confidence-interval">Computing the confidence interval</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#confidence-interval-of-the-polling-voters">Confidence interval of the polling voters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-does-95-confidence-really-mean">What does 95% confidence really mean?</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#session-information">Session Information</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="confidence-interval-of-a-proportion">
<h1>04 - Confidence Interval of a Proportion<a class="headerlink" href="#confidence-interval-of-a-proportion" title="Permalink to this heading">#</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">#</a></h2>
<p>Welcome to the chapter on the Confidence Interval of a Proportion. This is a fundamental concept in biostatistics that allows us to estimate the range within which a population parameter lies, based on our sample data.</p>
<section id="what-is-a-confidence-interval">
<h3>What is a Confidence Interval?<a class="headerlink" href="#what-is-a-confidence-interval" title="Permalink to this heading">#</a></h3>
<p>A confidence interval is a range of values, derived from a data set, that is likely to contain the value of an unknown population parameter. It provides an estimated range of values which is likely to include an unknown population parameter, the estimated range being calculated from a given set of sample data.</p>
</section>
<section id="what-is-a-proportion">
<h3>What is a proportion?<a class="headerlink" href="#what-is-a-proportion" title="Permalink to this heading">#</a></h3>
<p>In statistics, a proportion refers to the fraction of the total that carries a certain characteristic. For example, if we have a sample of 100 individuals and 45 of them are female, the proportion of females in the sample is <span class="math notranslate nohighlight">\(45/100 = 0.45\)</span>.</p>
</section>
<section id="id1">
<h3>Confidence interval of a proportion<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<p>When we talk about the confidence interval of a proportion, we’re trying to find a range that likely contains the true proportion of the population that carries a certain characteristic. This is based on the proportion we’ve found in our sample.</p>
<p>In this chapter, we will learn how to calculate the confidence interval of a proportion using Python with the <code class="docutils literal notranslate"><span class="pre">numpy</span></code> and <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> packages. We will also discuss the interpretation of confidence intervals, the impact of sample size on the confidence interval, and common misconceptions about confidence intervals.</p>
<p>By the end of this chapter, we should be able to calculate and interpret the confidence interval of a proportion, and understand its importance in the field of biostatistics. Let’s dive in!</p>
</section>
</section>
<section id="binomial-distribution">
<h2>Binomial distribution<a class="headerlink" href="#binomial-distribution" title="Permalink to this heading">#</a></h2>
<p>The Binomial Distribution is a crucial concept in statistics and probability theory that describes the number of successes in a sequence of independent experiments.</p>
<p>A <strong>binomial distribution</strong> can be thought of as simply the probability of a SUCCESS or FAILURE outcome in an experiment or survey that is repeated multiple times. The binomial is a type of distribution that has <strong>two possible outcomes</strong> (the prefix ‘bi’ means two, or twice).</p>
<section id="practical-example-with-np-random-binomial-single-coin-flip">
<h3>Practical example with <code class="docutils literal notranslate"><span class="pre">np.random.binomial</span></code> - Single coin flip<a class="headerlink" href="#practical-example-with-np-random-binomial-single-coin-flip" title="Permalink to this heading">#</a></h3>
<p>When we flip a coin once, there are two possible outcomes: heads (H) or tails (T). If the coin is fair, the probability of getting heads <span class="math notranslate nohighlight">\(P(H)\)</span> is 0.5, and the probability of getting tails <span class="math notranslate nohighlight">\(P(T)\)</span> is also 0.5. This is because a fair coin is equally likely to land on either side.</p>
<p>This scenario can be modeled as a binomial distribution with parameters n=1 (number of trials) and p=0.5 (probability of success on each trial). In this case, a “success” could be defined as getting heads. Here’s how we can simulate a single coin flip in Python:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># number of coin flips</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># probability of getting heads</span>

<span class="c1"># Simulate a single coin flip</span>
<span class="n">flip_result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

<span class="c1"># Check the result</span>
<span class="k">if</span> <span class="n">flip_result</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Heads&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tails&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Heads
</pre></div>
</div>
</div>
</div>
<p>In this script, <code class="docutils literal notranslate"><span class="pre">np.random.binomial(n,</span> <span class="pre">p)</span></code> generates a random number that follows a binomial distribution. It returns the number of successes (heads, in this case), which can be either 0 or 1 for a single coin flip. Although we can calculate the probabilities exactly for a single coin flip, real-world phenomena often involve more complex situations with multiple trials, which is where the binomial distribution becomes truly useful.</p>
</section>
<section id="multiple-coin-flips">
<h3>Multiple coin flips<a class="headerlink" href="#multiple-coin-flips" title="Permalink to this heading">#</a></h3>
<p>Let’s now simulate 10,000 experiments of flipping a coin 10 times each, calculates the mean number of heads across all experiments, and visualize the results.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Parameters of the binomial distribution</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># number of coin flips per experiment</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># probability of getting heads</span>

<span class="c1"># Number of experiments</span>
<span class="n">num_experiments</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="c1"># Simulate the experiments</span>
<span class="n">experiments</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">num_experiments</span><span class="p">)</span>

<span class="c1"># Calculate the mean number of heads</span>
<span class="n">mean_heads</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">experiments</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean number of heads out of 10 flips in </span><span class="si">{</span><span class="n">num_experiments</span><span class="si">}</span><span class="s2"> experiments: </span><span class="si">{</span><span class="n">mean_heads</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean number of heads out of 10 flips in 10000 experiments: 4.9983
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">experiments</span></code> array contains 10,000 values ranging from 0 to 10, with the mean number showed above. Let’s plot a histogram to visualize the distribution of the number of heads in these experiments.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
    <span class="n">experiments</span><span class="p">,</span>
    <span class="n">bins</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span>
    <span class="n">align</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
    <span class="n">rwidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orangered&#39;</span><span class="p">,</span>
    <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
    <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Number of Heads&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Histogram of Heads in </span><span class="si">{</span><span class="n">num_experiments</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> Coin Flip Experiments&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/fc2e0b1210fcfb58bae95f123678927d6b2201afd3132cbaefceebe4cdfcbf58.png" src="_images/fc2e0b1210fcfb58bae95f123678927d6b2201afd3132cbaefceebe4cdfcbf58.png" />
</div>
</div>
<p>A histogram is a graphical representation that organizes a group of data points into a specified range. In this case, the data points are the number of heads obtained in each of the 10,000 experiments of flipping a coin 10 times. The x-axis represents the number of heads obtained in each experiment, which can range from 0 to 10. The y-axis represents the frequency, i.e., the number of experiments that resulted in a certain number of heads. Each bar in the histogram corresponds to the number of heads (from 0 to 10). The height of each bar represents the number of experiments that resulted in that many heads.</p>
<p>For a fair coin, we would expect the most common outcome to be <strong>around 5 heads</strong>, so the tallest bar should be around the middle of the histogram. This is because the <strong>binomial distribution is symmetric</strong> for a fair coin (<span class="math notranslate nohighlight">\(p=0.5\)</span>).</p>
<p>In summary, the histogram provides a visual representation of the distribution of outcomes over many repeated experiments, and it should reflect the properties of the binomial distribution given a large enough number of experiments. It’s a great way to intuitively understand the concept of a binomial distribution. Happy learning!</p>
</section>
<section id="probability-and-frequency">
<h3>Probability and frequency<a class="headerlink" href="#probability-and-frequency" title="Permalink to this heading">#</a></h3>
<p><strong>Probability</strong> is a statistical measure that shows the likelihood of an event to happen. It is quantified as a number between 0 and 1, where 0 indicates that the event will not happen and 1 indicates that the event will definitely happen. In our coin flipping experiment, the probability of getting heads (or tails) in a single flip of a fair coin is 0.5, meaning there’s a 50% chance we’ll get heads (or tails).</p>
<p><strong>Frequency</strong>, on the other hand, is a measure of the number of times an event occurs. For example, if we flip a coin 10 times and get heads 7 times, the frequency of heads is 7. When we repeat an experiment many times, like flipping a coin 10,000 times, we can calculate the frequency of each outcome (number of heads). This gives us an empirical or observed probability, which should be close to the theoretical probability if we repeat the experiment enough times.</p>
<p>In a large number of trials, the relative frequency (the frequency of an event divided by the total number of trials) can approximate the probability of an event. However, probability is a theoretical concept based on the nature of the experiment, while frequency is an empirical concept based on actual data or experiments.</p>
<p>Here for example we can answer the question</p>
<blockquote>
<div><p>If we flip a coin fairly 10 times, what is the chance of observing 7 <em>or more</em> heads?</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">freq_7</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">experiments</span> <span class="o">&gt;=</span> <span class="mi">7</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10000</span>
<span class="nb">print</span><span class="p">(</span><span class="n">freq_7</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.1701
</pre></div>
</div>
</div>
</div>
</section>
<section id="using-scipy-stats-binom-methods">
<h3>Using <code class="docutils literal notranslate"><span class="pre">scipy.stats.binom</span></code> methods<a class="headerlink" href="#using-scipy-stats-binom-methods" title="Permalink to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">scipy.stats.binom</span></code> is a function in the <a class="reference external" href="https://scipy.org/">SciPy library</a> in Python that provides a suite of methods for the binomial distribution. Here’s a brief introduction to some of the main methods provided by it:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pmf(k,</span> <span class="pre">n,</span> <span class="pre">p)</span></code>: This is the Probability Mass Function (PMF). It gives the probability of getting exactly k successes (heads) in n trials (flips), when the probability of success on any given trial is p.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cdf(k,</span> <span class="pre">n,</span> <span class="pre">p)</span></code>: This is the Cumulative Distribution Function (CDF). It gives the probability of getting k or fewer successes in n trials.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sf(k)</span></code>: The Survival Function (SF) is defined as <span class="math notranslate nohighlight">\(1 - \text{cdf}(k)\)</span>, and it gives the probability of getting more than k successes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mean(n,</span> <span class="pre">p)</span></code>, <code class="docutils literal notranslate"><span class="pre">var(n,</span> <span class="pre">p)</span></code>, <code class="docutils literal notranslate"><span class="pre">std(n,</span> <span class="pre">p)</span></code>: These functions return the mean, variance, and standard deviation of the binomial distribution respectively.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rvs(n,</span> <span class="pre">p,</span> <span class="pre">size)</span></code>: This function generates random variates in a given shape.</p></li>
</ul>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">binom</span></code> function in <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> takes only two parameters: <code class="docutils literal notranslate"><span class="pre">n</span></code> (number of trials) and <code class="docutils literal notranslate"><span class="pre">p</span></code> (probability of success on each trial). The <code class="docutils literal notranslate"><span class="pre">binom(n,</span> <span class="pre">p).rvs(num_trials)</span></code> from <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> and <code class="docutils literal notranslate"><span class="pre">np.random.binomial(n,</span> <span class="pre">p,</span> <span class="pre">num_trials)</span></code> from <code class="docutils literal notranslate"><span class="pre">numpy</span></code> are equivalent. Both of these functions generate <code class="docutils literal notranslate"><span class="pre">num_trials</span></code> random variates from a binomial distribution with <code class="docutils literal notranslate"><span class="pre">n</span></code> trials and <code class="docutils literal notranslate"><span class="pre">p</span></code> probability of success on each trial.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">binom</span>

<span class="c1"># Number of trials and probability of success</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">binom</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

<span class="c1"># calculates the mean and variance of a binomial distribution with </span>
<span class="c1"># n trials and p probability of success on each trial.</span>
<span class="n">model</span><span class="o">.</span><span class="n">stats</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(5.0, 2.5)
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">ppf</span></code> function stands for Percent Point Function (PPF), which is also known as the inverse of the Cumulative Distribution Function (CDF). The <code class="docutils literal notranslate"><span class="pre">ppf</span></code> takes a probability and returns the corresponding x-value (or point) in the distribution such that the probability of observing a value less than or equal to that point is the given probability.</p>
<p>When we plot from <code class="docutils literal notranslate"><span class="pre">ppf(0.001)</span></code> to <code class="docutils literal notranslate"><span class="pre">ppf(0.999)</span></code>, we’re essentially plotting the range of x-values (or points) that contain the <em>central 99.8%</em> of the distribution. This range excludes the extreme 0.1% on either end of the distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the percent point function values</span>
<span class="c1">#x_start = binom.ppf(0.001, n, p)</span>
<span class="n">x_start</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span> <span class="c1"># the distribution/model was previously set up</span>
<span class="c1"># x_end = binom.ppf(0.999, n, p)</span>
<span class="n">x_end</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">.999</span><span class="p">)</span>

<span class="c1"># Generate x values</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">x_start</span><span class="p">,</span> <span class="n">x_end</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Calculate the probability mass function values</span>
<span class="c1">#pmf_values = binom.pmf(x, n, p)</span>
<span class="n">pmf_values</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="c1"># Plot the PMF</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pmf_values</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="c1"># lollipop style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">pmf_values</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Binomial Distribution PMF&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Number of Successes&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Probability&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/37a9fd3c7023fbfac4c7ca7cefea5d4cae574981a75c6354cce1b6152cf458de.png" src="_images/37a9fd3c7023fbfac4c7ca7cefea5d4cae574981a75c6354cce1b6152cf458de.png" />
</div>
</div>
</section>
<section id="simulating-a-clinical-trial-scenario-using-the-binomial-distribution">
<h3>Simulating a clinical trial scenario using the binomial distribution<a class="headerlink" href="#simulating-a-clinical-trial-scenario-using-the-binomial-distribution" title="Permalink to this heading">#</a></h3>
<p>Let’s say we’re conducting a clinical trial for a new drug. We have 30 patients in the trial, and we’re interested in the number of patients who show improvement with the medication, or said differently, what is the chance that 10 <em>or more</em> of the next 30 patients will get better. Based on previous studies, we estimate that the probability of a patient showing improvement is 0.05 (5%). Here’s how we can simulate this scenario 10,000 times.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Parameters of the binomial distribution</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">30</span>  <span class="c1"># number of patients</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">0.05</span>  <span class="c1"># probability of a patient showing improvement</span>

<span class="c1"># Number of trials</span>
<span class="n">num_trials</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="c1"># Simulate the trials</span>
<span class="n">trials</span> <span class="o">=</span> <span class="n">binom</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">num_trials</span><span class="p">)</span>

<span class="c1"># Calculate the mean number of improvements</span>
<span class="n">mean_improvements</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">trials</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean number of improvements in </span><span class="si">{</span><span class="n">num_trials</span><span class="si">}</span><span class="s2"> trials: </span><span class="si">{</span><span class="n">mean_improvements</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean number of improvements in 10000 trials: 1.5002
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trials</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([2, 0, 0, ..., 3, 1, 2], dtype=int64)
</pre></div>
</div>
</div>
</div>
<p>The script returns the array <code class="docutils literal notranslate"><span class="pre">trials</span></code> of length 10,000 where each element is the number of improvements in a trial, and then calculates the mean number of improvements across all trials.</p>
<p>To calculate the probability of getting exactly 10 improvements out of 30 in a single trial, we can use the Probability Mass Function (PMF) of the binomial distribution. In Python, we can use the <code class="docutils literal notranslate"><span class="pre">binom.pmf</span></code> function from the <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> module.</p>
<p>Overall this simulation can give us a sense of the variability we might expect in the number of improvements when conducting the clinical trial multiple times. It’s a powerful tool for understanding the potential outcomes and risks associated with the trial.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the probability of getting exactly 10 improvements</span>
<span class="n">prob</span> <span class="o">=</span> <span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The probability of getting exactly 10 improvements in a single trial is </span><span class="si">{</span><span class="n">prob</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The probability of getting exactly 10 improvements in a single trial is 0.000
</pre></div>
</div>
</div>
</div>
<p>Or we can simply count the number of trials that resulted in 10 improvements:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the frequency of getting exactly 10 improvements</span>
<span class="n">freq</span> <span class="o">=</span> <span class="p">(</span><span class="n">trials</span> <span class="o">==</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The frequency of getting exactly 10 improvements in </span><span class="si">{</span><span class="n">num_trials</span><span class="si">}</span><span class="s2"> trials is </span><span class="si">{</span><span class="n">freq</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The frequency of getting exactly 10 improvements in 10000 trials is 0
</pre></div>
</div>
</div>
</div>
<p>Let’s finally plot a histogram to visualize the distribution of improvements.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the histogram</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
    <span class="n">trials</span><span class="p">,</span>
    <span class="n">bins</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span>
    <span class="n">align</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
    <span class="n">rwidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
    <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
    <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1"># normalizes the histogram</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Histogram of Improvements in </span><span class="si">{</span><span class="n">num_trials</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> Clinical Trials&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Number of Improvements&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">.5</span><span class="p">,</span> <span class="mf">8.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7c903cf3b81686c7a41c3177407b5310116cbf55025186b96a8e710962c8fd90.png" src="_images/7c903cf3b81686c7a41c3177407b5310116cbf55025186b96a8e710962c8fd90.png" />
</div>
</div>
</section>
<section id="the-example-of-the-democrat-voters">
<h3>The example of the Democrat voters<a class="headerlink" href="#the-example-of-the-democrat-voters" title="Permalink to this heading">#</a></h3>
<p>Let’s calculate the answer for the question of the book</p>
<blockquote>
<div><p>If 40% of voters are Democrats, what is the chance that a random sample of 600 voters will be at least 45% Democrat?</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Parameters of the binomial distribution</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">600</span>  <span class="c1"># number of voters in the sample</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">0.4</span>  <span class="c1"># probability of a voter being a Democrat</span>

<span class="c1"># Number of successes we&#39;re interested in</span>
<span class="n">k</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.45</span> <span class="o">*</span> <span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c1"># subtract 1 because we want at least 45%, not up to 45%</span>

<span class="c1"># Calculate the probability of getting at least 45% Democrats</span>
<span class="n">prob</span> <span class="o">=</span> <span class="n">binom</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The probability of getting at least 45% Democrats in the sample is </span><span class="si">{</span><span class="n">prob</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The probability of getting at least 45% Democrats in the sample is 0.007
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span>   <span class="c1"># linspace not appropriate for non-continuous distributions</span>
    <span class="n">binom</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">.001</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">),</span>
    <span class="n">binom</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">.999</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="c1"># include the point at the 99.9th percentile</span>
    <span class="n">step</span><span class="o">=</span><span class="mi">1</span>
    <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">binom</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Binomial Distribution PMF&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Number of Democrats&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Probability&#39;</span><span class="p">);</span>
<span class="c1">#plt.vlines(x, 0, binom.pmf(x, n, p), colors=&#39;b&#39;, lw=5, alpha=.5);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9a1f476a9668ea0f70f155d8c07e39ef2f216e7eda3b29626ca826306ebd2c4f.png" src="_images/9a1f476a9668ea0f70f155d8c07e39ef2f216e7eda3b29626ca826306ebd2c4f.png" />
</div>
</div>
<p>The previous script gives a theoretical calculation based on the binomial distribution, not an empirical result based on random sampling. Let’s try the random sampling approach.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Parameters of the binomial distribution</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">600</span>  <span class="c1"># number of voters in the sample</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">0.4</span>  <span class="c1"># probability of a voter being a Democrat</span>

<span class="c1"># Number of simulations</span>
<span class="n">num_simulations</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="c1"># Number of successes we&#39;re interested in</span>
<span class="n">k</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.45</span> <span class="o">*</span> <span class="n">n</span><span class="p">)</span>  <span class="c1"># at least 45% Democrats</span>

<span class="c1"># Simulate the samples</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">binom</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">num_simulations</span><span class="p">)</span>

<span class="c1"># Calculate the frequency of getting at least k Democrats</span>
<span class="n">freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">samples</span> <span class="o">&gt;=</span> <span class="n">k</span><span class="p">)</span>

<span class="c1"># Calculate the empirical probability</span>
<span class="n">empirical_prob</span> <span class="o">=</span> <span class="n">freq</span> <span class="o">/</span> <span class="n">num_simulations</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The empirical probability of getting at least 45% Democrats in the sample is </span><span class="se">\</span>
<span class="si">{</span><span class="n">empirical_prob</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The empirical probability of getting at least 45% Democrats in the sample is 0.0074
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plt.hist(samples, bins=range(n+2), align=&#39;left&#39;, color=&#39;blue&#39;, density=True)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Histogram of Democrats in Simulated Samples&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Number of Democrats&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">195</span><span class="p">,</span> <span class="mi">285</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Counts&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/6ff53a37d2d873be6b608e78112fb42b3c2f4f4ae612a6b76c9f1a49e35fa45a.png" src="_images/6ff53a37d2d873be6b608e78112fb42b3c2f4f4ae612a6b76c9f1a49e35fa45a.png" />
</div>
</div>
<p>This histogram gives we a visual representation of the distribution of Democrats in the simulated samples. Each bar represents the number of samples that resulted in a certain number of Democrats.</p>
<p>Now, every time we run the script, it generates a new set of random samples from the binomial distribution, which can result in a slightly different distribution each time. This is due to the inherent randomness in the sampling process. However, despite these differences, all the distributions generated will have the same underlying characteristics defined by the binomial distribution with parameters <code class="docutils literal notranslate"><span class="pre">n</span></code> (number of trials) and <code class="docutils literal notranslate"><span class="pre">p</span></code> (probability of success). In other words, they are all samples from the same population distribution.</p>
<p>Over a large number of simulations, the distribution of the results should converge to the theoretical binomial distribution. This is known as the <strong>Law of Large Numbers</strong>, which states that as the number of trials increases, the <strong>experimental probability</strong> (observed proportion in the simulation) gets closer to the <strong>theoretical probability</strong> (defined by the binomial distribution).</p>
<p>So, while each run of the script may produce a slightly different distribution due to randomness, the overall shape and characteristics of the distribution should remain consistent with the binomial distribution. This is a fundamental concept in statistics and is the basis for techniques such as hypothesis testing and confidence intervals.</p>
</section>
</section>
<section id="confidence-interval">
<h2>Confidence interval<a class="headerlink" href="#confidence-interval" title="Permalink to this heading">#</a></h2>
<section id="confidence-interval-for-free-throw-success-rate">
<h3>Confidence interval for free throw success rate<a class="headerlink" href="#confidence-interval-for-free-throw-success-rate" title="Permalink to this heading">#</a></h3>
<p>We will explore the concept of confidence intervals in the context of basket free throws by taking the example on pages 32-33 of the book.</p>
<p>Imagine a basket player who is practicing his free throws. He makes 20 attempts and succeeds in 17 of these. We can consider each free throw as a Bernoulli trial where there are only two possible outcomes - <strong>success</strong> (the player makes the shot) or <strong>failure</strong> (the player misses the shot). In this case, the player’s free throw success rate would be the proportion of successful shots, which is 17 out of 20, or 0.85.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mf">.85</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>14
</pre></div>
</div>
</div>
</div>
<p>However, this is only the player’s success rate for these 20 shots. If he were to continue shooting, his success rate might be slightly higher or lower than this. This is where confidence intervals come in. A <strong>confidence interval</strong> gives us a range of values within which we expect the player’s true success rate (for all shots, not just these 20) to lie, with a certain level of confidence.</p>
<p>We will calculate a confidence interval for the player’s free throw success rate based on his performance in these 20 shots. This will give us a better idea of how well we can expect him to perform in the future. We also calculates the 2.5th and 97.5th percentiles of the success rates to get the lower and upper bounds of the 95% confidence interval, and mark the confidence interval on the chart with red dashed lines.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span> <span class="c1"># let&#39;s use another visualization package</span>

<span class="c1"># Parameters of the binomial distribution</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">20</span>  <span class="c1"># number of free throw attempts</span>
<span class="n">s</span> <span class="o">=</span> <span class="mi">17</span>  <span class="c1"># number of successeful throws</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">s</span><span class="o">/</span><span class="n">n</span> <span class="c1"># success rate</span>

<span class="c1"># Number of simulations</span>
<span class="n">num_simulations</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="c1"># Simulate the success rates</span>
<span class="n">success_throws</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">num_simulations</span><span class="p">)</span>

<span class="c1"># Calculate the 95% confidence interval</span>
<span class="n">ci_lower</span><span class="p">,</span> <span class="n">ci_upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">success_throws</span><span class="p">,</span> <span class="p">[</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The 95% confidence interval for the success rate is (</span><span class="si">{</span><span class="n">ci_lower</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ci_upper</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="c1"># Plot the histogram</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span>
    <span class="n">success_throws</span><span class="p">,</span>
    <span class="n">stat</span><span class="o">=</span><span class="s1">&#39;proportion&#39;</span><span class="p">,</span> <span class="c1"># also called &#39;probability&#39;</span>
    <span class="n">discrete</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1"># default to `binwidth=1` and draw bars centered on the datapoint</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;yellowgreen&#39;</span><span class="p">,</span>
    <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
    <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Histogram of Simulated Successful Throws&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Number of successes out of 20 throws&#39;</span><span class="p">)</span>
<span class="c1"># plt.xticks(np.arange(0, 21))</span>
<span class="c1"># plt.xlim(10.5, 20.5)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">ci_lower</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">ci_upper</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The 95% confidence interval for the success rate is (14.0, 20.0)
</pre></div>
</div>
<img alt="_images/8b697232f85c783615ce65dc4cf7ab100f1afcc9015d922f294b4db1f3625525.png" src="_images/8b697232f85c783615ce65dc4cf7ab100f1afcc9015d922f294b4db1f3625525.png" />
</div>
</div>
</section>
<section id="the-central-limit-theorem">
<h3>The Central Limit Theorem<a class="headerlink" href="#the-central-limit-theorem" title="Permalink to this heading">#</a></h3>
<p>The <strong>Central Limit Theorem (CLT)</strong> states that the distribution of the sum (or average) of a large number of independent, identically distributed variables approaches a normal distribution, regardless of the shape of the original distribution.</p>
<p>In the context of your experiment, if we’re conducting a large number of trials (like 10,000), the distribution of the sample proportions (the number of successes in each trial divided by the number of attempts) will tend to follow a normal distribution. This is due to the CLT.</p>
<p>Therefore, when we calculate the <strong>2.5th and 97.5th percentiles</strong> of this distribution (which gives us a 95% confidence interval), it should be <strong>close to the theoretical binomial confidence interval</strong>, especially when the number of trials is large.</p>
<p>However, it’s important to note that the CLT provides an approximation, and the accuracy of this approximation depends on the number of trials and the true success probability. The approximation is generally better when the number of trials is large and the success probability is not too close to 0 or 1.</p>
</section>
<section id="computing-the-confidence-interval">
<h3>Computing the confidence interval<a class="headerlink" href="#computing-the-confidence-interval" title="Permalink to this heading">#</a></h3>
<p>As explained in the book, we can compute the confidence interval using the modified <strong>Wald method</strong> by hand as follows:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(p'=\frac{s+2}{n+4}\)</span> with <span class="math notranslate nohighlight">\(s\)</span> the number of successes and <span class="math notranslate nohighlight">\(n\)</span> the number of trials</p></li>
<li><p>The margin of error is <span class="math notranslate nohighlight">\(W=2\sqrt{\frac{p'(1-p')}{n+4}}\)</span></p></li>
<li><p>Finally, the 95% confidence interval spans from <span class="math notranslate nohighlight">\((p'-W)\)</span> to <span class="math notranslate nohighlight">\((p'+W)\)</span></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_prime</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span> <span class="c1"># n=20</span>
<span class="n">W</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">p_prime</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">p_prime</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">4</span><span class="p">))</span><span class="o">**</span><span class="mf">.5</span>
<span class="n">ci_inf</span> <span class="o">=</span> <span class="n">p_prime</span> <span class="o">-</span> <span class="n">W</span>
<span class="n">ci_sup</span> <span class="o">=</span> <span class="n">p_prime</span> <span class="o">+</span> <span class="n">W</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The 95% confidence interval, based on the modified Wald method,</span><span class="se">\</span>
<span class="s2">extends from </span><span class="se">\n</span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="n">ci_inf</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">% to </span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="n">ci_sup</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">% of success&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The 95% confidence interval, based on the modified Wald method,extends from 
0.16% to 1.74% of success
</pre></div>
</div>
</div>
</div>
<p>Programatically, we can use <code class="docutils literal notranslate"><span class="pre">scipy.stats.norm.interval</span></code> to compute the confidence interval <em>assuming a normal distribution</em>, and <code class="docutils literal notranslate"><span class="pre">statsmodels.stats.proportion</span></code> to compute the confidence interval for proportions using different methods, including the binomial test. We can also find calculators such as the <a class="reference external" href="https://www.graphpad.com/quickcalcs/probability1/">Binomial, Poisson and Gaussian distributions</a> from GraphPad.</p>
</section>
<section id="confidence-interval-of-the-polling-voters">
<h3>Confidence interval of the polling voters<a class="headerlink" href="#confidence-interval-of-the-polling-voters" title="Permalink to this heading">#</a></h3>
<p>In the scenario analyzed on pages 33-34, we have conducted a poll on a sample of 100 voters, and 33 of them have indicated that they would vote for one great candidate. This gives a sample proportion of 0.33 (or 33%) for this great candidate.</p>
<p>However, this is just the proportion for our sample. If we want to make an inference about the proportion of all voters in the population who will vote for this candidate, we can construct a confidence interval around the sample proportion.</p>
<p>A confidence interval provides a range of values which is likely to contain the population proportion. The width of the confidence interval gives us an idea about how uncertain we are about the unknown population proportion. A wider interval implies more uncertainty.</p>
<p>The actual calculation of the confidence interval can depend on the assumptions we make about the distribution of voters’ preferences. If the sample size is large enough, by the Central Limit Theorem, the sampling distribution of the sample proportion is approximately normally distributed. In this case, we can use methods for constructing confidence intervals based on the normal distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Parameters of the binomial distribution</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># number of voters sampled</span>
<span class="n">s</span> <span class="o">=</span> <span class="mi">33</span>   <span class="c1"># &#39;sucess&#39; count</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">s</span><span class="o">/</span><span class="n">n</span>  <span class="c1"># rate voting for the great candidate</span>

<span class="c1"># Number of simulations</span>
<span class="n">num_simulations</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="c1"># Simulate the success rates</span>
<span class="n">voters</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">num_simulations</span><span class="p">)</span>

<span class="c1"># Calculate the 95% confidence interval</span>
<span class="n">ci_lower</span><span class="p">,</span> <span class="n">ci_upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">voters</span><span class="p">,</span> <span class="p">[</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The 95% confidence interval using numpy percentile is </span><span class="se">\</span>
<span class="s2">(</span><span class="si">{</span><span class="n">ci_lower</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ci_upper</span><span class="si">}</span><span class="s2">) out of 100&quot;</span><span class="p">)</span>


<span class="c1"># Calculate the 95% confidence interval using scipy.stats.norm.interval</span>
<span class="n">ci_lower</span><span class="p">,</span> <span class="n">ci_upper</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">interval</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">voters</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">voters</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The 95% confidence interval using scipy norm.interval is </span><span class="se">\</span>
<span class="s2">(</span><span class="si">{</span><span class="n">ci_lower</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ci_upper</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">) out of 100&quot;</span><span class="p">)</span>


<span class="c1"># Calculate the 95% confidence interval for proportions using </span>
<span class="c1"># statsmodels.stats.proportion, now using binomial distrubution</span>
<span class="n">ci_lower</span><span class="p">,</span> <span class="n">ci_upper</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">proportion_confint</span><span class="p">(</span>
    <span class="n">count</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">nobs</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;binom_test&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The 95% confidence interval using statsmodels proportion is </span><span class="se">\</span>
<span class="s2">(</span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="n">ci_lower</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%, </span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="n">ci_upper</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>


<span class="c1"># plot the histogram and a box-plot</span>
<span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">voters</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">voters</span><span class="p">,</span> <span class="n">vert</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">whis</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">95</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The 95% confidence interval using numpy percentile is (24.0, 42.0) out of 100
The 95% confidence interval using scipy norm.interval is (23.76, 42.22) out of 100
The 95% confidence interval using statsmodels proportion is (24.42%, 42.97%)
</pre></div>
</div>
<img alt="_images/5f5edf1f0e3a35fbb7468eb96ce15ece077297f6c7c47b61037fb38548cad8a6.png" src="_images/5f5edf1f0e3a35fbb7468eb96ce15ece077297f6c7c47b61037fb38548cad8a6.png" />
</div>
</div>
</section>
<section id="what-does-95-confidence-really-mean">
<h3>What does 95% confidence really mean?<a class="headerlink" href="#what-does-95-confidence-really-mean" title="Permalink to this heading">#</a></h3>
<p>Remember, the confidence interval gives a range of plausible values for the population proportion based on the sample data. It <strong>does not guarantee that the population proportion is within this range</strong>, but it gives a range where the population proportion is likely to fall, with a certain level of confidence (often 95%).</p>
<p>We illustrate that using the example of pages 35-36. The experiment involves a bowl that contains 100 balls in total. Out of these, 25 balls are red and the remaining 75 balls are black. The balls are well mixed to ensure randomness. The process is as follows:</p>
<ol class="arabic simple">
<li><p>A ball is chosen randomly from the bowl.</p></li>
<li><p>The color of the ball is recorded.</p></li>
<li><p>The ball is then placed back into the bowl.</p></li>
<li><p>The balls are mixed again.</p></li>
<li><p>Steps 1-4 are repeated 15 times.</p></li>
</ol>
<p>Each time a ball is chosen, it represents a Bernoulli trial since there are only two possible outcomes - the ball is either red or black. The proportion of red balls chosen in these 15 trials is recorded.</p>
<p>This process is then simulated 20 times, each time recording the fraction of red balls chosen. For each simulation, a 95% confidence interval for the proportion of red balls is computed. The aim is to observe that <strong>approximately 1 out of 20 of these 95% confidence intervals will not include the true population proportion</strong> of red balls (which is 0.25 or 25% in this case).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Parameters of the binomial distribution</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">15</span>     <span class="c1"># number of trials</span>
<span class="n">s</span> <span class="o">=</span> <span class="mf">.25</span><span class="o">*</span><span class="mi">15</span> <span class="c1"># red balls</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">s</span><span class="o">/</span><span class="n">n</span>    <span class="c1"># success rate</span>

<span class="c1"># Number of simulations</span>
<span class="n">num_simulations</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="c1"># Simulate the probability rates</span>
<span class="n">bowl</span> <span class="o">=</span> <span class="n">binom</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>

<span class="c1"># Calculate the 95% confidence interval based on the CLT</span>
<span class="n">ci_lower</span><span class="p">,</span> <span class="n">ci_upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">bowl</span><span class="p">,</span> <span class="p">[</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The 95% confidence interval (numpy percentile) is </span><span class="se">\</span>
<span class="s2">(</span><span class="si">{</span><span class="n">ci_lower</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ci_upper</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">) out of 15&quot;</span><span class="p">)</span>


<span class="c1"># Calculate the 95% confidence interval using scipy.stats.norm.interval</span>
<span class="n">ci_lower</span><span class="p">,</span> <span class="n">ci_upper</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">interval</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bowl</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bowl</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The 95% confidence interval (scipy norm.interval) is </span><span class="se">\</span>
<span class="s2">(</span><span class="si">{</span><span class="n">ci_lower</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ci_upper</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">) out of 15&quot;</span><span class="p">)</span>

<span class="c1"># Calculate the 95% confidence interval for proportions using </span>
<span class="c1"># statsmodels.stats.proportion, now using binomial distrubution</span>
<span class="c1"># ci_lower, ci_upper = smp.proportion_confint(count=s, nobs=n, alpha=0.05, method=&#39;binom_test&#39;)</span>
<span class="c1"># DOESN&#39;T WORK WITH FLOAT NUMBER GIVEN FOR count=</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The 95% confidence interval (numpy percentile) is (1.000, 7.000) out of 15
The 95% confidence interval (scipy norm.interval) is (0.42, 7.05) out of 15
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">statsmodels.stats.proportion.proportion_confint</span></code> function is used to calculate the confidence interval for a proportion in a way that properly accounts for the binomial distribution, which is <strong>discrete</strong>. The <code class="docutils literal notranslate"><span class="pre">count</span></code> parameter of this function represents the number of successes (in your case, the number of red balls drawn), and it must be an integer because we can’t have a fraction of a success in a binomial experiment. It’s either a success or not, hence, it’s a discrete value.</p>
<p>So, in our case, if we’re drawing 15 balls and we know that 25% of them are red, we can’t enter 0.25 * 15 for the count parameter because this would be a fractional number. Instead, we should enter the actual number of red balls drawn in your sample. For example, if we drew 4 red balls out of 15, we would enter 4 for the count parameter.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Number of successes and trials</span>
<span class="n">count</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># number of red balls drawn</span>
<span class="n">nobs</span> <span class="o">=</span> <span class="mi">15</span>  <span class="c1"># total number of balls drawn</span>

<span class="c1"># Calculate the 95% confidence interval for the proportion</span>
<span class="n">ci_lower</span><span class="p">,</span> <span class="n">ci_upper</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">proportion_confint</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">nobs</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;binom_test&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The 95% confidence interval for the proportion of red balls is </span><span class="se">\</span>
<span class="s2">(</span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="n">ci_lower</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%, </span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="n">ci_upper</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The 95% confidence interval for the proportion of red balls is (9.67%, 53.43%)
</pre></div>
</div>
</div>
</div>
<p>We can use the <code class="docutils literal notranslate"><span class="pre">binom</span></code> function from <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> to simulate the trials, and the <code class="docutils literal notranslate"><span class="pre">proportion_confint</span></code> function from <code class="docutils literal notranslate"><span class="pre">statsmodels.stats.proportion</span></code> to calculate the confidence intervals for 100 random experiments.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">11111</span><span class="p">)</span>

<span class="c1"># Parameters of the binomial distribution</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">15</span>  <span class="c1"># number of balls drawn per trial</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">0.25</span>  <span class="c1"># probability of drawing a red ball</span>

<span class="c1"># Number of trials</span>
<span class="n">num_trials</span> <span class="o">=</span> <span class="mi">100</span>

<span class="c1"># Simulate the trials</span>
<span class="n">red_balls</span> <span class="o">=</span> <span class="n">binom</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">num_trials</span><span class="p">)</span>

<span class="c1"># Calculate the confidence intervals</span>
<span class="n">confidence_intervals</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">smp</span><span class="o">.</span><span class="n">proportion_confint</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;binom_test&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">red_balls</span><span class="p">]</span>

<span class="c1"># Create a figure and a set of subplots</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>

<span class="c1"># Loop over the data and create error bars with different colors based on the condition</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="p">(</span><span class="n">ci_lower</span><span class="p">,</span> <span class="n">ci_upper</span><span class="p">))</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">red_balls</span><span class="p">,</span> <span class="n">confidence_intervals</span><span class="p">)):</span>
    <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span> <span class="k">if</span> <span class="n">ci_lower</span> <span class="o">&gt;</span> <span class="mf">0.25</span> <span class="ow">or</span> <span class="n">ci_upper</span> <span class="o">&lt;</span> <span class="mf">0.25</span> <span class="k">else</span> <span class="s1">&#39;black&#39;</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">count</span><span class="o">/</span><span class="n">n</span><span class="p">,</span> <span class="p">[[</span><span class="n">count</span><span class="o">/</span><span class="n">n</span> <span class="o">-</span> <span class="n">ci_lower</span><span class="p">],</span> <span class="p">[</span><span class="n">ci_upper</span> <span class="o">-</span> <span class="n">count</span><span class="o">/</span><span class="n">n</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;cornflowerblue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Confidence Intervals for Proportion of Red Balls&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Trial&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">.5</span><span class="p">,</span> <span class="mf">100.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Proportion of Red Balls&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/259fe5751f0de07dd2db5491a3e85ccf1ecbc6e13f8a265addcd546af65fe1fd.png" src="_images/259fe5751f0de07dd2db5491a3e85ccf1ecbc6e13f8a265addcd546af65fe1fd.png" />
</div>
</div>
<p>This experiment helps illustrate the concept of confidence intervals and their interpretation. It shows that a 95% confidence interval does not guarantee that the population parameter (in this case, the proportion of red balls) lies within the interval. Rather, it means that if we were to repeat the experiment many times and calculate a confidence interval each time, we would expect about 95% of these intervals to contain the population parameter. Interestingly, Cumming and Maillardet (2016) have shown that the first 95% CI will include the sample means of 83% of repeat experiments, due to experimental bias and error.</p>
</section>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this heading">#</a></h2>
<p>Throughout this chapter, we’ve explored various statistical concepts and how to implement them programmatically using Python. We’ve used libraries such as <code class="docutils literal notranslate"><span class="pre">numpy</span></code>, <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code>, <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>, and <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> to simulate experiments, calculate statistics, and visualize data.</p>
<p>We started with a discussion on binomial distribution and confidence intervals in the context of polling voters and basketball free throws. We then simulated an experiment involving drawing balls from a bowl and calculated confidence intervals for the proportion of red balls drawn.</p>
<p>We learned how to use the <code class="docutils literal notranslate"><span class="pre">binom</span></code> function from <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> to simulate binomial experiments, and the <code class="docutils literal notranslate"><span class="pre">proportion_confint</span></code> function from <code class="docutils literal notranslate"><span class="pre">statsmodels.stats.proportion</span></code> to calculate confidence intervals for proportions. We also discussed how to use numpy for array operations and random number generation. In addition, we explored the Central Limit Theorem and its implications for the approximation of the binomial distribution with the normal distribution.</p>
<p>Overall, this chapter provided a practical, hands-on introduction to some key statistical concepts and how to work with them programmatically in Python. It demonstrated the power of Python and its libraries for statistical analysis and data visualization, and it highlighted the importance of understanding these concepts for interpreting statistical results and making informed decisions based on data.</p>
</section>
<section id="session-information">
<h2>Session Information<a class="headerlink" href="#session-information" title="Permalink to this heading">#</a></h2>
<p>The output below details all packages and version necessary to reproduce the results in this report.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>python<span class="w"> </span>--version
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-------------&quot;</span><span class="p">)</span>
<span class="c1"># List of packages we want to check the version</span>
<span class="n">packages</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;numpy&#39;</span><span class="p">,</span> <span class="s1">&#39;scipy&#39;</span><span class="p">,</span> <span class="s1">&#39;statsmodels&#39;</span><span class="p">,</span> <span class="s1">&#39;matplotlib&#39;</span><span class="p">,</span> <span class="s1">&#39;seaborn&#39;</span><span class="p">]</span>

<span class="c1"># Initialize an empty list to store the versions</span>
<span class="n">versions</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Loop over the packages</span>
<span class="k">for</span> <span class="n">package</span> <span class="ow">in</span> <span class="n">packages</span><span class="p">:</span>
    <span class="c1"># Get the version of the package</span>
    <span class="n">output</span> <span class="o">=</span> <span class="o">!</span>pip<span class="w"> </span>show<span class="w"> </span><span class="o">{</span>package<span class="o">}</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>findstr<span class="w"> </span><span class="s2">&quot;Version&quot;</span>
    <span class="c1"># If the output is not empty, get the version</span>
    <span class="k">if</span> <span class="n">output</span><span class="p">:</span>
        <span class="n">version</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">version</span> <span class="o">=</span> <span class="s1">&#39;Not installed&#39;</span>
    <span class="c1"># Append the version to the list</span>
    <span class="n">versions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">version</span><span class="p">)</span>

<span class="c1"># Print the versions</span>
<span class="k">for</span> <span class="n">package</span><span class="p">,</span> <span class="n">version</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">packages</span><span class="p">,</span> <span class="n">versions</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">package</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">version</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Python 3.12.3
-------------
numpy: 1.26.4
scipy: 1.12.0
statsmodels: 0.14.2
matplotlib: 3.8.3
seaborn: 0.13.2
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="README.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Companion Guide to “Intuitive Biostatistics, 4th edition” by Harvey Motulsky</p>
      </div>
    </a>
    <a class="right-next"
       href="05%20-%20Confidence%20Interval%20of%20Survival%20Data.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">05 - Confidence Interval of Survival Data</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-a-confidence-interval">What is a Confidence Interval?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-a-proportion">What is a proportion?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Confidence interval of a proportion</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#binomial-distribution">Binomial distribution</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#practical-example-with-np-random-binomial-single-coin-flip">Practical example with <code class="docutils literal notranslate"><span class="pre">np.random.binomial</span></code> - Single coin flip</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-coin-flips">Multiple coin flips</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#probability-and-frequency">Probability and frequency</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-scipy-stats-binom-methods">Using <code class="docutils literal notranslate"><span class="pre">scipy.stats.binom</span></code> methods</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simulating-a-clinical-trial-scenario-using-the-binomial-distribution">Simulating a clinical trial scenario using the binomial distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-example-of-the-democrat-voters">The example of the Democrat voters</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#confidence-interval">Confidence interval</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#confidence-interval-for-free-throw-success-rate">Confidence interval for free throw success rate</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-central-limit-theorem">The Central Limit Theorem</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-the-confidence-interval">Computing the confidence interval</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#confidence-interval-of-the-polling-voters">Confidence interval of the polling voters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-does-95-confidence-really-mean">What does 95% confidence really mean?</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#session-information">Session Information</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Sébastien Wieckowski
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>