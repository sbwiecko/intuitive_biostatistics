
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Confidence interval of a mean &#8212; The Python Companion of Intuitive Biostatistics</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=3ee479438cf8b5e0d341"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-QQY9FLLPJ8"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-QQY9FLLPJ8');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-QQY9FLLPJ8');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '12 - Confidence interval of a mean';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Confidence interval of a proportion" href="04%20-%20Confidence%20interval%20of%20a%20proportion.html" />
    <link rel="prev" title="The Gaussian distribution" href="10%20-%20Gaussian%20distribution.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="README.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.jpg" class="logo__image only-light" alt="The Python Companion of Intuitive Biostatistics - Home"/>
    <script>document.write(`<img src="_static/logo.jpg" class="logo__image only-dark" alt="The Python Companion of Intuitive Biostatistics - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="README.html">
                    Python Companion Guide to “Intuitive Biostatistics”
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Continuous variables</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="09%20-%20Quantifying%20scatter%20of%20continuous%20data.html">Quantifying scatter of continuous data</a></li>
<li class="toctree-l1"><a class="reference internal" href="10%20-%20Gaussian%20distribution.html">The Gaussian distribution</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Confidence intervals</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Confidence interval of a mean</a></li>
<li class="toctree-l1"><a class="reference internal" href="04%20-%20Confidence%20interval%20of%20a%20proportion.html">Confidence interval of a proportion</a></li>
<li class="toctree-l1"><a class="reference internal" href="05%20-%20Confidence%20interval%20of%20survival%20data.html">Confidence interval of survival data</a></li>
<li class="toctree-l1"><a class="reference internal" href="06%20-%20Confidence%20interval%20of%20counted%20data.html">Confidence interval of counted data</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Statistical significance and data assumptions</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="15%20-%20Statistical%20significance.html">Statistical significance</a></li>
<li class="toctree-l1"><a class="reference internal" href="20%20-%20Statistical%20power%20and%20sample%20size.html">Statistical power and sample size</a></li>
<li class="toctree-l1"><a class="reference internal" href="24%20-%20Normality%20tests%20and%20outliers.html">Normality tests and outliers</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Statistical tests</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="27%20-%20Comparing%20proportions.html">Comparing proportions</a></li>
<li class="toctree-l1"><a class="reference internal" href="29%20-%20Comparing%20survival%20curves.html">Comparing survival curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="30%20-%20Comparing%20two%20unpaired%20means.html">Comparing two unpaired means</a></li>
<li class="toctree-l1"><a class="reference internal" href="31%20-%20Comparing%20paired%20data.html">Comparing paired data</a></li>
<li class="toctree-l1"><a class="reference internal" href="32%20-%20Correlation.html">Correlation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Fitting models to data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="33%20-%20Simple%20linear%20regression.html">Simple linear regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="35%20-%20Comparing%20models.html">Comparing models</a></li>
<li class="toctree-l1"><a class="reference internal" href="36%20-%20Nonlinear%20regression.html">Nonlinear regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="37%20-%20Multiple%20regression.html">Multiple regression</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/sbwiecko/intuitive_biostatistics" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/sbwiecko/intuitive_biostatistics/edit/master/12 - Confidence interval of a mean.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/12 - Confidence interval of a mean.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Confidence interval of a mean</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-t-distribution">The t-distribution</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#origin-of-the-t-distribution">Origin of the t-distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-scipy-to-obtain-critical-t-values">Using SciPy to obtain critical t-values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sign-of-the-critical-t-value">Sign of the critical t-value</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-the-t-distribution">Visualizing the t-distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#approaching-the-standard-normal">Approaching the standard normal</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-the-confidence-interval-of-a-mean">Calculating the confidence interval of a mean</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-t-statistic">The t-statistic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-flip">The flip</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-of-body-temperatures">Example of body temperatures</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#critical-values">Critical values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#python-tools-for-confidence-interval-calculation">Python tools for confidence interval calculation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#normal-distribution">Normal distribution</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">The t-distribution</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bayesian-approach">Bayesian approach</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrapping">Bootstrapping</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#resampling">Resampling</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#estimate-of-the-ci">Estimate of the CI</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrap-with-pingouin">Bootstrap with Pingouin</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#standard-error-and-confidence-interval">Standard error and confidence interval</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ci-of-the-standard-deviation">CI of the standard deviation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#frequentist-approach">Frequentist approach</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Bayesian approach</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrap-approach">Bootstrap approach</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cheat-sheet">Cheat sheet</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#t-distribution">t-distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pdf-plot">PDF Plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Critical values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#confidence-interval">Confidence interval</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-errorbar">Plot errorbar</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Bootstrapping</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#session-information">Session information</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="confidence-interval-of-a-mean">
<h1>Confidence interval of a mean<a class="headerlink" href="#confidence-interval-of-a-mean" title="Link to this heading">#</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p>In biostatistics, we often estimate characteristics of a larger population from a smaller sample. But how confident are we in those estimates? This chapter introduces the concept of <strong>confidence intervals</strong> — a powerful tool that tells us how reliable our estimates are likely to be.</p>
<p>Confidence intervals are like a range of plausible values, instead of just a single number. We’ll learn how to calculate and interpret these intervals for the most important statistic in biostatistics: the mean.</p>
<p>By the end of this chapter, we’ll understand how confidence intervals work, how to use them to make stronger conclusions about our data, and how to avoid common misunderstandings. Whether we’re new to statistics or just looking for a refresher, this chapter will give us the <em>confidence</em> we need to tackle this essential concept.</p>
</section>
<section id="the-t-distribution">
<h2>The t-distribution<a class="headerlink" href="#the-t-distribution" title="Link to this heading">#</a></h2>
<p>To determine the width of the confidence interval of a mean, we utilize a constant called the <strong>critical value</strong> from the <strong>t-distribution</strong>, or the <strong>critical t-value</strong> also denoted as t*. The t-distribution is similar to the standard normal distribution but is used when the population standard deviation is unknown and estimated from the sample. The choice of <span class="math notranslate nohighlight">\(t^*\)</span> depends on the desired <strong>confidence level</strong> and the <strong>degrees of freedom (DF)</strong>. In general, DF equals the number of data points minus the number of parameters being estimated, e.g., <span class="math notranslate nohighlight">\(\text{DF} = n - 1\)</span> for the mean.</p>
<section id="origin-of-the-t-distribution">
<h3>Origin of the t-distribution<a class="headerlink" href="#origin-of-the-t-distribution" title="Link to this heading">#</a></h3>
<p>The t-distribution (or <strong>Student distribution</strong>) was developed by William Sealy Gosset, a chemist working for the Guinness brewery in the early 20th century. He published his work under the pseudonym “Student” due to company restrictions. The distribution arose from Gosset’s need to make inferences about the mean of a normally distributed population when the sample size was small and the population standard deviation was unknown. The t-distribution is similar to the standard normal distribution (z-distribution) but has heavier tails, especially with smaller sample sizes. As the sample size increases, the t-distribution approaches the z-distribution.</p>
</section>
<section id="using-scipy-to-obtain-critical-t-values">
<h3>Using SciPy to obtain critical t-values<a class="headerlink" href="#using-scipy-to-obtain-critical-t-values" title="Link to this heading">#</a></h3>
<p>The <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/stats.html"><code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> module</a> in Python provides a convenient way to work with the t-distribution and obtain critical t-values. For a <em>two-tailed confidence interval</em>, the expression <span class="math notranslate nohighlight">\(1 - \alpha/2\)</span> is used to find <span class="math notranslate nohighlight">\(t^\ast\)</span>, with <span class="math notranslate nohighlight">\(\alpha\)</span> the <em>signifcance level</em>, also called the <em>complement of the confidence level</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">t</span>

<span class="c1"># Define the desired confidence level (e.g., 95%)</span>
<span class="n">confidence_level</span> <span class="o">=</span> <span class="mf">0.95</span>

<span class="c1"># Calculate alpha (for two-tailed test)</span>
<span class="n">α</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">confidence_level</span>

<span class="c1"># Define the degrees of freedom (e.g., sample size - 1)</span>
<span class="n">DF</span> <span class="o">=</span> <span class="mi">27</span>

<span class="c1"># Calculate the critical t-value (two-tailed)</span>
<span class="c1">#t_critical = t.ppf(1 - alpha/2, df)  # ppf is the percent point function (inverse of CDF)</span>
<span class="n">t_critical</span> <span class="o">=</span> <span class="n">t</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">DF</span><span class="p">)</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="mi">1</span> <span class="o">-</span> <span class="n">α</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># ppf is the percent point function (inverse of CDF)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The two-tailed critical t-value (t*) for a </span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="n">confidence_level</span><span class="si">}</span><span class="s2">% CI </span><span class="se">\</span>
<span class="s2">with </span><span class="si">{</span><span class="n">DF</span><span class="si">}</span><span class="s2"> degrees of freedom is </span><span class="si">{</span><span class="n">t_critical</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The two-tailed critical t-value (t*) for a 95.0% CI with 27 degrees of freedom is 2.0518
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p>In Microsoft Excel, we can use <code class="docutils literal notranslate"><span class="pre">T.INV.2T(1-0.95,</span> <span class="pre">27)</span></code>.</p>
</div></blockquote>
<p>To access a wider range of t-values for various confidence levels and degrees of freedom, we can generate the following table.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># Confidence levels</span>
<span class="n">confidence_levels</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.80</span><span class="p">,</span> <span class="mf">0.90</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.975</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">]</span> <span class="c1"># conf_lev = 1 - alpha</span>

<span class="c1"># Degrees of freedom</span>
<span class="n">DF_values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span> <span class="o">+</span> <span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">201</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>

<span class="c1"># Create an empty dictionary to store t-values</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>

<span class="c1"># Calculate t-values and populate dictionary</span>
<span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">DF_values</span><span class="p">:</span>
    <span class="n">t_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">conf_level</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span> <span class="k">for</span> <span class="n">conf_level</span> <span class="ow">in</span> <span class="n">confidence_levels</span><span class="p">]</span>
    <span class="n">data</span><span class="p">[</span><span class="n">df</span><span class="p">]</span> <span class="o">=</span> <span class="n">t_values</span>

<span class="c1"># Create a DataFrame from the dictionary</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">confidence_levels</span><span class="p">)</span>

<span class="c1"># Format the table</span>
<span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;1-α&#39;</span>
<span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;DF&#39;</span>

<span class="c1"># Print the table</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Two-tailed critical values of the t-distribution for various DF (columns) and alpha (rows)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;==========================================================================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">(</span><span class="n">numalign</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">stralign</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Two-tailed critical values of the t-distribution for various DF (columns) and alpha (rows)
==========================================================================================
| 1-α   | 1      | 2     | 3     | 4     | 5     | 10    | 50    | 100   | 150   | 200   |
|:------|:-------|:------|:------|:------|:------|:------|:------|:------|:------|:------|
| 0.8   | 3.078  | 1.886 | 1.638 | 1.533 | 1.476 | 1.372 | 1.299 | 1.29  | 1.287 | 1.286 |
| 0.9   | 6.314  | 2.92  | 2.353 | 2.132 | 2.015 | 1.812 | 1.676 | 1.66  | 1.655 | 1.653 |
| 0.95  | 12.706 | 4.303 | 3.182 | 2.776 | 2.571 | 2.228 | 2.009 | 1.984 | 1.976 | 1.972 |
| 0.975 | 25.452 | 6.205 | 4.177 | 3.495 | 3.163 | 2.634 | 2.311 | 2.276 | 2.264 | 2.258 |
| 0.99  | 63.657 | 9.925 | 5.841 | 4.604 | 4.032 | 3.169 | 2.678 | 2.626 | 2.609 | 2.601 |
</pre></div>
</div>
</div>
</div>
</section>
<section id="sign-of-the-critical-t-value">
<h3>Sign of the critical t-value<a class="headerlink" href="#sign-of-the-critical-t-value" title="Link to this heading">#</a></h3>
<p>The t-distribution is symmetrical around zero, meaning that the probability density is the same for positive and negative t-values with the same absolute value.</p>
<p>In a <em>one-tailed</em> test, we’re interested in whether the population mean is significantly greater than or less than a specific value.</p>
<ul class="simple">
<li><p>Left-tailed test: t* will be negative because we’re looking for evidence in the left tail of the distribution.</p></li>
<li><p>Right-tailed test: t* will be positive because we’re looking for evidence in the right tail of the distribution.</p></li>
</ul>
<p>In a <em>two-tailed</em> test or when calculating a confidence interval, we consider both tails of the distribution.</p>
<ul class="simple">
<li><p>We’ll typically get two critical t-values: one positive and one negative, corresponding to the upper and lower bounds of the confidence interval or the rejection regions in a two-tailed test.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Parameters</span>
<span class="n">DF</span> <span class="o">=</span> <span class="mi">11</span>  <span class="c1"># Degrees of freedom (n - 1)</span>

<span class="c1"># Calculate critical t-values</span>
<span class="n">α</span> <span class="o">=</span> <span class="mf">.05</span>

<span class="c1"># note that 0.975 - 0.025 = 0.95</span>
<span class="n">t_critical_lower</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">α</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">DF</span><span class="p">)</span>  <span class="c1"># Lower critical value at q = 0.025</span>
<span class="n">t_critical_upper</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">α</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">DF</span><span class="p">)</span>  <span class="c1"># Upper critical value at q = 0.975</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;For a </span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">α</span><span class="p">)</span><span class="si">}</span><span class="s2">% confidence interval with </span><span class="si">{</span><span class="n">DF</span><span class="si">}</span><span class="s2"> degrees of freedom:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Lower t* = </span><span class="si">{</span><span class="n">t_critical_lower</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">(</span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">confidence_level</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">% of the area under the curve is to the left of this value)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Upper t* = </span><span class="si">{</span><span class="n">t_critical_upper</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">(</span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">confidence_level</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">% of the area under the curve is to the right of this value)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>For a 95.0% confidence interval with 11 degrees of freedom:
Lower t* = -2.2 (2.5% of the area under the curve is to the left of this value)
Upper t* = 2.2 (2.5% of the area under the curve is to the right of this value)
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualizing-the-t-distribution">
<h3>Visualizing the t-distribution<a class="headerlink" href="#visualizing-the-t-distribution" title="Link to this heading">#</a></h3>
<p>To gain a deeper understanding of this distribution, let’s visualize its shape and key properties.</p>
<p>The plot generated below depicts the <strong>probability density function (PDF)</strong> of the t-distribution for a specific DF value. This curve represents the likelihood of different t-values occurring under this distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Parameters</span>
<span class="n">DF</span> <span class="o">=</span> <span class="mi">11</span>  <span class="c1"># Degrees of freedom (n - 1)</span>
<span class="n">α</span> <span class="o">=</span> <span class="mf">.05</span>

<span class="c1"># Calculate critical t-values </span>
<span class="n">t_critical_lower</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">α</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">DF</span><span class="p">)</span>  <span class="c1"># Lower critical value at q = 0.025</span>
<span class="n">t_critical_upper</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">α</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">DF</span><span class="p">)</span>  <span class="c1"># Upper critical value at q = 0.975</span>

<span class="c1"># Generate x values for the plot</span>
<span class="c1"># x = np.linspace(-4, 4, 100)  # Range from -4 to 4 standard deviations</span>
<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
    <span class="n">t</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">DF</span><span class="p">)</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="mf">.001</span><span class="p">),</span> <span class="c1"># Percent Point Function</span>
    <span class="n">t</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">DF</span><span class="p">)</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="mf">.999</span><span class="p">),</span>
    <span class="n">num</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>

<span class="c1"># Calculate t-distribution PDF values</span>
<span class="n">hx</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">DF</span><span class="p">)</span>

<span class="c1"># Create the plot</span>
<span class="c1"># plt.figure(figsize=(4, 3))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">hx</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Plot the critical t-values</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">t_critical_lower</span><span class="p">,</span> <span class="c1"># type: ignore</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orangered&#39;</span><span class="p">,</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">t_critical_upper</span><span class="p">,</span> <span class="c1"># type: ignore</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orangered&#39;</span><span class="p">,</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;t* (</span><span class="si">{</span><span class="n">t_critical_upper</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="c1"># Shade confidence interval areas</span>
<span class="c1"># plt.fill_between(x, y, where=((x &lt; -t_critical) | (x &gt; t_critical)), color=&#39;mediumorchid&#39;,)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">hx</span><span class="p">,</span>
    <span class="n">where</span><span class="o">=</span><span class="p">((</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">t_critical_lower</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">t_critical_upper</span><span class="p">)),</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tomato&#39;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;α (</span><span class="si">{</span><span class="n">α</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>

<span class="c1"># Add labels and title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">margins</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;t-distribution with </span><span class="si">{</span><span class="n">DF</span><span class="si">}</span><span class="s2"> degrees of freedom&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c3d5178ca58a78641cb3d7b0b1e59e045f68ba7764f78173d6ad8657f12f2eda.png" src="_images/c3d5178ca58a78641cb3d7b0b1e59e045f68ba7764f78173d6ad8657f12f2eda.png" />
</div>
</div>
<p>The shaded areas in the plot highlight the regions outside the <em>95% confidence interval</em>. The non-shaded area in the middle represents the interval itself. This means that if we were to repeatedly sample from the population and calculate confidence intervals using the t-distribution, 95% of those intervals would contain the true population mean. The critical t-values that define the boundaries of this interval, where 2.5%  probability lies in each shaded tail, are calculated using the <code class="docutils literal notranslate"><span class="pre">t.ppf</span></code> function, as discussed in the previous chapters.</p>
<p>Let’s now plot multiple t-distributions with varying degrees of freedom on the same graph, to illustrate how the shape changes as the sample size increases.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="s2">&quot;magma_r&quot;</span><span class="p">)</span>

<span class="c1"># Degrees of freedom</span>
<span class="n">DF_values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">25</span><span class="p">]</span>

<span class="c1"># Generate x values for the plot</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

<span class="c1"># Create the plot</span>
<span class="c1"># plt.figure(figsize=(5, 4))</span>
<span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">DF_values</span><span class="p">:</span>
    <span class="c1"># Calculate t-distribution PDF values</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>

    <span class="c1"># Plot the t-distribution</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;DF=</span><span class="si">{</span><span class="n">df</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Add labels and title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">margins</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;t-distributions with varying degrees of freedom&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/890b0bb91df375f5f5eea4d55e1f20b6d4469155d10a901788307e0e09789042.png" src="_images/890b0bb91df375f5f5eea4d55e1f20b6d4469155d10a901788307e0e09789042.png" />
</div>
</div>
<p>The plot illustrates the following key characteristics of t-distributions:</p>
<ul class="simple">
<li><p>Bell-shaped: similar to the standard normal distribution, the t-distribution is symmetrical and bell-shaped.</p></li>
<li><p>Heavier tails: the tails of the t-distribution are thicker than those of the standard normal distribution, especially for smaller degrees of freedom. This reflects the increased uncertainty associated with smaller sample sizes. This indicates a higher probability of obtaining extreme values (far from the mean) when the sample size is small.</p></li>
<li><p>Approaches normal distribution: as the degrees of freedom increase (i.e., with larger sample sizes), the t-distribution approaches the standard normal distribution.</p></li>
</ul>
</section>
<section id="approaching-the-standard-normal">
<h3>Approaching the standard normal<a class="headerlink" href="#approaching-the-standard-normal" title="Link to this heading">#</a></h3>
<p>As the degrees of freedom increase, the t-distribution becomes more and more similar to the standard normal distribution or <em>z-distribution</em>. This is evident in the plot, where the curve for <em>DF=25</em> closely resembles the standard normal curve.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">norm</span>

<span class="c1"># Set up parameters</span>
<span class="n">DF</span> <span class="o">=</span> <span class="mi">25</span>  <span class="c1"># Degrees of freedom for t-distribution</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>  <span class="c1"># Range of x values</span>

<span class="c1"># Calculate PDF values</span>
<span class="n">t_pdf</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">DF</span><span class="p">)</span>
<span class="n">norm_pdf</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="c1"># Plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t_pdf</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;t-distribution (DF=</span><span class="si">{</span><span class="n">DF</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm_pdf</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;standard normal (Gaussian)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span>
    <span class="s1">&#39;Comparing t-distribution with standard normal PDFs&#39;</span><span class="p">,</span>
    <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t or z&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Probability density&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">margins</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/068bd8cdc160e582888ee50ddfe388213d92f0cdbf6e8dc33c412800013a75ef.png" src="_images/068bd8cdc160e582888ee50ddfe388213d92f0cdbf6e8dc33c412800013a75ef.png" />
</div>
</div>
<p>This convergence is a consequence of the <strong>central limit theorem (CLT)</strong>, which states that the distribution of sample means approaches a normal distribution as the sample size increases, regardless of the shape of the original population distribution. Since degrees of freedom are directly related to sample size (<em>DF=n-1</em>), as DF increases, the sample size also increases, and the t-distribution becomes increasingly similar to the standard normal distribution.</p>
<p>In principle, when the sample size is large (typically <em>n&gt;30</em>), the t-distribution and the standard normal distribution are very close. In this case, we can use either the <strong>z-score</strong> or the <strong>t-value</strong> for the CI calculations, and the results will be virtually identical.</p>
</section>
</section>
<section id="calculating-the-confidence-interval-of-a-mean">
<h2>Calculating the confidence interval of a mean<a class="headerlink" href="#calculating-the-confidence-interval-of-a-mean" title="Link to this heading">#</a></h2>
<p>The most common method of computing the confidence interval (CI) of a mean assumes that the data are sampled from a population that follows a <em>normal distribution</em>. The CI is centered around the sample mean <span class="math notranslate nohighlight">\(m\)</span>. To calculate its width, we need to consider the standard deviation <span class="math notranslate nohighlight">\(s\)</span>, the number of values in the sample <span class="math notranslate nohighlight">\(n\)</span>, and the desired degree of confidence (typically 95%).</p>
<section id="the-t-statistic">
<h3>The t-statistic<a class="headerlink" href="#the-t-statistic" title="Link to this heading">#</a></h3>
<p>While we can use the t-distribution to calculate confidence intervals and test hypotheses about the population mean, it’s important to distinguish between the <em>t-statistic</em> (calculated from the sample data) and <span class="math notranslate nohighlight">\(t^\ast\)</span> (obtained from the t-distribution as shown above).</p>
<p>Suppose we have a population that is normally distributed, with known parameters μ (mean) and σ (standard deviation). By taking multiple random samples of size <span class="math notranslate nohighlight">\(n\)</span> from this population, we can compute the sample mean <span class="math notranslate nohighlight">\(m\)</span> and sample standard deviation <span class="math notranslate nohighlight">\(s\)</span> for each. Then, for each sample, we can calculate the <strong>t-statistic</strong> <span class="math notranslate nohighlight">\(t\)</span>:</p>
<div class="math notranslate nohighlight">
\[
t=\frac{m - \mu}{s / \sqrt{n}} \sim t_{n-1}
\]</div>
<ul class="simple">
<li><p>The t-statistic tells us how extreme the sample mean is compared to the hypothesized population mean, under the assumption that the null hypothesis is true (i.e., the true population mean is equal to the hypothesized value).</p></li>
<li><p>It follows a t-distribution with n−1 degrees of freedom.</p></li>
<li><p>A larger absolute value of t indicates a more significant difference between the sample mean and the hypothesized population mean.</p></li>
<li><p>The sign of t indicates whether the sample mean is larger (+) or smaller (-) than the hypothesized population mean.</p></li>
</ul>
<p>For example, suppose we want to test whether a new drug has an effect on blood pressure. We collect a sample of 30 patients and measure their blood pressure after taking the drug. The sample mean (m) is 120 mmHg, and the sample standard deviation (s) is 15 mmHg. Our hypothesize that the population mean blood pressure with the drug (μ) is 130 mmHg.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t_stat</span> <span class="o">=</span> <span class="p">(</span><span class="mi">120</span> <span class="o">-</span> <span class="mi">130</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">15</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The t-statistic (t) in this sample = </span><span class="si">{</span><span class="n">t_stat</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The t-statistic (t) in this sample = -3.651
</pre></div>
</div>
</div>
</div>
<p>The result indicates that the sample mean is 3.651 standard errors <em>lower</em> than the hypothesized population mean of 130 mmHg.</p>
</section>
<section id="the-flip">
<h3>The flip<a class="headerlink" href="#the-flip" title="Link to this heading">#</a></h3>
<p>For any individual sample, we know the specific values for the sample mean, standard deviation, and size. The population mean, though, remains hidden. Our goal is to <em>estimate this population mean</em> while quantifying our level of uncertainty. To achieve this, we can calculate a confidence interval as follows:</p>
<div class="math notranslate nohighlight">
\[\text{CI} = m \pm t^\ast \times \frac{s}{\sqrt{n}} = m \pm t^\ast \times s_{\bar x}\]</div>
<p>where <span class="math notranslate nohighlight">\(s_{\bar x}\)</span> is the standard error of the mean, as defined in the previous chapter. To estimate the population mean with a specified level of confidence, we can employ the t-distribution and follow this procedure:</p>
<ol class="arabic simple">
<li><p>Calculate the sample mean (<span class="math notranslate nohighlight">\(m\)</span>) and sample standard deviation (<span class="math notranslate nohighlight">\(s\)</span>)</p></li>
<li><p>Determine the degrees of freedom as <span class="math notranslate nohighlight">\(\text{DF} = n - 1\)</span></p></li>
<li><p>Choose a confidence level, e.g., 95%</p></li>
<li><p>Find the critical t-value <span class="math notranslate nohighlight">\(t^\ast\)</span></p></li>
<li><p>Calculate the margin of error <span class="math notranslate nohighlight">\(W\)</span>, such as <span class="math notranslate nohighlight">\(W = t^\ast \times s_{\bar x}\)</span></p></li>
<li><p>Construct the confidence interval <span class="math notranslate nohighlight">\(\text{CI}\)</span>, such as <span class="math notranslate nohighlight">\(\text{CI} = m \pm W\)</span></p></li>
</ol>
</section>
<section id="example-of-body-temperatures">
<h3>Example of body temperatures<a class="headerlink" href="#example-of-body-temperatures" title="Link to this heading">#</a></h3>
<p>To illustrate the effect of sample size on the confidence interval, we will simulate two datasets of body temperatures with the same population mean and SD, but with different sample sizes (n=12 and n=130). We will assume the body temperatures are <em>normally distributed</em> with a population mean of 36.8 and a standard deviation of 0.4. We will then calculate and visualize the 95% confidence intervals for each sample using the <em>critical z-values</em> (z*), supposing we know the population standard deviation. The difference between t* and z* values will be discussed just after that, for now we focus on the confidence intervals.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set random seed for reproducibility</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Population parameters</span>
<span class="n">pop_mean</span> <span class="o">=</span> <span class="mf">36.8</span>
<span class="n">pop_sd</span> <span class="o">=</span> <span class="mf">0.4</span>

<span class="c1"># Sample sizes</span>
<span class="n">n1</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">n2</span> <span class="o">=</span> <span class="mi">130</span>

<span class="c1"># Generate samples</span>
<span class="n">sample1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">pop_mean</span><span class="p">,</span> <span class="n">pop_sd</span><span class="p">,</span> <span class="n">n1</span><span class="p">)</span>
<span class="n">sample2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">pop_mean</span><span class="p">,</span> <span class="n">pop_sd</span><span class="p">,</span> <span class="n">n2</span><span class="p">)</span>

<span class="c1"># Calculate sample means and standard errors</span>
<span class="n">sample_mean1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sample1</span><span class="p">)</span>
<span class="n">sample_mean2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sample2</span><span class="p">)</span>
<span class="n">sem1</span> <span class="o">=</span> <span class="n">pop_sd</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span>
<span class="n">sem2</span> <span class="o">=</span> <span class="n">pop_sd</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n2</span><span class="p">)</span>

<span class="c1"># Calculate z-critical value for 95% CI (since pop std is known)</span>
<span class="n">z_crit</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.975</span><span class="p">)</span>  <span class="c1"># ppf gives us z score for 97.5%</span>

<span class="c1"># Calculate margin of error</span>
<span class="n">margin_error1</span> <span class="o">=</span> <span class="n">z_crit</span> <span class="o">*</span> <span class="n">sem1</span>
<span class="n">margin_error2</span> <span class="o">=</span> <span class="n">z_crit</span> <span class="o">*</span> <span class="n">sem2</span>

<span class="c1"># Calculate confidence intervals</span>
<span class="n">ci_lower1</span> <span class="o">=</span> <span class="n">sample_mean1</span> <span class="o">-</span> <span class="n">margin_error1</span>
<span class="n">ci_upper1</span> <span class="o">=</span> <span class="n">sample_mean1</span> <span class="o">+</span> <span class="n">margin_error1</span>
<span class="n">ci_lower2</span> <span class="o">=</span> <span class="n">sample_mean2</span> <span class="o">-</span> <span class="n">margin_error2</span>
<span class="n">ci_upper2</span> <span class="o">=</span> <span class="n">sample_mean2</span> <span class="o">+</span> <span class="n">margin_error2</span>

<span class="c1"># Create point plots with confidence intervals</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>  <span class="c1"># 1 row, 2 columns, subplot 1</span>
<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="n">sample_mean1</span><span class="p">],</span>
    <span class="n">yerr</span><span class="o">=</span><span class="n">margin_error1</span><span class="p">,</span>
    <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;95% CI (n=</span><span class="si">{</span><span class="n">n1</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span>
    <span class="n">pop_mean</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\mu$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
    <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">sample1</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data points&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Data point index&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Body Temperature (°C)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">35.6</span><span class="p">,</span> <span class="mf">37.9</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Body temperature sample (n = </span><span class="si">{</span><span class="n">n1</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>  <span class="c1"># 1 row, 2 columns, subplot 2</span>
<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span>
    <span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="n">sample_mean2</span><span class="p">],</span>
    <span class="n">yerr</span><span class="o">=</span><span class="n">margin_error2</span><span class="p">,</span>
    <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;95% CI (n=</span><span class="si">{</span><span class="n">n2</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span>
    <span class="n">pop_mean</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\mu$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
    <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">sample2</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data points&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Data point index&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">130</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Body temperature sample (n = </span><span class="si">{</span><span class="n">n2</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">35.6</span><span class="p">,</span> <span class="mf">37.9</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/95093c0bd618651cb0888232e261a6cc5346e53fb8a7cbd9dfde7a3a0cdeafbc.png" src="_images/95093c0bd618651cb0888232e261a6cc5346e53fb8a7cbd9dfde7a3a0cdeafbc.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print the results</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;z* = </span><span class="si">{</span><span class="n">z_crit</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sample size n = </span><span class="si">{</span><span class="n">n1</span><span class="si">}</span><span class="s2">, with known population SD of </span><span class="si">{</span><span class="n">pop_sd</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Sample mean = </span><span class="si">{</span><span class="n">sample_mean1</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  SE = </span><span class="si">{</span><span class="n">sem1</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Margin of error: </span><span class="si">{</span><span class="n">margin_error1</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  95% confidence interval: (</span><span class="si">{</span><span class="n">ci_lower1</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ci_upper1</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Sample size n = </span><span class="si">{</span><span class="n">n2</span><span class="si">}</span><span class="s2">, with known population SD of </span><span class="si">{</span><span class="n">pop_sd</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Sample mean = </span><span class="si">{</span><span class="n">sample_mean2</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  SE = </span><span class="si">{</span><span class="n">sem2</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Margin of error: </span><span class="si">{</span><span class="n">margin_error2</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  95% confidence interval: (</span><span class="si">{</span><span class="n">ci_lower2</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ci_upper2</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>z* = 1.959964

Sample size n = 12, with known population SD of 0.4:
  Sample mean = 36.9184
  SE = 0.11547
  Margin of error: 0.22632
  95% confidence interval: (36.6921, 37.1447)

Sample size n = 130, with known population SD of 0.4:
  Sample mean = 36.7576
  SE = 0.03508
  Margin of error: 0.06876
  95% confidence interval: (36.6888, 36.8264)
</pre></div>
</div>
</div>
</div>
<p>As the number of observations in a sample increases, the sample statistics tend to converge towards the actual population parameters. This means that the t-distribution, used when the population standard deviation is unknown, closely resembles the z-distribution (standard normal distribution) in larger samples. Therefore, for samples of 50 or more observations, the choice between using the t-distribution or z-distribution for calculating confidence intervals or P values becomes less critical, as the results will be practically identical. In some later models, we may see references to either t-statistics (t) or z-statistics (z), but remember that this distinction is mainly significant for smaller sample sizes.</p>
</section>
<section id="critical-values">
<h3>Critical values<a class="headerlink" href="#critical-values" title="Link to this heading">#</a></h3>
<p>We can use the z* instead of t* when calculating the margin of error in certain situations, but it’s important to understand the conditions under which this is appropriate.</p>
<ul class="simple">
<li><p>When to use z:</p>
<ul>
<li><p>The population standard deviation σ is known: if we have access to the true population standard deviation, we can directly use the z-distribution (standard normal distribution) to calculate the critical value.</p></li>
<li><p>The sample size is large (typically n &gt; 30): the central limit theorem states that the distribution of sample means approaches a normal distribution as the sample size increases. For large samples, the t-distribution closely approximates the z-distribution, making the z-value a valid substitute.</p></li>
</ul>
</li>
<li><p>When to use t:</p>
<ul>
<li><p>The population standard deviation is unknown: this is the most common scenario in <em>real-world</em> applications. When we don’t know the population standard deviation, we estimate it from the sample data (using the sample standard deviation s). The t-distribution accounts for the additional uncertainty introduced by this estimation.</p></li>
<li><p>The sample size is small (typically n &lt; 30): with small sample sizes, the t-distribution has heavier tails than the z-distribution, reflecting the greater variability in sample means. Using the t-distribution provides a more accurate confidence interval in this case.</p></li>
</ul>
</li>
</ul>
<p>Using the z-value when the t-value is appropriate can lead to narrower confidence intervals that may not accurately capture the true population parameter. The t-distribution provides a more conservative estimate in these cases. But the distinction between the t-distribution and z-distribution becomes less critical as the sample size increases. For very large samples (n &gt; 100), the difference is negligible, and either distribution can be used.</p>
<p>For example, suppose we have a sample of 12 measurements with a sample mean (m) of 36.9184 and a sample standard deviation (s) of 0.2977. We want a 95% confidence interval. If we know the population standard deviation (here σ=0.4), we can use the z-value (approximately 1.96 for a 95% CI) to calculate the margin of error, as we did just above. If we don’t know the population standard deviation, we should use the t-value (approximately 2.201 for a 95% CI with 11 degrees of freedom) to calculate the margin of error, as demonstrated below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Population parameters (known)</span>
<span class="n">pop_mean</span> <span class="o">=</span> <span class="mf">36.8</span>
<span class="n">pop_sd</span> <span class="o">=</span> <span class="mf">0.4</span>

<span class="c1"># Sample sizes</span>
<span class="n">n1</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">n2</span> <span class="o">=</span> <span class="mi">130</span>

<span class="c1"># Generate samples (for demonstration purposes)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># for reproducibility</span>
<span class="n">sample1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">pop_mean</span><span class="p">,</span> <span class="n">pop_sd</span><span class="p">,</span> <span class="n">n1</span><span class="p">)</span>
<span class="n">sample2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">pop_mean</span><span class="p">,</span> <span class="n">pop_sd</span><span class="p">,</span> <span class="n">n2</span><span class="p">)</span>

<span class="c1"># Calculate sample means</span>
<span class="n">sample_mean1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sample1</span><span class="p">)</span>
<span class="n">sample_mean2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sample2</span><span class="p">)</span>

<span class="c1"># Confidence level</span>
<span class="n">confidence_level</span> <span class="o">=</span> <span class="mf">0.95</span>
<span class="n">α</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">confidence_level</span>

<span class="c1"># Calculate critical t-values</span>
<span class="n">t_critical1</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">α</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">n1</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">t_critical2</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">α</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">n2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Calculate sample standard deviations</span>
<span class="n">sample_sd1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">sample1</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sample_sd2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">sample2</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Calculate standard error of the mean</span>
<span class="n">sem1</span> <span class="o">=</span> <span class="n">sample_sd1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span>
<span class="n">sem2</span> <span class="o">=</span> <span class="n">sample_sd2</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n2</span><span class="p">)</span>

<span class="c1"># Calculate margin of error</span>
<span class="n">margin_error1</span> <span class="o">=</span> <span class="n">t_critical1</span> <span class="o">*</span> <span class="n">sem1</span>
<span class="n">margin_error2</span> <span class="o">=</span> <span class="n">t_critical2</span> <span class="o">*</span> <span class="n">sem2</span>

<span class="c1"># Calculate confidence intervals</span>
<span class="n">ci_lower1</span> <span class="o">=</span> <span class="n">sample_mean1</span> <span class="o">-</span> <span class="n">margin_error1</span>
<span class="n">ci_upper1</span> <span class="o">=</span> <span class="n">sample_mean1</span> <span class="o">+</span> <span class="n">margin_error1</span>
<span class="n">ci_lower2</span> <span class="o">=</span> <span class="n">sample_mean2</span> <span class="o">-</span> <span class="n">margin_error2</span>
<span class="n">ci_upper2</span> <span class="o">=</span> <span class="n">sample_mean2</span> <span class="o">+</span> <span class="n">margin_error2</span>


<span class="c1"># Print the results</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sample size n = </span><span class="si">{</span><span class="n">n1</span><span class="si">}</span><span class="s2">, with unknown population SD:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  t* = </span><span class="si">{</span><span class="n">t_critical1</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Sample mean = </span><span class="si">{</span><span class="n">sample_mean1</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Sample SD = </span><span class="si">{</span><span class="n">sample_sd1</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Sample SE = </span><span class="si">{</span><span class="n">sem1</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Margin of error: </span><span class="si">{</span><span class="n">margin_error1</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  95% confidence interval: (</span><span class="si">{</span><span class="n">ci_lower1</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ci_upper1</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Sample size n = </span><span class="si">{</span><span class="n">n2</span><span class="si">}</span><span class="s2">, with unknown population SD:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  t* = </span><span class="si">{</span><span class="n">t_critical2</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Sample mean = </span><span class="si">{</span><span class="n">sample_mean2</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Sample SD = </span><span class="si">{</span><span class="n">sample_sd2</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Sample SE = </span><span class="si">{</span><span class="n">sem2</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Margin of error: </span><span class="si">{</span><span class="n">margin_error2</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  95% confidence interval: (</span><span class="si">{</span><span class="n">ci_lower2</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ci_upper2</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sample size n = 12, with unknown population SD:
  t* = 2.200985
  Sample mean = 36.9184
  Sample SD = 0.2977
  Sample SE = 0.08594
  Margin of error: 0.18915
  95% confidence interval: (36.7292, 37.1075)

Sample size n = 130, with unknown population SD:
  t* = 1.978524
  Sample mean = 36.7576
  Sample SD = 0.3822
  Sample SE = 0.03352
  Margin of error: 0.06633
  95% confidence interval: (36.6913, 36.8239)
</pre></div>
</div>
</div>
</div>
</section>
<section id="python-tools-for-confidence-interval-calculation">
<h3>Python tools for confidence interval calculation<a class="headerlink" href="#python-tools-for-confidence-interval-calculation" title="Link to this heading">#</a></h3>
<p>There are several ways to directly calculate CIs in Python using various packages.</p>
<section id="normal-distribution">
<h4>Normal distribution<a class="headerlink" href="#normal-distribution" title="Link to this heading">#</a></h4>
<p>This frequentist method assumes that the data are sampled from a <em>normally distributed population</em>, and that the population standard deviation is known. This function calculates the confidence interval based on the <strong>z-score</strong> (standard normal distribution), which is appropriate under these frequentist assumptions. If we have a <em>large sample size (n &gt; 30)</em>, the normal distribution is often sufficient.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate 95% confidence interval (assuming known population std_dev)</span>
<span class="n">confidence_level</span> <span class="o">=</span> <span class="mf">0.95</span>
<span class="n">sample_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sample2</span><span class="p">)</span>
<span class="c1"># Here, we would typically use the population std_dev when it is known, </span>
<span class="c1"># or an estimate (e.g., from previous studies)</span>
<span class="n">sd2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">sample2</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">ci1</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">interval</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">sample_mean</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">pop_sd</span><span class="p">)</span>
<span class="n">ci2</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">interval</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">sample_mean</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">sd2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;95% confidence interval (known population SD): (</span><span class="si">{</span><span class="n">ci1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ci1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;95% confidence interval (sample SD): (</span><span class="si">{</span><span class="n">ci2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ci2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>95% confidence interval (known population SD): (35.974, 37.542)
95% confidence interval (sample SD): (36.008, 37.507)
</pre></div>
</div>
</div>
</div>
</section>
<section id="id1">
<h4>The t-distribution<a class="headerlink" href="#id1" title="Link to this heading">#</a></h4>
<p>Other frequentist methods provide a convenient way to calculate the confidence interval for a mean using the t-distribution. For example, <a class="reference external" href="https://www.statsmodels.org/stable/generated/statsmodels.stats.weightstats.DescrStatsW.tconfint_mean.html"><code class="docutils literal notranslate"><span class="pre">statsmodels.stats.weightstats.DescrStatsW.tconfint_mean</span></code></a> takes the data as input and returns the confidence interval directly. If we have a <em>small sample size</em> and don’t know the population standard deviation, the t-distribution is generally the most appropriate choice.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">statsmodels.api</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sm</span>

<span class="c1"># Calculate 95% confidence interval</span>
<span class="n">ci</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">DescrStatsW</span><span class="p">(</span><span class="n">sample1</span><span class="p">)</span><span class="o">.</span><span class="n">tconfint_mean</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">α</span><span class="p">)</span> 

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;95% CI using DescrStatsW (t-distribution, estimated SD): </span><span class="se">\</span>
<span class="s2">(</span><span class="si">{</span><span class="n">ci</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ci</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>95% CI using DescrStatsW (t-distribution, estimated SD): (36.729, 37.108)
</pre></div>
</div>
</div>
</div>
<p>This method is based on the confidence interval with equal areas around the median from the t-distribution, as calculated with <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.t.html"><code class="docutils literal notranslate"><span class="pre">scipy.stats.t.interval</span></code></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sem</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">sample1</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sample1</span><span class="p">))</span>
<span class="n">ci</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">interval</span><span class="p">(</span>
    <span class="n">confidence</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">α</span><span class="p">,</span>
    <span class="n">df</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">sample1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">loc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sample1</span><span class="p">),</span>
    <span class="n">scale</span><span class="o">=</span><span class="n">sem</span><span class="p">)</span> <span class="c1"># here scale is SE, no SD as in normal distribution</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;95% CI using `t.interval` (t-distribution, estimated SD): </span><span class="se">\</span>
<span class="s2">(</span><span class="si">{</span><span class="n">ci</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ci</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>95% CI using `t.interval` (t-distribution, estimated SD): (36.729, 37.108)
</pre></div>
</div>
</div>
</div>
</section>
<section id="bayesian-approach">
<h4>Bayesian approach<a class="headerlink" href="#bayesian-approach" title="Link to this heading">#</a></h4>
<p>Bayesian methods allow us to incorporate <em>prior beliefs or information</em> about the parameters we’re estimating. This can be particularly useful when we have some knowledge about the data generating process or when we have limited data. They produce credible intervals, which are a more intuitive and direct interpretation of uncertainty compared to frequentist confidence intervals. A 95% credible interval means there’s a <strong>95% probability</strong> the true parameter lies within that interval, given the data and the prior. Bayesian methods are less sensitive to small sample sizes than frequentist methods, which often rely on asymptotic assumptions that <em>may not hold for small datasets</em>. Bayesian statistics is a vast and complex field with <a class="reference external" href="https://allendowney.github.io/ThinkBayes2/preface.html">dedicated Python libraries like PyMC3 and Stan</a>.</p>
<p>The <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.bayes_mvs.html"><code class="docutils literal notranslate"><span class="pre">scipy.stats.bayes_mvs</span></code> function</a> simplifies the calculation of <strong>Bayesian credible intervals</strong> for the mean, variance, and standard deviation. It uses <a class="reference external" href="https://scholarsarchive.byu.edu/cgi/viewcontent.cgi?article=1277&amp;amp;context=facpub">Jeffrey’s prior, a non-informative prior</a> that doesn’t introduce strong assumptions about the parameter values. This can be a good starting point for Bayesian analysis when you have limited prior knowledge.</p>
<p>Note that for samples of size <em>smaller than 1000</em>, the function resorts to a <em>frequentist approach</em>. It calculates the sample mean and standard deviation, and then uses the <strong>t-distribution</strong> with n-1 degrees of freedom to determine the confidence interval.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">bayes_mvs</span>

<span class="c1"># Calculate 95% Bayesian confidence interval for the mean</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">bayes_mvs</span><span class="p">(</span><span class="n">sample1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
<span class="n">ci_lower</span><span class="p">,</span> <span class="n">ci_upper</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Extract lower and upper bounds from the result object</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bayesian 95% CI in the dataset with n=</span><span class="si">{</span><span class="n">n1</span><span class="si">}</span><span class="s2">: (</span><span class="si">{</span><span class="n">ci_lower</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ci_upper</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bayesian 95% CI in the dataset with n=12: (36.729, 37.108)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate 95% Bayesian confidence interval for the mean</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">bayes_mvs</span><span class="p">(</span><span class="n">sample2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
<span class="n">ci_lower</span><span class="p">,</span> <span class="n">ci_upper</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Extract lower and upper bounds from the result object</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bayesian 95% CI in the dataset with n=</span><span class="si">{</span><span class="n">n2</span><span class="si">}</span><span class="s2">: (</span><span class="si">{</span><span class="n">ci_lower</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ci_upper</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bayesian 95% CI in the dataset with n=130: (36.691, 36.824)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="bootstrapping">
<h3>Bootstrapping<a class="headerlink" href="#bootstrapping" title="Link to this heading">#</a></h3>
<p>So far, we’ve explored traditional methods for calculating confidence intervals of the mean, relying on assumptions about the underlying population distribution. Now, we’ll introduce <strong>bootstrapping</strong>, a powerful <em>non-parametric approach</em> that allows us to estimate confidence intervals directly from the data itself, without these assumptions. This technique offers a flexible and robust alternative, particularly when dealing with small sample sizes or non-normal data</p>
<section id="resampling">
<h4>Resampling<a class="headerlink" href="#resampling" title="Link to this heading">#</a></h4>
<p>The <strong>resampling</strong> method works as follows:</p>
<ul class="simple">
<li><p>Create <strong>pseudosamples</strong>: draw <em>B</em>-times random samples (with replacement) from the original dataset, <em>each with the same size as the original dataset</em>.</p></li>
<li><p>Calculate the statistic of interest: for each pseudosample, compute the mean (or any other parameter we’re interested in). This gives a large collection of estimates based on the original data.</p></li>
<li><p>Identify the percentiles: determine the 2.5th and 97.5th <strong>percentiles</strong> of this collection of estimates. This range, which contains 95% of the resampled means, serves as the 95% confidence interval (CI) for the population mean.</p></li>
</ul>
<p>Remarkably, this resampling-based CI often aligns closely with the CI calculated using the conventional method that assumes a normal distribution. Extensive theoretical and simulation studies have validated this approach, leading some statisticians to advocate for its wider adoption.</p>
<p>The underlying principle behind resampling’s effectiveness is the central limit theorem. This theorem states that as we take more and more simple random samples from a population, the distribution of the sample means will approximate a normal distribution, regardless of the original population’s distribution. In other words, the average of the sample means will converge towards the true population mean as the number of samples increases. Learn more on bootstrap and computer-intensive methods in <a class="reference external" href="https://link.springer.com/chapter/10.1007/978-1-4419-5525-8_6">Wilcox (2010)</a> and <a class="reference external" href="https://doi.org/10.1201/9780429329203">Manly and Navarro Alberto (2020)</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set random seed for reproducibility</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="n">B</span> <span class="o">=</span> <span class="mi">10000</span>  <span class="c1"># Number of replicates</span>

<span class="c1"># !Make sure to choose exactly N elements randomly **with replacement**</span>
<span class="c1"># from the original N-data point set, e.g., size=12 for sample1 set</span>
<span class="n">bs_replicates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
            <span class="n">sample1</span><span class="p">,</span>
            <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">sample1</span><span class="p">),</span>
            <span class="n">replace</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">))</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
    <span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">bs_replicates</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span>  <span class="c1"># print the 10 first replicates</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[37.0219151  36.88659802 37.00984188 36.7711161  36.83294499 36.9323412
 36.79624235 36.984121   36.88825192 36.918909  ]
</pre></div>
</div>
</div>
</div>
</section>
<section id="estimate-of-the-ci">
<h4>Estimate of the CI<a class="headerlink" href="#estimate-of-the-ci" title="Link to this heading">#</a></h4>
<p>Once we have the bootstrap distribution of correlation coefficients, we can estimate the confidence interval by finding the percentiles corresponding to the desired confidence level. For a <strong>95% bootstrap percentile confidence interval</strong>, we typically use the 2.5th and 97.5th percentiles of the bootstrap distribution. This means that 95% of the bootstrapped correlation coefficients fall within this interval, providing a range of plausible values for the true population correlation coefficient. Note that the bootstrap standard error is simply the standard deviation of the distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the mean, 95% CI, and standard error</span>
<span class="n">bs_m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bs_replicates</span><span class="p">)</span>
<span class="n">bs_ci</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">bs_replicates</span><span class="p">,</span> <span class="p">[</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">]),</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">bs_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bs_replicates</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Print the results</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bootstrap analysis of sample1 (n=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">sample1</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bootstrap mean = </span><span class="si">{</span><span class="n">bs_m</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bootstrap 95% percentile CI estimate = </span><span class="si">{</span><span class="n">bs_ci</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bootstrap standard error = </span><span class="si">{</span><span class="n">bs_s</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bootstrap analysis of sample1 (n=12)
Bootstrap mean = 36.921
Bootstrap 95% percentile CI estimate = [36.76874 37.08819]
Bootstrap standard error = 0.0821
</pre></div>
</div>
</div>
</div>
<p>The 95% bootstrap percentile CI is (36.769, 37.088). We are 95% confident that the true mean is in this interval. Additionally, because (36.769, 37.088) is estimated from our data directly, 95% of the bootstrap means fall in this interval.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the histogram of the bootstrap distribution of correlation coefficients</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
    <span class="n">bs_replicates</span><span class="p">,</span>
    <span class="n">density</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">bins</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gold&#39;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Bootstrap means (m)&#39;</span><span class="p">)</span>

<span class="c1"># Annotate the observed mean difference</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">pop_mean</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;cornflowerblue&#39;</span><span class="p">,</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Population mean μ (</span><span class="si">{</span><span class="n">pop_mean</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>

<span class="c1"># Add lines for the confidence interval</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">bs_ci</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;2.5th (</span><span class="si">{</span><span class="n">bs_ci</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">bs_ci</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;97.5th (</span><span class="si">{</span><span class="n">bs_ci</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>

<span class="c1"># Add labels and title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Mean (m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bootstrap distribution of means (sample1; n=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">sample1</span><span class="p">)</span><span class="si">}</span><span class="s2"> | B=</span><span class="si">{</span><span class="n">B</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0ba8026d1cbe78d1510030ca2cc33b307d931afd059d9bd43990b7600e5055b2.png" src="_images/0ba8026d1cbe78d1510030ca2cc33b307d931afd059d9bd43990b7600e5055b2.png" />
</div>
</div>
</section>
<section id="bootstrap-with-pingouin">
<h4>Bootstrap with Pingouin<a class="headerlink" href="#bootstrap-with-pingouin" title="Link to this heading">#</a></h4>
<p>The <a class="reference external" href="https://pingouin-stats.org/build/html/generated/pingouin.compute_bootci.html"><code class="docutils literal notranslate"><span class="pre">pingouin.compute_bootci</span></code></a> function calculates bootstrapped confidence intervals of univariate and bivariate functions, using the SciPy’s built-in bootstrap function <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.bootstrap.html#scipy.stats.bootstrap"><code class="docutils literal notranslate"><span class="pre">scipy.stats.bootstrap</span></code></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pingouin</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pg</span>

<span class="c1"># Calculate 95% percentile bootstrap CI</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;95% bootstrap CI of sample1 (Pingouin):&quot;</span><span class="p">,</span>
    <span class="n">pg</span><span class="o">.</span><span class="n">compute_bootci</span><span class="p">(</span>
        <span class="n">sample1</span><span class="p">,</span>
        <span class="n">func</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span>
        <span class="n">confidence</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span>
        <span class="n">method</span><span class="o">=</span><span class="s1">&#39;per&#39;</span><span class="p">,</span>
        <span class="n">seed</span><span class="o">=</span><span class="mi">111</span><span class="p">,</span>
        <span class="n">decimals</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">n_boot</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>95% bootstrap CI of sample1 (Pingouin): [36.765 37.084]
</pre></div>
</div>
</div>
</div>
<p>This function also returns the bootstrapped distribution. Let’s examine the differences between these distributions for samples with n=12 and n=130.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sample</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="n">sample1</span><span class="p">,</span> <span class="n">sample2</span><span class="p">]):</span>
    <span class="c1"># Calculate 95% percentile bootstrap CI</span>
    <span class="n">ci</span><span class="p">,</span> <span class="n">bs</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">compute_bootci</span><span class="p">(</span>
        <span class="n">sample</span><span class="p">,</span>
        <span class="n">func</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span>
        <span class="n">method</span><span class="o">=</span><span class="s1">&#39;per&#39;</span><span class="p">,</span>
        <span class="n">seed</span><span class="o">=</span><span class="mi">111</span><span class="p">,</span>
        <span class="n">n_boot</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
        <span class="n">return_dist</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># Also returns the bootstrapped distribution for plotting</span>
    <span class="p">)</span>
    
    <span class="c1"># Plot the histogram of the bootstrap distribution of the means</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
        <span class="n">bs</span><span class="p">,</span>
        <span class="n">density</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">bins</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gold&#39;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Bootstrap m&#39;</span><span class="p">)</span>

    <span class="c1"># Annotate the true population mean</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">pop_mean</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;cornflowerblue&#39;</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;μ (</span><span class="si">{</span><span class="n">pop_mean</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>

    <span class="c1"># Add lines for the confidence interval</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">ci</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;2.5th (</span><span class="si">{</span><span class="n">ci</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">ci</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;97.5th (</span><span class="si">{</span><span class="n">ci</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>

    <span class="c1"># Add labels and title</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bootstrap distribution (n=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c8510bbdb8b96a4fc51f0d6d13a08d046fb6f1d48483f248fcb25becfc24e01a.png" src="_images/c8510bbdb8b96a4fc51f0d6d13a08d046fb6f1d48483f248fcb25becfc24e01a.png" />
</div>
</div>
<p>While the bootstrap method is distribution-free and can be particularly useful for non-normal data, its results can vary depending on the size of the dataset. For larger datasets, the bootstrap confidence interval might closely align with the results obtained from frequentist or Bayesian approaches. However, for smaller datasets, the bootstrap confidence interval might exhibit greater variability and potentially deviate from the results of other methods due to the inherent randomness in resampling.</p>
</section>
</section>
</section>
<section id="standard-error-and-confidence-interval">
<h2>Standard error and confidence interval<a class="headerlink" href="#standard-error-and-confidence-interval" title="Link to this heading">#</a></h2>
<p>As we saw in a previous figure and in a previous chapter, larger samples tend to yield more precise estimates of population statistics, reflected in their narrower distributions. The standard deviation of a statistic derived from a sample is called the standard error of that statistic. In the case of the sample mean, the <a class="reference external" href="https://en.wikipedia.org/wiki/Standard_error"><strong>standard error (SE)</strong></a>, also known as the <em>standard error of the mean (SEM)</em> or the <em>standard deviation of the mean</em> (<span class="math notranslate nohighlight">\(\sigma_{\overline{x}}\)</span>) when the estimate is the mean, is given by:</p>
<div class="math notranslate nohighlight">
\[\sigma_{\overline{x}} = \frac{\sigma}{\sqrt{n}} \approx \frac{s}{\sqrt{n}}\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma\)</span> is the population standard deviation, <span class="math notranslate nohighlight">\(s\)</span> the sample standard deviation, and <span class="math notranslate nohighlight">\(n\)</span> is the sample size. It’s important to remember that this calculation relies on the assumption that the sample standard deviation closely mirrors the population standard deviation, which is generally acceptable for samples of moderate or larger size. As the formula illustrates, the SE is inversely proportional to the square root of the sample size. This confirms our intuitive understanding that larger samples lead to more precise estimates of the population mean, as evidenced by the smaller SE.</p>
<p>We might also have noticed the term “standard error” or “standard error of the mean” appearing in previous calculations of the margin of error. Let’s take a closer look at the relationship between the confidence interval (CI) and the SE, as they both play crucial roles in understanding the precision of our estimates.</p>
<p>A point estimate, such as the sample mean, gives us a single value to estimate a population parameter. However, estimates vary from sample to sample due to random sampling error. A confidence interval addresses this uncertainty by providing a range around the point estimate. This range is constructed to capture the true population parameter with a certain degree of confidence, often set at 95%. Wider intervals offer greater confidence in capturing the true parameter, but at the cost of reduced precision.</p>
<p>Recall that the SE is a measure of how much the sample mean is expected to vary from sample to sample, quantifying the variability we expect to see in sample means due to random sampling error. A smaller SE indicates that the sample mean is likely to be closer to the true population mean.</p>
<p>The margin of error in a confidence interval is directly related to the SE (<span class="math notranslate nohighlight">\(s_{\hat{\theta}}\)</span>) of the point estimate <span class="math notranslate nohighlight">\(\hat \theta\)</span>. It’s calculated by multiplying the SE by a critical value <span class="math notranslate nohighlight">\(c^\ast\)</span> (either from the t-distribution or the z-distribution) that corresponds to our desired confidence level:</p>
<div class="math notranslate nohighlight">
\[W=c^\ast \times s_{\hat{\theta}}\]</div>
<p>The critical value depends on the chosen confidence level (e.g., 95% or 99%) and the degrees of freedom (if using the t-distribution).</p>
<p>Therefore, the confidence interval is essentially constructed by adding and subtracting the margin of error from the sample mean: <span class="math notranslate nohighlight">\(\text{CI} = m \pm W\)</span>.</p>
<p>In essence, the confidence interval uses the SE as a building block to create a range of plausible values for the population mean. The width of the confidence interval reflects the level of uncertainty in our estimate:</p>
<ul class="simple">
<li><p>Narrow CI: smaller SE, more precise estimate</p></li>
<li><p>Wide CI: larger SE, less precise estimate</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">sem</span>

<span class="c1"># Calculate statistics</span>
<span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sample1</span><span class="p">)</span>
<span class="n">sd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">sample1</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Unbiased sample standard deviation</span>
<span class="n">sample_sem</span> <span class="o">=</span> <span class="n">sem</span><span class="p">(</span><span class="n">sample1</span><span class="p">)</span>

<span class="c1"># Critical value for 95% CI</span>
<span class="n">z_crit</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.975</span><span class="p">)</span>  <span class="c1"># Assuming normal distribution</span>
<span class="n">W</span> <span class="o">=</span>  <span class="n">z_crit</span> <span class="o">*</span> <span class="n">sample_sem</span>  <span class="c1"># margin of error</span>

<span class="c1"># Calculate confidence interval</span>
<span class="n">ci</span> <span class="o">=</span> <span class="p">(</span><span class="n">mean</span> <span class="o">-</span> <span class="n">W</span><span class="p">,</span> <span class="n">mean</span> <span class="o">+</span> <span class="n">W</span><span class="p">)</span>

<span class="c1"># Plotting</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>

<span class="c1"># SD error bar</span>
<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span>
    <span class="mi">1</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span>
    <span class="n">yerr</span><span class="o">=</span><span class="n">sd</span><span class="p">,</span>
    <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Standard deviation (SD)&#39;</span><span class="p">)</span>

<span class="c1"># SE error bar</span>
<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span>
    <span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span>
    <span class="n">yerr</span><span class="o">=</span><span class="n">sample_sem</span><span class="p">,</span>
    <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Standard error of the mean (SEM)&#39;</span><span class="p">)</span>

<span class="c1"># 95% CI error bar</span>
<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span>
    <span class="mi">3</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span>
    <span class="n">yerr</span><span class="o">=</span><span class="n">W</span><span class="p">,</span>
    <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;95</span><span class="si">% c</span><span class="s1">onfidence interval (CI)&#39;</span><span class="p">)</span>

<span class="c1"># Add labels and title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;SD&#39;</span><span class="p">,</span> <span class="s1">&#39;SEM&#39;</span><span class="p">,</span> <span class="s1">&#39;95% CI&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Value&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Comparison of SD, SEM, and 95% CI (for sample1)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8e8d24c54d13e376150569b515840b2871b6783cc920d53a12ad965e813d4ac1.png" src="_images/8e8d24c54d13e376150569b515840b2871b6783cc920d53a12ad965e813d4ac1.png" />
</div>
</div>
<ul class="simple">
<li><p>The error bar for SD is the longest, reflecting the variability of individual data points around the mean.</p></li>
<li><p>The SEM error bar is shorter than the SD, showing the reduced variability expected in sample means compared to individual data points.</p></li>
<li><p>The 95% CI error bar has a moderate width, indicating the range within which we are 95% confident that the true population mean lies.</p></li>
</ul>
<p>Since the distribution of our bootstrapped mean differences appeared symmetrical, e.g., for <code class="docutils literal notranslate"><span class="pre">sample1</span></code>, we can calculate the <strong>95% normal percentile confidence interval</strong> using the formula:</p>
<div class="math notranslate nohighlight">
\[\text{CI}_z = m \pm z^\ast \times s_{\bar x}\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(m\)</span> is the mean of the bootstrap replicates</p></li>
<li><p><span class="math notranslate nohighlight">\(z^\ast\)</span> is the critical value from the standard normal distribution for a 95% confidence level (approximately 1.96)</p></li>
<li><p><span class="math notranslate nohighlight">\(s_{\bar x}\)</span> is the standard error of the bootstrap replicates</p></li>
</ul>
<p>This approach provides a convenient way to estimate the confidence interval when the bootstrap distribution is approximately normal.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the 95% normal margin of error</span>
<span class="n">bs_w</span> <span class="o">=</span>  <span class="n">z_crit</span> <span class="o">*</span> <span class="n">bs_s</span>

<span class="c1"># Calculate confidence interval</span>
<span class="n">bs_ci_normal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">((</span><span class="n">bs_m</span> <span class="o">-</span> <span class="n">bs_w</span><span class="p">,</span> <span class="n">bs_m</span> <span class="o">+</span> <span class="n">bs_w</span><span class="p">),</span> <span class="mi">5</span><span class="p">)</span>

<span class="c1"># Print the result</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bootstrap analysis of sample1 (n=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">sample1</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;95% normal percentile CI of bootstrap distribution = </span><span class="si">{</span><span class="n">bs_ci_normal</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bootstrap analysis of sample1 (n=12)
95% normal percentile CI of bootstrap distribution = [36.75972 37.08147]
</pre></div>
</div>
</div>
</div>
<p>It’s interesting to note that both the 95% percentile and normal percentile confidence intervals yield similar results in this case. However, it’s important to remember that the percentile method doesn’t require the interval to be symmetric around the estimated parameter. This offers greater flexibility compared to the normal percentile method, which enforces symmetry. This flexibility can be particularly valuable when dealing with skewed distributions or small sample sizes, where the assumption of symmetry might not hold.</p>
</section>
<section id="ci-of-the-standard-deviation">
<h2>CI of the standard deviation<a class="headerlink" href="#ci-of-the-standard-deviation" title="Link to this heading">#</a></h2>
<section id="frequentist-approach">
<h3>Frequentist approach<a class="headerlink" href="#frequentist-approach" title="Link to this heading">#</a></h3>
<p>Confidence intervals are a versatile tool in statistics, applicable to a wide range of values calculated from sample data, not just the mean. Under common assumptions, i.e., a roughly Gaussian population distribution, a random and representative sample, independent observations, accurate data, and a meaningful outcome, a 95% CI allows us to be 95% confident that the calculated interval captures the true population parameter of interest, whether it’s the standard deviation, a proportion, or another statistic.</p>
<p>While the <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> library doesn’t directly provide a function for calculating confidence intervals of standard deviation using the frequentist approach, it’s easy to implement it using the <strong>chi-squared</strong> distribution, knowing that <span class="math notranslate nohighlight">\(\frac{(n - 1) s^2}{\sigma^2} \sim \chi^2_{n-1}\)</span>, where <span class="math notranslate nohighlight">\(\chi^2_{n-1}\)</span> is the chi-squared distribution with <span class="math notranslate nohighlight">\(n − 1\)</span> degrees of freedom.</p>
<p>The chi-squared distribution is related to the sum of squared standard normal random variables. When we calculate the sample variance, we’re essentially summing the squared deviations of each data point from the sample mean. After appropriate scaling, this sum of squares follows a chi-squared distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">chi2</span>

<span class="k">def</span><span class="w"> </span><span class="nf">std_dev_conf_interval</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">confidence</span><span class="o">=</span><span class="mf">0.95</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the confidence interval for population standard deviation </span>
<span class="sd">    using the frequentist approach.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (array-like): The sample data.</span>
<span class="sd">        confidence (float): The desired confidence level (default: 0.95).</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: The lower and upper bounds of the confidence interval.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="c1"># First calculate the unbiased (ddof=1) sample standard deviation</span>
    <span class="n">sample_std_dev</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># CI for the population SD is derived from the chi-squared distribution with DF=n-1</span>
    <span class="c1"># Find the critical chi-squared values with PPF</span>
    <span class="n">chi2_lower</span> <span class="o">=</span> <span class="n">chi2</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">α</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">df</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">chi2_upper</span> <span class="o">=</span> <span class="n">chi2</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">α</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">df</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># Use sqrt((n - 1) * s**2 / crit_chi2)</span>
    <span class="n">lower_bound</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">sample_std_dev</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">chi2_upper</span><span class="p">)</span>
    <span class="n">upper_bound</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">sample_std_dev</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">chi2_lower</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">sample_std_dev</span><span class="p">,</span> <span class="n">lower_bound</span><span class="p">,</span> <span class="n">upper_bound</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="p">[</span><span class="n">sample1</span><span class="p">,</span> <span class="n">sample2</span><span class="p">]:</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SD and 95% CI for sample with n=</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">(chi²): </span><span class="se">\n\t</span><span class="s2"> </span><span class="si">{</span><span class="n">std_dev_conf_interval</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SD and 95% CI for sample with n=12 (chi²): 
	 (0.2976964334156459, 0.21088670986063496, 0.5054522302512634)
SD and 95% CI for sample with n=130 (chi²): 
	 (0.38223178599879426, 0.34073809210625733, 0.4353236863653785)
</pre></div>
</div>
</div>
</div>
</section>
<section id="id2">
<h3>Bayesian approach<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<p>We can also use the <code class="docutils literal notranslate"><span class="pre">scipy.stats.bayes_mvs</span></code> function to calculate Bayesian credible intervals for the standard deviation. This approach incorporates prior knowledge (or lack thereof) about the population parameters, which can be particularly useful when dealing with limited data.</p>
<p>Note that for sample size smaller than 1000, the function uses a generalized gamma distributed with shape parameters <span class="math notranslate nohighlight">\(c=-2\)</span> and <span class="math notranslate nohighlight">\(a=(n-1)/2\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="p">[</span><span class="n">sample1</span><span class="p">,</span> <span class="n">sample2</span><span class="p">]:</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>

    <span class="c1"># Calculate Bayesian credible interval for standard deviation (alpha = 0.95 for 95% CI)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">bayes_mvs</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SD and 95% CI for sample with n=</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">(Bayes): </span><span class="se">\n\t</span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SD and 95% CI for sample with n=12 (Bayes): 
	Std_dev(statistic=0.32011752574920377, minmax=(0.21088670986063499, 0.5054522302512634))
SD and 95% CI for sample with n=130 (Bayes): 
	Std_dev(statistic=0.3844721557624937, minmax=(0.34073809210625733, 0.4353236863653785))
</pre></div>
</div>
</div>
</div>
<p>Comparable values for the SD and 95% CI can be obtained from the <a class="reference external" href="https://www.graphpad.com/quickcalcs/CISD2/">“Confidence interval of a SD” calculator from GraphPad</a>:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>n</p></th>
<th class="head"><p>SD</p></th>
<th class="head"><p>lower</p></th>
<th class="head"><p>upper</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>12</p></td>
<td><p>0.2976964334</p></td>
<td><p>0.2108869126</p></td>
<td><p>0.5054521106</p></td>
</tr>
<tr class="row-odd"><td><p>130</p></td>
<td><p>0.3822317859</p></td>
<td><p>0.3407364138</p></td>
<td><p>0.4353220208</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="bootstrap-approach">
<h3>Bootstrap approach<a class="headerlink" href="#bootstrap-approach" title="Link to this heading">#</a></h3>
<p>While bootstrapping is often used to estimate the confidence interval of a mean, it can also be applied to other statistics, such as the standard deviation. This is particularly useful when the underlying distribution of the data is unknown or non-normal, making it difficult to rely on traditional methods for calculating confidence intervals.</p>
<p>As before, we create multiple resamples (with replacement) from the original data. Each resample should be the same size as the original. But instead of calculating the mean of each bootstrap sample, we calculate the standard deviation. This collection of standard deviations from all the bootstrap samples forms the <em>bootstrap distribution of the standard deviation</em>. The percentiles corresponding to the desired confidence level (e.g., 2.5th and 97.5th for a 95% CI) from the bootstrap distribution give us the lower and upper bounds of the CI.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sample</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="n">sample1</span><span class="p">,</span> <span class="n">sample2</span><span class="p">]):</span>
    <span class="c1"># Calculate 95% percentile bootstrap CI</span>
    <span class="n">ci</span><span class="p">,</span> <span class="n">bs</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">compute_bootci</span><span class="p">(</span>
        <span class="n">sample</span><span class="p">,</span>
        <span class="n">func</span><span class="o">=</span><span class="s1">&#39;std&#39;</span><span class="p">,</span>  <span class="c1"># Standard deviation</span>
        <span class="n">method</span><span class="o">=</span><span class="s1">&#39;per&#39;</span><span class="p">,</span>
        <span class="n">seed</span><span class="o">=</span><span class="mi">111</span><span class="p">,</span>
        <span class="n">n_boot</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
        <span class="n">return_dist</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    
    <span class="c1"># Plot the histogram of the bootstrap distribution of correlation coefficients</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
        <span class="n">bs</span><span class="p">,</span>
        <span class="n">density</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">bins</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gold&#39;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Bootstrap s&#39;</span><span class="p">)</span>

    <span class="c1"># Annotate the population SD</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">pop_sd</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;cornflowerblue&#39;</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;σ (</span><span class="si">{</span><span class="n">pop_sd</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>

    <span class="c1"># Add lines for the confidence interval</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">ci</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;2.5th (</span><span class="si">{</span><span class="n">ci</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">ci</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;97.5th (</span><span class="si">{</span><span class="n">ci</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>

    <span class="c1"># Add labels and title</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bootstrap distribution (n=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a78daecebdbd5b62eb7aee61d16780055435c643000cbcacbf466fb362b57305.png" src="_images/a78daecebdbd5b62eb7aee61d16780055435c643000cbcacbf466fb362b57305.png" />
</div>
</div>
<p>If the histogram of bootstrap replicates of the standard deviation appears multimodal (i.e., has multiple peaks), it suggests non-normality of the underlying population distribution from which the sample is drawn, sampling variability, especially if the sample size is small, and/or an actual underlying structure in the population. In the current example, we know that the original population is totally normal, therefore the sampling variability, with the small sample size, may affect the bootstrap process.</p>
<p>When faced with a <em>multimodal bootstrap distribution</em> of standard deviations, the traditional methods of constructing confidence intervals (e.g., using percentiles or assuming normality) might not be appropriate. Alternative methods, e.g., bias-corrected and accelerated (BCa) bootstrap or the bootstrapped-t method, can be more suitable.</p>
<p>However, as we increase the sample size, the bootstrap distribution of the standard deviation tends to become more stable and unimodal, even if the original population distribution is not perfectly normal. This is because larger samples better represent the true population characteristics. Consequently, with a larger sample size, the true population standard deviation is more likely to be captured within the calculated bootstrap confidence interval, leading to more reliable inferences about the population variability.</p>
</section>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Link to this heading">#</a></h2>
<p>In this chapter, we’ve explored the fundamental concept of confidence intervals and their essential role in statistical inference. We’ve learned that confidence intervals provide a range of plausible values for population parameters, like the mean, and quantify the uncertainty associated with those estimates.</p>
<p>We delved into the different methods for calculating confidence intervals, including the t-distribution for smaller samples and the z-distribution for larger ones. We also explored the Bayesian approach, which incorporates prior information, and the non-parametric bootstrap method, which is particularly useful for complex or non-normal data.</p>
<p>We’ve seen how confidence intervals can be visualized using plots, helping us grasp the relationship between sample size, variability, and precision. We also examined the close connection between confidence intervals and the standard error of the mean, a key measure of the uncertainty in our sample mean estimate.</p>
<p>By mastering confidence intervals, we’ve gained a powerful tool for analyzing data and drawing meaningful conclusions in the field of biostatistics. But confidence intervals are not just about numbers; they are about understanding the uncertainty inherent in estimation and making informed decisions based on that understanding.</p>
</section>
<section id="cheat-sheet">
<h2>Cheat sheet<a class="headerlink" href="#cheat-sheet" title="Link to this heading">#</a></h2>
<p>This cheat sheet provides a quick reference for essential code snippets used in this chapter.</p>
<section id="t-distribution">
<h3>t-distribution<a class="headerlink" href="#t-distribution" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">t</span>

<span class="c1"># Define the degrees of freedom (e.g., sample size - 1)</span>
<span class="n">DF</span> <span class="o">=</span> <span class="mi">27</span>

<span class="c1"># Define the t-distribution</span>
<span class="n">t_distribution</span> <span class="o">=</span> <span class="n">t</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">DF</span><span class="p">)</span>

<span class="c1"># Calculate mean, variance (and more), median and SD from the model</span>
<span class="n">t_distribution</span><span class="o">.</span><span class="n">stats</span><span class="p">(</span><span class="n">moments</span><span class="o">=</span><span class="s1">&#39;mv&#39;</span><span class="p">)</span>
<span class="n">t_distribution</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">t_distribution</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
<span class="n">t_distribution</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="pdf-plot">
<h3>PDF Plot<a class="headerlink" href="#pdf-plot" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="c1"># central 99.8% of the distribution</span>
    <span class="n">x</span><span class="o">:=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
        <span class="n">t_distribution</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="mf">.001</span><span class="p">),</span> <span class="c1"># Percent Point Function</span>
        <span class="n">t_distribution</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="mf">.999</span><span class="p">),</span>
        <span class="n">num</span><span class="o">=</span><span class="mi">200</span><span class="p">),</span>
    <span class="c1">#x:=np.linspace(-4, 4, 100)  # Range from -4 to 4 standard deviations</span>
    <span class="n">t_distribution</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),)</span>
</pre></div>
</div>
</section>
<section id="id3">
<h3>Critical values<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Defeine alpha (for two-tailed test)</span>
<span class="n">α</span> <span class="o">=</span> <span class="mf">0.05</span>

<span class="c1"># Calculate critical bound t-values (direct method)</span>
<span class="n">t_critical_lower</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">α</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">DF</span><span class="p">)</span>  <span class="c1"># Lower critical value at q = 0.025</span>
<span class="n">t_critical_upper</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">α</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">df</span><span class="o">=</span><span class="n">DF</span><span class="p">)</span>  <span class="c1"># Upper critical value at q = 0.975</span>

<span class="c1"># Calculate the critical z-value (two-tailed)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">norm</span>

<span class="n">z_critical</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">α</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="confidence-interval">
<h3>Confidence interval<a class="headerlink" href="#confidence-interval" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Population parameters</span>
<span class="c1"># pop_mean = 36.8  # mean</span>
<span class="c1"># pop_sd = 0.4     # standard deviation</span>

<span class="c1"># Generate toy sample derived from Normal distribution</span>
<span class="c1"># n = 12                     # sample size</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span>
    <span class="n">loc</span><span class="o">=</span><span class="n">pop_mean</span><span class="p">,</span>
    <span class="n">scale</span><span class="o">=</span><span class="n">pop_sd</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="c1"># sample_mean = 36.9184      # or use np.mean(sample)</span>
<span class="c1"># sample_sd = 0.2977         # or use np.std(sample, ddof=1)</span>


<span class="c1">### Manual calculation of the CI</span>
<span class="c1"># Calculate the critical t-value</span>
<span class="n">t_critical</span> <span class="o">=</span> <span class="n">t</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">α</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># Percent Point Function</span>

<span class="c1"># Calculate the standard error of the mean</span>
<span class="n">sem</span> <span class="o">=</span> <span class="n">sample_sd</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>  <span class="c1"># or use scipy.stats.sem on data</span>
<span class="c1">#sem = pop_sd / np.sqrt(n)  # if population SD is known</span>

<span class="c1"># Calculate margin of error</span>
<span class="n">margin_error</span> <span class="o">=</span> <span class="n">t_critical</span> <span class="o">*</span> <span class="n">sem</span>
<span class="c1">#margin_error = z_critical * sem  # large sample sizes and/or known population SD</span>

<span class="c1"># Calculate confidence intervals</span>
<span class="p">(</span><span class="n">sample_mean</span> <span class="o">-</span> <span class="n">margin_error</span><span class="p">,</span> <span class="n">sample_mean</span> <span class="o">+</span> <span class="n">margin_error</span><span class="p">)</span>


<span class="c1">### Computational calculation of the CI</span>
<span class="c1"># Frequentist - Small sample size and unknown population SD</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">statsmodels.api</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sm</span>

<span class="n">sm</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">DescrStatsW</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span><span class="o">.</span><span class="n">tconfint_mean</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">α</span><span class="p">)</span>

<span class="c1"># Equivalent to</span>
<span class="n">t</span><span class="o">.</span><span class="n">interval</span><span class="p">(</span>
    <span class="n">confidence</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">α</span><span class="p">,</span>
    <span class="n">df</span><span class="o">=</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">loc</span><span class="o">=</span><span class="n">sample_mean</span><span class="p">,</span>
    <span class="n">scale</span><span class="o">=</span><span class="n">sem</span><span class="p">)</span> <span class="c1"># here scale is SE, no SD as in normal distribution</span>


<span class="c1"># Frequentist - Large sample size and/or known population SD</span>
<span class="n">norm</span><span class="o">.</span><span class="n">interval</span><span class="p">(</span>
    <span class="n">confidence</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">α</span><span class="p">,</span>
    <span class="n">loc</span><span class="o">=</span><span class="n">sample_mean</span><span class="p">,</span>
    <span class="n">scale</span><span class="o">=</span><span class="n">pop_sd</span><span class="p">)</span> <span class="c1"># or sample_sd</span>


<span class="c1"># Bayesian</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">bayes_mvs</span>

<span class="c1"># If n&lt;1000, it uses the frequentist approach with the t-distribution</span>
<span class="n">bayes_mvs</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># extract `minmax` tuple from `mean`</span>
<span class="c1"># bayes_mvs(sample, alpha=0.95) # returns mean, var and SD with 95% credible intervals</span>
</pre></div>
</div>
</section>
<section id="plot-errorbar">
<h3>Plot errorbar<a class="headerlink" href="#plot-errorbar" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 95% CI error bar</span>
<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sample_mean</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">margin_error</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id4">
<h3>Bootstrapping<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Resampling and mean calculation (manual calculation)</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">10000</span> <span class="c1"># number of replicates</span>

<span class="c1"># !Make sure to choose exactly N elements randomly **with replacement**</span>
<span class="c1"># from the original N-data point set</span>
<span class="n">bs_replicates</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
        <span class="n">sample</span><span class="p">,</span>
        <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">),</span>
        <span class="n">replace</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">B</span><span class="p">)]</span>

<span class="c1"># Calculate percentiles</span>
<span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">bs_replicates</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">bs_replicates</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">)</span>

<span class="c1"># Calculate percentile bootstrap and distribution with Pingouin</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pingouin</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pg</span>
<span class="n">ci_bs</span><span class="p">,</span> <span class="n">bs_replicates</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">compute_bootci</span><span class="p">(</span>
    <span class="n">sample</span><span class="p">,</span>
    <span class="n">func</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span>  <span class="c1"># or &#39;std&#39; for standard deviation, or any custom function</span>
    <span class="n">method</span><span class="o">=</span><span class="s1">&#39;per&#39;</span><span class="p">,</span>
    <span class="n">return_dist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Plot the histogram</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bs_replicates</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="session-information">
<h2>Session information<a class="headerlink" href="#session-information" title="Link to this heading">#</a></h2>
<p>The output below details all packages and version necessary to reproduce the results in this report.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>python<span class="w"> </span>--version
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-------------&quot;</span><span class="p">)</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">importlib.metadata</span><span class="w"> </span><span class="kn">import</span> <span class="n">version</span>

<span class="c1"># List of packages we want to check the version</span>
<span class="n">packages</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;numpy&#39;</span><span class="p">,</span> <span class="s1">&#39;pandas&#39;</span><span class="p">,</span> <span class="s1">&#39;scipy&#39;</span><span class="p">,</span> <span class="s1">&#39;pingouin&#39;</span><span class="p">,</span> <span class="s1">&#39;statsmodels&#39;</span><span class="p">,</span> <span class="s1">&#39;matplotlib&#39;</span><span class="p">,</span> <span class="s1">&#39;seaborn&#39;</span><span class="p">]</span>

<span class="c1"># Initialize an empty list to store the versions</span>
<span class="n">versions</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Loop over the packages</span>
<span class="k">for</span> <span class="n">package</span> <span class="ow">in</span> <span class="n">packages</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Get the version of the package</span>
        <span class="n">package_version</span> <span class="o">=</span> <span class="n">version</span><span class="p">(</span><span class="n">package</span><span class="p">)</span>
        <span class="c1"># Append the version to the list</span>
        <span class="n">versions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">package_version</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>  <span class="c1"># Use a more general exception for broader compatibility</span>
        <span class="n">versions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Not installed&#39;</span><span class="p">)</span>

<span class="c1"># Print the versions</span>
<span class="k">for</span> <span class="n">package</span><span class="p">,</span> <span class="n">version</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">packages</span><span class="p">,</span> <span class="n">versions</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">package</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">version</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Python 3.12.7
-------------
numpy: 1.26.4
pandas: 2.2.2
scipy: 1.14.1
pingouin: 0.5.5
statsmodels: 0.14.2
matplotlib: 3.9.2
seaborn: 0.13.2
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="10%20-%20Gaussian%20distribution.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">The Gaussian distribution</p>
      </div>
    </a>
    <a class="right-next"
       href="04%20-%20Confidence%20interval%20of%20a%20proportion.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Confidence interval of a proportion</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-t-distribution">The t-distribution</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#origin-of-the-t-distribution">Origin of the t-distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-scipy-to-obtain-critical-t-values">Using SciPy to obtain critical t-values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sign-of-the-critical-t-value">Sign of the critical t-value</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-the-t-distribution">Visualizing the t-distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#approaching-the-standard-normal">Approaching the standard normal</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-the-confidence-interval-of-a-mean">Calculating the confidence interval of a mean</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-t-statistic">The t-statistic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-flip">The flip</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-of-body-temperatures">Example of body temperatures</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#critical-values">Critical values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#python-tools-for-confidence-interval-calculation">Python tools for confidence interval calculation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#normal-distribution">Normal distribution</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">The t-distribution</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bayesian-approach">Bayesian approach</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrapping">Bootstrapping</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#resampling">Resampling</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#estimate-of-the-ci">Estimate of the CI</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrap-with-pingouin">Bootstrap with Pingouin</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#standard-error-and-confidence-interval">Standard error and confidence interval</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ci-of-the-standard-deviation">CI of the standard deviation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#frequentist-approach">Frequentist approach</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Bayesian approach</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrap-approach">Bootstrap approach</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cheat-sheet">Cheat sheet</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#t-distribution">t-distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pdf-plot">PDF Plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Critical values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#confidence-interval">Confidence interval</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-errorbar">Plot errorbar</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Bootstrapping</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#session-information">Session information</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Sébastien Wieckowski
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>